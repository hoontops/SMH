<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="DFM00400M" width="1647" height="747" titletext="Layer별 불량 현황" onload="fn_init">
    <Layouts>
      <Layout height="747" width="1647">
        <Tab id="tab_search" taborder="0" tabindex="0" left="0" top="47" width="290" cssclass="tab_search" bottom="0">
          <Tabpages>
            <Tabpage id="tab_search01" text="불량명">
              <Layouts>
                <Layout>
                  <Static id="Static12_00_00_00_01" taborder="14" text="h10" width="45" top="0" visible="false" height="10" cssclass="guideTip" right="91"/>
                  <Static id="sta_searchPeriod" taborder="11" text="조회기간" left="0" top="10" width="103" height="20" cssclass="sta_WF_label" tooltiptext="5A9641FD0CFD479C8E4840FB00D0683C"/>
                  <Static id="Static12_00_00_00_01_00_00" taborder="12" text="h20" width="45" top="205" visible="false" height="20" cssclass="guideTip" right="91"/>
                  <Static id="Static12_00_00_00_00_00" taborder="13" text="w&#13;&#10;10" width="10" top="231" visible="false" height="27" cssclass="guideTip" left="161"/>
                  <Button id="btn_clearC" taborder="10" top="225" width="102" height="36" cssclass="btn_SA_reset" left="171" text="초기화" tooltiptext="Toolbar_Initialization" onclick="fn_initSearch"/>
                  <Button id="btn_search" taborder="9" top="225" width="146" height="36" cssclass="btn_SA_search" left="15" text="검색" tooltiptext="Toolbar_Search"/>
                  <Static id="Static12_00_00_00_01_00" taborder="15" text="h10" width="45" top="10" visible="false" height="10" cssclass="guideTip" right="81"/>
                  <Static id="sta_lotNo" taborder="16" text="Lot No." left="0" top="60" width="103" height="20" cssclass="sta_WF_label" tooltiptext="54C33732C27844B298AB8C7EA28109AC"/>
                  <Static id="sta_itemCode" taborder="17" text="품목코드" left="0" top="85" width="103" height="20" cssclass="sta_WF_label_point" tooltiptext="F112527EF89E45D8BA876725E97E3B30"/>
                  <Edit id="edt_lotNo" taborder="1" left="108" top="60" height="20" right="37"/>
                  <Button id="btn_lotNo" taborder="2" width="22" height="20" cssclass="btn_WF_finder" top="60" right="15" onclick="tab_search_tab_search01_btn_lotNo_onclick"/>
                  <Edit id="edt_itemNm" taborder="5" left="108" top="110" width="165" height="20" enable="false" readonly="true"/>
                  <Combo id="cbo_period" taborder="0" left="10" top="35" width="94" height="20" cssclass="cmb_SA_label" value="" index="5" innerdataset="gds_period" codecolumn="code" datacolumn="desc" onitemchanged="tab_search_tab_search01_cbo_period_onitemchanged"/>
                  <Static id="sta_itemNm" taborder="18" text="품목명" left="0" top="110" width="103" height="20" cssclass="sta_WF_label" tooltiptext="FAA6C66A19874535851F8C13FF3A95BC"/>
                  <Static id="sta_rev" taborder="19" text="Rev" left="0" top="135" width="103" height="20" cssclass="sta_WF_label" tooltiptext="PRODUCTDEFVERSION"/>
                  <Static id="sta_inpType" taborder="20" text="검사구분" left="0" top="160" width="103" height="20" cssclass="sta_WF_label" tooltiptext="F08D5BD5CFEA409A9C07665A28ADA13A"/>
                  <Static id="sta_layer" taborder="21" text="Layer No" left="0" top="185" width="103" height="20" cssclass="sta_WF_label_point" tooltiptext="9BA0994900D94F21A6709010DBAE0532"/>
                  <Edit id="edt_itemCode" taborder="3" left="108" top="85" height="20" right="37"/>
                  <Button id="btn_itemCode" taborder="4" width="22" height="20" cssclass="btn_WF_finder" top="85" right="15" onclick="tab_search_tab_search01_btn_itemCode_onclick"/>
                  <Combo id="cmb_inpType" taborder="6" left="108" top="160" width="165" height="20" value="" index="-1" codecolumn="C,DefectMapInspactionType,,Y,Y " enable="false"/>
                  <Edit id="edt_layer" taborder="7" left="108" top="185" height="20" right="37" onsetfocus="tab_search_tab_search01_edt_layer_onsetfocus"/>
                  <Button id="btn_layer" taborder="8" width="22" height="20" cssclass="btn_WF_finder" top="185" right="15" onclick="tab_search_tab_search01_btn_layer_onclick"/>
                  <Div id="div_dateFrom" taborder="22" left="108" top="10" width="165" height="21" url="common::com_calendar.xfdl" onkeydown="fn_preiodChang"/>
                  <Div id="div_dateTo" taborder="23" left="108" top="35" width="165" height="21" url="common::com_calendar.xfdl" onkeydown="fn_preiodChang"/>
                  <Div id="div_revMulti" taborder="24" top="135" height="20" url="dfm::dfm_multiCombo.xfdl" right="15" width="165"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="Tabpage2" text="불량코드">
              <Layouts>
                <Layout>
                  <Static id="Static12_00_00_00_00" taborder="0" text="w&#13;&#10;15" width="15" top="80" visible="false" height="97" cssclass="guideTip" left="0"/>
                  <Static id="Static12_00_00_00" taborder="1" text="w&#13;&#10;15" width="15" top="70" visible="false" height="97" cssclass="guideTip" right="0"/>
                  <Static id="Static12_00_00_00_01" taborder="2" text="h10" width="45" top="0" visible="false" height="10" cssclass="guideTip" right="91"/>
                  <Static id="label01" taborder="3" text="유효상태" left="0" top="10" width="103" height="20" cssclass="sta_WF_label_point"/>
                  <Combo id="cmb_01" taborder="4" text="유효" left="108" top="10" height="20" codecolumn="code" datacolumn="data" index="1" value="" width="165" innerdataset="ds_cmb01"/>
                  <Button id="Button45_00" taborder="5" top="50" width="146" height="36" cssclass="btn_SA_search" left="15" text="검색" tooltiptext="검색"/>
                  <Button id="Button44_00_01" taborder="6" top="50" width="102" height="36" cssclass="btn_SA_reset" left="171" text="초기화" tooltiptext="초기화"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="sta_searchTitle" taborder="1" text="검색조건" left="0" top="47" width="191" height="34" cssclass="sta_WF_subTitle" usedecorate="true" tooltiptext="SEARCH_CONDITION_GROUP"/>
        <Div id="div_work" taborder="2" text="div_00" left="300" top="47" right="0" bottom="0">
          <Layouts>
            <Layout>
              <Tab id="tab_work" taborder="0" tabindex="0" left="0" top="0" right="0" bottom="0" cssclass="tab_master">
                <Tabpages>
                  <Tabpage id="Tabpage1" text="품목" formscrolltype="vertical" tooltiptext="39E398BEF43A428C8343EFE08F22CDE4">
                    <Layouts>
                      <Layout>
                        <Div id="div_total" taborder="0" text="div_00" left="0" top="0" height="225" right="0" cssclass="div_WF_modulePart_S">
                          <Layouts>
                            <Layout>
                              <Static id="sta_subtitleTotal" taborder="0" text="Total" left="0.00%" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" width="43" fittocontents="width"/>
                              <Grid id="grd_total" taborder="1" left="332" top="34" autoenter="select" right="0" binddataset="ds_defectGrpT" selecttype="cell" height="189">
                                <Formats>
                                  <Format id="default">
                                    <Columns>
                                      <Column size="40"/>
                                      <Column size="80"/>
                                      <Column size="80"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                    </Columns>
                                    <Rows>
                                      <Row size="24" band="head"/>
                                      <Row size="24"/>
                                      <Row size="24" band="summ"/>
                                    </Rows>
                                    <Band id="head">
                                      <Cell text="No"/>
                                      <Cell col="1" text="LAYER" tooltiptext="44C87C99332444CC8A076FBDB35DA9C2"/>
                                      <Cell col="2" text="검사수" tooltiptext="QCMFINALINSPECTQTY"/>
                                      <Cell col="3" text="불량명 (그룹)" tooltiptext="DefectGroupName"/>
                                      <Cell col="4" text="불량수 (그룹)" tooltiptext="DefectGroupCount2"/>
                                      <Cell col="5" text="불량율 (그룹)" tooltiptext="DefectGroupRate2"/>
                                      <Cell col="6" text="불량명 (세부)" tooltiptext="DefectDetailName"/>
                                      <Cell col="7" text="불량수 (세부)" tooltiptext="DefectDetailCount"/>
                                      <Cell col="8" text="불량율 (세부)" tooltiptext="DefectDetailRate"/>
                                    </Band>
                                    <Band id="body">
                                      <Cell text="expr:currow+1"/>
                                      <Cell col="1" text="bind:LAYERNM" suppress="1"/>
                                      <Cell col="2" text="bind:TOTAL_INSPECTIONQTY" suppress="2" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="3" text="bind:GROUPNAME" suppress="3"/>
                                      <Cell col="4" suppress="4" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setTotalDefectCnt(GROUPCODE,LAYERID,'ds_defectGrpT')" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="5" suppress="5" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setGrpRate(GROUPCODE,LAYERID,TOTAL_INSPECTIONQTY,'ds_defectGrpT')"/>
                                      <Cell col="6" text="bind:SUBNAME" suppress="6"/>
                                      <Cell col="7" text="bind:DEFECTCOUNT" suppress="7" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="8" suppress="8" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setDetailRate(TOTAL_INSPECTIONQTY, DEFECTCOUNT)"/>
                                    </Band>
                                    <Band id="summary">
                                      <Cell/>
                                      <Cell col="1"/>
                                      <Cell col="2"/>
                                      <Cell col="3"/>
                                      <Cell col="4"/>
                                      <Cell col="5"/>
                                      <Cell col="6"/>
                                      <Cell col="7" text="expr:dataset.getSum(&quot;parseFloat(DEFECTCOUNT)&quot;)" displaytype="number"/>
                                      <Cell col="8" text="expr:comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setSumGrpRateTotal('ds_defectGrpTcopy')"/>
                                    </Band>
                                  </Format>
                                </Formats>
                              </Grid>
                              <Button id="btn_filter" taborder="7" text="필터" top="9" width="34" height="20" cssclass="btn_WF_black" right="39" fittocontents="width" tooltiptext="4B93867528004642A7CB31361D41C80E" onclick="div_detail_tab_work_Tabpage1_div_total_btn_filter_onclick"/>
                              <Div id="div_defectCodeMulti" taborder="6" top="8" height="20" url="dfm::dfm_multiCombo.xfdl" right="btn_filter:10" width="140"/>
                              <Static id="sta_defectCode" taborder="5" text="불량코드" top="8" width="67" height="20" cssclass="sta_WF_label" fittocontents="width" right="div_defectCodeMulti:5" tooltiptext="DEFECTCODE"/>
                              <Div id="div_defectGrpMulti" taborder="4" top="8" height="20" url="dfm::dfm_multiCombo.xfdl" right="sta_defectCode:5" width="140"/>
                              <Static id="sta_defectGrp" taborder="2" text="불량 그룹" top="9" width="67" height="20" cssclass="sta_WF_label" fittocontents="width" right="div_defectGrpMulti:5" tooltiptext="E92464F917AC4ED3AF7A55CA15ACAAB1"/>
                              <Button id="btn_xlDn_grd_total" taborder="3" top="6" width="29" height="24" cssclass="btn_WF_grdExcelDown" tooltiptext="엑셀다운로드" right="0"/>
                              <BasicChart id="chart_grpTotal" taborder="8" left="0" top="34" width="322" height="189" border="1px solid #e8e8e8" categorycolumn="bind:name" binddataset="">
                                <Contents><![CDATA[{
	"title": {
		"id": "title",
		"textfont": "normal 12pt/normal \"맑은 고딕\"",
		"subtextcolor": "#555555",
		"subtextalign": "right",
		"textcolor": "#222222",
		"subtextfont": "normal 10pt/normal \"맑은 고딕\"",
		"visible": true
	},
	"legend": {
		"id": "legend",
		"align": "topcenter",
		"padding": "10px",
		"itemtextfont": "normal 9pt/normal \"맑은 고딕\"",
		"itemtextcolor": "#555555",
		"markertextgap": 3,
		"itemautofit": "false",
		"itemgap": "10",
		"top": "",
		"visible": false,
		"markertype": "square"
	},
	"tooltip": {
		"id": "tooltip",
		"background": "#212121",
		"textcolor": "#ffffff",
		"textfont": "normal 9pt/normal \"맑은 고딕\"",
		"padding": "5px"
	},
	"board": {
		"id": "board",
		"visible": false
	},
	"categoryaxis": {
		"id": "categoryaxis",
		"titletextcolor": "#333333",
		"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
		"labeltextcolor": "#555555",
		"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
		"ticklinestyle": "0px none",
		"boardlinestyle": "1px solid #f1f1f1",
		"axislinestyle": "0px none",
		"gap": "5"
	},
	"seriesset": [
		{
			"id": "series0",
			"titletext": "series",
			"barvisible": true,
			"barfillstyle": "#62be1b,#3c4596,#be0071,#4bc4c2,#f8b334,#9c6add,#2ba3a8,#0c84c1,#ea5d66",
			"barsize": "60",
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:value",
			"barlinestyle": "0px none",
			"valueaxis": "valueaxis0",
			"lineareafillstyle": "#ffffff",
			"lineitemtextposition": "centertop",
			"stacktype": "none"
		},
		{
			"id": "series1",
			"titletext": "series",
			"barvisible": false,
			"barsize": "65",
			"itemtextvisible": true,
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:percentage",
			"linevisible": true,
			"valueaxis": "percentage",
			"lineitemtextgap": "5",
			"lineitemtextposition": "centertop",
			"linestyle": "2px solid #000000",
			"barlinestyle": "1px solid #000000",
			"pointlinestyle": "2px solid #000000",
			"pointfillstyle": "#ffffff",
			"pointitemtextposition": "centertop",
			"itemtext": "expr:percentage+'%'",
			"pointsize": "10"
		}
	],
	"valueaxes": [
		{
			"id": "valueaxis0",
			"boardlinevisible": true,
			"boardlinestyle": "1px solid #f1f1f1",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "0px none",
			"labeltype": "number",
			"titlegap": "10",
			"tickmax": "80",
			"tickmin": "0",
			"axislinestyle": "1px solid #e8e8e8",
			"visible": "true"
		},
		{
			"id": "percentage",
			"boardlinevisible": "false",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "1px solid #f1f1f1",
			"axislinestyle": "1px solid #e8e8e8",
			"gap": "0",
			"tickmin": "0",
			"tickmax": "3",
			"labelgap": "5",
			"visible": "true",
			"opposite": "true",
			"labeltype": "number",
			"boardlinestyle": "1px solid #f1f1f1",
			"labelmask": "#0.00",
			"titlegap": "0",
			"titletextalign": "middle"
		}
	]
}]]></Contents>
                              </BasicChart>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="div_grp01" taborder="1" text="div_00" left="0" top="233" height="223" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_subtitleGrp01" taborder="0" text="Group1&gt;&gt;1L-2L" left="0" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" width="770" fittocontents="none"/>
                              <Button id="btn_xlDn_grd_grp01" taborder="1" top="6" width="29" height="24" cssclass="btn_WF_grdExcelDown" tooltiptext="엑셀다운로드" right="0"/>
                              <Grid id="grd_grp01" taborder="2" left="332" top="34" autoenter="select" right="0" binddataset="ds_defectGrp01" selecttype="cell" height="189">
                                <Formats>
                                  <Format id="default">
                                    <Columns>
                                      <Column size="40"/>
                                      <Column size="80"/>
                                      <Column size="80"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                    </Columns>
                                    <Rows>
                                      <Row size="24" band="head"/>
                                      <Row size="24"/>
                                      <Row size="24" band="summ"/>
                                    </Rows>
                                    <Band id="head">
                                      <Cell text="No"/>
                                      <Cell col="1" text="LAYER" tooltiptext="44C87C99332444CC8A076FBDB35DA9C2"/>
                                      <Cell col="2" text="검사수" tooltiptext="QCMFINALINSPECTQTY"/>
                                      <Cell col="3" text="불량명 (그룹)" tooltiptext="DefectGroupName"/>
                                      <Cell col="4" text="불량수 (그룹)" tooltiptext="DefectGroupCount2"/>
                                      <Cell col="5" text="불량율 (그룹)" tooltiptext="DefectGroupRate2"/>
                                      <Cell col="6" text="불량명 (세부)" tooltiptext="DefectDetailName"/>
                                      <Cell col="7" text="불량수 (세부)" tooltiptext="DefectDetailCount"/>
                                      <Cell col="8" text="불량율 (세부)" tooltiptext="DefectDetailRate"/>
                                    </Band>
                                    <Band id="body">
                                      <Cell text="expr:currow+1"/>
                                      <Cell col="1" text="bind:LAYERNM" suppress="1"/>
                                      <Cell col="2" text="bind:TOTAL_INSPECTIONQTY" suppress="2" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="3" text="bind:GROUPNAME" suppress="3"/>
                                      <Cell col="4" suppress="4" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setTotalDefectCnt(GROUPCODE,LAYERID,'ds_defectGrp01')" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="5" suppress="5" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setGrpRate(GROUPCODE,LAYERID,TOTAL_INSPECTIONQTY,'ds_defectGrp01')"/>
                                      <Cell col="6" text="bind:SUBNAME" suppress="6"/>
                                      <Cell col="7" text="bind:DEFECTCOUNT" suppress="7" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="8" suppress="8" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setDetailRate(TOTAL_INSPECTIONQTY, DEFECTCOUNT)"/>
                                    </Band>
                                    <Band id="summary">
                                      <Cell/>
                                      <Cell col="1"/>
                                      <Cell col="2"/>
                                      <Cell col="3"/>
                                      <Cell col="4"/>
                                      <Cell col="5"/>
                                      <Cell col="6"/>
                                      <Cell col="7" text="expr:dataset.getSum(&quot;parseFloat(DEFECTCOUNT)&quot;)" displaytype="number"/>
                                      <Cell col="8" text="expr:comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setSumGrpRate('ds_defectGrpTotal01')"/>
                                    </Band>
                                  </Format>
                                </Formats>
                              </Grid>
                              <BasicChart id="chart_grp01" taborder="3" left="0" top="34" width="322" height="189" border="1px solid #e8e8e8" categorycolumn="bind:name" binddataset="">
                                <Contents><![CDATA[{
	"title": {
		"id": "title",
		"textfont": "normal 12pt/normal \"맑은 고딕\"",
		"subtextcolor": "#555555",
		"subtextalign": "right",
		"textcolor": "#222222",
		"subtextfont": "normal 10pt/normal \"맑은 고딕\"",
		"visible": true
	},
	"legend": {
		"id": "legend",
		"align": "topcenter",
		"padding": "10px",
		"itemtextfont": "normal 9pt/normal \"맑은 고딕\"",
		"itemtextcolor": "#555555",
		"markertextgap": 3,
		"itemautofit": "false",
		"itemgap": "10",
		"top": "",
		"visible": false,
		"markertype": "square"
	},
	"tooltip": {
		"id": "tooltip",
		"background": "#212121",
		"textcolor": "#ffffff",
		"textfont": "normal 9pt/normal \"맑은 고딕\"",
		"padding": "5px"
	},
	"board": {
		"id": "board",
		"visible": false
	},
	"categoryaxis": {
		"id": "categoryaxis",
		"titletextcolor": "#333333",
		"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
		"labeltextcolor": "#555555",
		"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
		"ticklinestyle": "0px none",
		"boardlinestyle": "1px solid #f1f1f1",
		"axislinestyle": "0px none",
		"gap": "5"
	},
	"seriesset": [
		{
			"id": "series0",
			"titletext": "series",
			"barvisible": true,
			"barfillstyle": "#62be1b,#3c4596,#be0071,#4bc4c2,#f8b334,#9c6add,#2ba3a8,#0c84c1,#ea5d66",
			"barsize": "60",
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:value",
			"barlinestyle": "0px none",
			"valueaxis": "valueaxis0",
			"lineareafillstyle": "#ffffff",
			"lineitemtextposition": "centertop",
			"stacktype": "none"
		},
		{
			"id": "series1",
			"titletext": "series",
			"barvisible": false,
			"barsize": "65",
			"itemtextvisible": true,
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:percentage",
			"linevisible": true,
			"valueaxis": "percentage",
			"lineitemtextgap": "5",
			"lineitemtextposition": "centertop",
			"linestyle": "2px solid #000000",
			"barlinestyle": "1px solid #000000",
			"pointlinestyle": "2px solid #000000",
			"pointfillstyle": "#ffffff",
			"pointitemtextposition": "centertop",
			"itemtext": "expr:percentage+'%'",
			"pointsize": "10"
		}
	],
	"valueaxes": [
		{
			"id": "valueaxis0",
			"boardlinevisible": true,
			"boardlinestyle": "1px solid #f1f1f1",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "0px none",
			"labeltype": "number",
			"titlegap": "10",
			"tickmax": "80",
			"tickmin": "0",
			"axislinestyle": "1px solid #e8e8e8",
			"visible": "true"
		},
		{
			"id": "percentage",
			"boardlinevisible": "false",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "1px solid #f1f1f1",
			"axislinestyle": "1px solid #e8e8e8",
			"gap": "0",
			"tickmin": "0",
			"tickmax": "3",
			"labelgap": "5",
			"visible": "true",
			"opposite": "true",
			"labeltype": "number",
			"boardlinestyle": "1px solid #f1f1f1",
			"labelmask": "#0.00",
			"titlegap": "0",
			"titletextalign": "middle"
		}
	]
}]]></Contents>
                              </BasicChart>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="div_grp02" taborder="2" text="div_00" left="0" top="466" height="223" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_subtitleGrp02" taborder="0" text="Group2&gt;&gt;1L-2L" left="0" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" width="770" fittocontents="none"/>
                              <Button id="btn_xlDn_grd_grp02" taborder="1" top="6" width="29" height="24" cssclass="btn_WF_grdExcelDown" tooltiptext="엑셀다운로드" right="0"/>
                              <Grid id="grd_grp02" taborder="2" left="332" top="34" autoenter="select" right="0" binddataset="ds_defectGrp02" selecttype="cell" height="189">
                                <Formats>
                                  <Format id="default">
                                    <Columns>
                                      <Column size="40"/>
                                      <Column size="80"/>
                                      <Column size="80"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                    </Columns>
                                    <Rows>
                                      <Row size="24" band="head"/>
                                      <Row size="24"/>
                                      <Row size="24" band="summ"/>
                                    </Rows>
                                    <Band id="head">
                                      <Cell text="No"/>
                                      <Cell col="1" text="LAYER" tooltiptext="44C87C99332444CC8A076FBDB35DA9C2"/>
                                      <Cell col="2" text="검사수" tooltiptext="QCMFINALINSPECTQTY"/>
                                      <Cell col="3" text="불량명 (그룹)" tooltiptext="DefectGroupName"/>
                                      <Cell col="4" text="불량수 (그룹)" tooltiptext="DefectGroupCount2"/>
                                      <Cell col="5" text="불량율 (그룹)" tooltiptext="DefectGroupRate2"/>
                                      <Cell col="6" text="불량명 (세부)" tooltiptext="DefectDetailName"/>
                                      <Cell col="7" text="불량수 (세부)" tooltiptext="DefectDetailCount"/>
                                      <Cell col="8" text="불량율 (세부)" tooltiptext="DefectDetailRate"/>
                                    </Band>
                                    <Band id="body">
                                      <Cell text="expr:currow+1"/>
                                      <Cell col="1" text="bind:LAYERNM" suppress="1"/>
                                      <Cell col="2" text="bind:TOTAL_INSPECTIONQTY" suppress="2" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="3" text="bind:GROUPNAME" suppress="3"/>
                                      <Cell col="4" suppress="4" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setTotalDefectCnt(GROUPCODE,LAYERID,'ds_defectGrp02')" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="5" suppress="5" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setGrpRate(GROUPCODE,LAYERID,TOTAL_INSPECTIONQTY,'ds_defectGrp02')"/>
                                      <Cell col="6" text="bind:SUBNAME" suppress="6"/>
                                      <Cell col="7" text="bind:DEFECTCOUNT" suppress="7" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="8" suppress="8" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setDetailRate(TOTAL_INSPECTIONQTY, DEFECTCOUNT)"/>
                                    </Band>
                                    <Band id="summary">
                                      <Cell/>
                                      <Cell col="1"/>
                                      <Cell col="2"/>
                                      <Cell col="3"/>
                                      <Cell col="4"/>
                                      <Cell col="5"/>
                                      <Cell col="6"/>
                                      <Cell col="7" text="expr:dataset.getSum(&quot;parseFloat(DEFECTCOUNT)&quot;)" displaytype="number"/>
                                      <Cell col="8" text="expr:comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setSumGrpRate('ds_defectGrpTotal02')"/>
                                    </Band>
                                  </Format>
                                </Formats>
                              </Grid>
                              <BasicChart id="chart_grp02" taborder="3" left="0" top="34" width="322" height="189" border="1px solid #e8e8e8" categorycolumn="bind:name" binddataset="">
                                <Contents><![CDATA[{
	"title": {
		"id": "title",
		"textfont": "normal 12pt/normal \"맑은 고딕\"",
		"subtextcolor": "#555555",
		"subtextalign": "right",
		"textcolor": "#222222",
		"subtextfont": "normal 10pt/normal \"맑은 고딕\"",
		"visible": true
	},
	"legend": {
		"id": "legend",
		"align": "topcenter",
		"padding": "10px",
		"itemtextfont": "normal 9pt/normal \"맑은 고딕\"",
		"itemtextcolor": "#555555",
		"markertextgap": 3,
		"itemautofit": "false",
		"itemgap": "10",
		"top": "",
		"visible": false,
		"markertype": "square"
	},
	"tooltip": {
		"id": "tooltip",
		"background": "#212121",
		"textcolor": "#ffffff",
		"textfont": "normal 9pt/normal \"맑은 고딕\"",
		"padding": "5px"
	},
	"board": {
		"id": "board",
		"visible": false
	},
	"categoryaxis": {
		"id": "categoryaxis",
		"titletextcolor": "#333333",
		"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
		"labeltextcolor": "#555555",
		"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
		"ticklinestyle": "0px none",
		"boardlinestyle": "1px solid #f1f1f1",
		"axislinestyle": "0px none",
		"gap": "5"
	},
	"seriesset": [
		{
			"id": "series0",
			"titletext": "series",
			"barvisible": true,
			"barfillstyle": "#62be1b,#3c4596,#be0071,#4bc4c2,#f8b334,#9c6add,#2ba3a8,#0c84c1,#ea5d66",
			"barsize": "60",
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:value",
			"barlinestyle": "0px none",
			"valueaxis": "valueaxis0",
			"lineareafillstyle": "#ffffff",
			"lineitemtextposition": "centertop",
			"stacktype": "none"
		},
		{
			"id": "series1",
			"titletext": "series",
			"barvisible": false,
			"barsize": "65",
			"itemtextvisible": true,
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:percentage",
			"linevisible": true,
			"valueaxis": "percentage",
			"lineitemtextgap": "5",
			"lineitemtextposition": "centertop",
			"linestyle": "2px solid #000000",
			"barlinestyle": "1px solid #000000",
			"pointlinestyle": "2px solid #000000",
			"pointfillstyle": "#ffffff",
			"pointitemtextposition": "centertop",
			"itemtext": "expr:percentage+'%'",
			"pointsize": "10"
		}
	],
	"valueaxes": [
		{
			"id": "valueaxis0",
			"boardlinevisible": true,
			"boardlinestyle": "1px solid #f1f1f1",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "0px none",
			"labeltype": "number",
			"titlegap": "10",
			"tickmax": "80",
			"tickmin": "0",
			"axislinestyle": "1px solid #e8e8e8",
			"visible": "true"
		},
		{
			"id": "percentage",
			"boardlinevisible": "false",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "1px solid #f1f1f1",
			"axislinestyle": "1px solid #e8e8e8",
			"gap": "0",
			"tickmin": "0",
			"tickmax": "3",
			"labelgap": "5",
			"visible": "true",
			"opposite": "true",
			"labeltype": "number",
			"boardlinestyle": "1px solid #f1f1f1",
			"labelmask": "#0.00",
			"titlegap": "0",
			"titletextalign": "middle"
		}
	]
}]]></Contents>
                              </BasicChart>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="div_grp03" taborder="3" text="div_00" left="0" top="699" height="223" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_subtitleGrp03" taborder="0" text="Group3&gt;&gt;1L-2L" left="0" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" width="770" fittocontents="none"/>
                              <Button id="btn_xlDn_grd_grp03" taborder="1" top="6" width="29" height="24" cssclass="btn_WF_grdExcelDown" tooltiptext="엑셀다운로드" right="0"/>
                              <BasicChart id="chart_grp03" taborder="2" left="0" top="34" width="322" height="189" border="1px solid #e8e8e8" categorycolumn="bind:name" binddataset="">
                                <Contents><![CDATA[{
	"title": {
		"id": "title",
		"textfont": "normal 12pt/normal \"맑은 고딕\"",
		"subtextcolor": "#555555",
		"subtextalign": "right",
		"textcolor": "#222222",
		"subtextfont": "normal 10pt/normal \"맑은 고딕\"",
		"visible": true
	},
	"legend": {
		"id": "legend",
		"align": "topcenter",
		"padding": "10px",
		"itemtextfont": "normal 9pt/normal \"맑은 고딕\"",
		"itemtextcolor": "#555555",
		"markertextgap": 3,
		"itemautofit": "false",
		"itemgap": "10",
		"top": "",
		"visible": false,
		"markertype": "square"
	},
	"tooltip": {
		"id": "tooltip",
		"background": "#212121",
		"textcolor": "#ffffff",
		"textfont": "normal 9pt/normal \"맑은 고딕\"",
		"padding": "5px"
	},
	"board": {
		"id": "board",
		"visible": false
	},
	"categoryaxis": {
		"id": "categoryaxis",
		"titletextcolor": "#333333",
		"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
		"labeltextcolor": "#555555",
		"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
		"ticklinestyle": "0px none",
		"boardlinestyle": "1px solid #f1f1f1",
		"axislinestyle": "0px none",
		"gap": "5"
	},
	"seriesset": [
		{
			"id": "series0",
			"titletext": "series",
			"barvisible": true,
			"barfillstyle": "#62be1b,#3c4596,#be0071,#4bc4c2,#f8b334,#9c6add,#2ba3a8,#0c84c1,#ea5d66",
			"barsize": "60",
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:value",
			"barlinestyle": "0px none",
			"valueaxis": "valueaxis0",
			"lineareafillstyle": "#ffffff",
			"lineitemtextposition": "centertop",
			"stacktype": "none"
		},
		{
			"id": "series1",
			"titletext": "series",
			"barvisible": false,
			"barsize": "65",
			"itemtextvisible": true,
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:percentage",
			"linevisible": true,
			"valueaxis": "percentage",
			"lineitemtextgap": "5",
			"lineitemtextposition": "centertop",
			"linestyle": "2px solid #000000",
			"barlinestyle": "1px solid #000000",
			"pointlinestyle": "2px solid #000000",
			"pointfillstyle": "#ffffff",
			"pointitemtextposition": "centertop",
			"itemtext": "expr:percentage+'%'",
			"pointsize": "10"
		}
	],
	"valueaxes": [
		{
			"id": "valueaxis0",
			"boardlinevisible": true,
			"boardlinestyle": "1px solid #f1f1f1",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "0px none",
			"labeltype": "number",
			"titlegap": "10",
			"tickmax": "80",
			"tickmin": "0",
			"axislinestyle": "1px solid #e8e8e8",
			"visible": "true"
		},
		{
			"id": "percentage",
			"boardlinevisible": "false",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "1px solid #f1f1f1",
			"axislinestyle": "1px solid #e8e8e8",
			"gap": "0",
			"tickmin": "0",
			"tickmax": "3",
			"labelgap": "5",
			"visible": "true",
			"opposite": "true",
			"labeltype": "number",
			"boardlinestyle": "1px solid #f1f1f1",
			"labelmask": "#0.00",
			"titlegap": "0",
			"titletextalign": "middle"
		}
	]
}]]></Contents>
                              </BasicChart>
                              <Grid id="grd_grp03" taborder="3" left="332" top="34" autoenter="select" right="0" binddataset="ds_defectGrp03" selecttype="cell" height="189">
                                <Formats>
                                  <Format id="default">
                                    <Columns>
                                      <Column size="40"/>
                                      <Column size="80"/>
                                      <Column size="80"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                    </Columns>
                                    <Rows>
                                      <Row size="24" band="head"/>
                                      <Row size="24"/>
                                      <Row size="24" band="summ"/>
                                    </Rows>
                                    <Band id="head">
                                      <Cell text="No"/>
                                      <Cell col="1" text="LAYER" tooltiptext="44C87C99332444CC8A076FBDB35DA9C2"/>
                                      <Cell col="2" text="검사수" tooltiptext="QCMFINALINSPECTQTY"/>
                                      <Cell col="3" text="불량명 (그룹)" tooltiptext="DefectGroupName"/>
                                      <Cell col="4" text="불량수 (그룹)" tooltiptext="DefectGroupCount2"/>
                                      <Cell col="5" text="불량율 (그룹)" tooltiptext="DefectGroupRate2"/>
                                      <Cell col="6" text="불량명 (세부)" tooltiptext="DefectDetailName"/>
                                      <Cell col="7" text="불량수 (세부)" tooltiptext="DefectDetailCount"/>
                                      <Cell col="8" text="불량율 (세부)" tooltiptext="DefectDetailRate"/>
                                    </Band>
                                    <Band id="body">
                                      <Cell text="expr:currow+1"/>
                                      <Cell col="1" text="bind:LAYERNM" suppress="1"/>
                                      <Cell col="2" text="bind:TOTAL_INSPECTIONQTY" suppress="2" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="3" text="bind:GROUPNAME" suppress="3"/>
                                      <Cell col="4" suppress="4" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setTotalDefectCnt(GROUPCODE,LAYERID,'ds_defectGrp03')" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="5" suppress="5" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setGrpRate(GROUPCODE,LAYERID,TOTAL_INSPECTIONQTY,'ds_defectGrp03')"/>
                                      <Cell col="6" text="bind:SUBNAME" suppress="6"/>
                                      <Cell col="7" text="bind:DEFECTCOUNT" suppress="7" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="8" suppress="8" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setDetailRate(TOTAL_INSPECTIONQTY, DEFECTCOUNT)"/>
                                    </Band>
                                    <Band id="summary">
                                      <Cell/>
                                      <Cell col="1"/>
                                      <Cell col="2"/>
                                      <Cell col="3"/>
                                      <Cell col="4"/>
                                      <Cell col="5"/>
                                      <Cell col="6"/>
                                      <Cell col="7" text="expr:dataset.getSum(&quot;parseFloat(DEFECTCOUNT)&quot;)" displaytype="number"/>
                                      <Cell col="8" text="expr:comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setSumGrpRate('ds_defectGrpTotal03')"/>
                                    </Band>
                                  </Format>
                                </Formats>
                              </Grid>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="div_grp04" taborder="4" text="div_00" left="0" top="932" height="223" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_subtitleGrp04" taborder="0" text="Group4&gt;&gt;1L-2L" left="0" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" width="770" fittocontents="none"/>
                              <Button id="btn_xlDn_grd_grp04" taborder="1" top="6" width="29" height="24" cssclass="btn_WF_grdExcelDown" tooltiptext="엑셀업로드" right="0"/>
                              <BasicChart id="chart_grp04" taborder="2" left="0" top="34" width="322" height="189" border="1px solid #e8e8e8" categorycolumn="bind:name" binddataset="">
                                <Contents><![CDATA[{
	"title": {
		"id": "title",
		"textfont": "normal 12pt/normal \"맑은 고딕\"",
		"subtextcolor": "#555555",
		"subtextalign": "right",
		"textcolor": "#222222",
		"subtextfont": "normal 10pt/normal \"맑은 고딕\"",
		"visible": true
	},
	"legend": {
		"id": "legend",
		"align": "topcenter",
		"padding": "10px",
		"itemtextfont": "normal 9pt/normal \"맑은 고딕\"",
		"itemtextcolor": "#555555",
		"markertextgap": 3,
		"itemautofit": "false",
		"itemgap": "10",
		"top": "",
		"visible": false,
		"markertype": "square"
	},
	"tooltip": {
		"id": "tooltip",
		"background": "#212121",
		"textcolor": "#ffffff",
		"textfont": "normal 9pt/normal \"맑은 고딕\"",
		"padding": "5px"
	},
	"board": {
		"id": "board",
		"visible": false
	},
	"categoryaxis": {
		"id": "categoryaxis",
		"titletextcolor": "#333333",
		"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
		"labeltextcolor": "#555555",
		"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
		"ticklinestyle": "0px none",
		"boardlinestyle": "1px solid #f1f1f1",
		"axislinestyle": "0px none",
		"gap": "5"
	},
	"seriesset": [
		{
			"id": "series0",
			"titletext": "series",
			"barvisible": true,
			"barfillstyle": "#62be1b,#3c4596,#be0071,#4bc4c2,#f8b334,#9c6add,#2ba3a8,#0c84c1,#ea5d66",
			"barsize": "60",
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:value",
			"barlinestyle": "0px none",
			"valueaxis": "valueaxis0",
			"lineareafillstyle": "#ffffff",
			"lineitemtextposition": "centertop",
			"stacktype": "none"
		},
		{
			"id": "series1",
			"titletext": "series",
			"barvisible": false,
			"barsize": "65",
			"itemtextvisible": true,
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:percentage",
			"linevisible": true,
			"valueaxis": "percentage",
			"lineitemtextgap": "5",
			"lineitemtextposition": "centertop",
			"linestyle": "2px solid #000000",
			"barlinestyle": "1px solid #000000",
			"pointlinestyle": "2px solid #000000",
			"pointfillstyle": "#ffffff",
			"pointitemtextposition": "centertop",
			"itemtext": "expr:percentage+'%'",
			"pointsize": "10"
		}
	],
	"valueaxes": [
		{
			"id": "valueaxis0",
			"boardlinevisible": true,
			"boardlinestyle": "1px solid #f1f1f1",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "0px none",
			"labeltype": "number",
			"titlegap": "10",
			"tickmax": "80",
			"tickmin": "0",
			"axislinestyle": "1px solid #e8e8e8",
			"visible": "true"
		},
		{
			"id": "percentage",
			"boardlinevisible": "false",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "1px solid #f1f1f1",
			"axislinestyle": "1px solid #e8e8e8",
			"gap": "0",
			"tickmin": "0",
			"tickmax": "3",
			"labelgap": "5",
			"visible": "true",
			"opposite": "true",
			"labeltype": "number",
			"boardlinestyle": "1px solid #f1f1f1",
			"labelmask": "#0.00",
			"titlegap": "0",
			"titletextalign": "middle"
		}
	]
}]]></Contents>
                              </BasicChart>
                              <Grid id="grd_grp04" taborder="3" left="332" top="34" autoenter="select" right="0" binddataset="ds_defectGrp04" selecttype="cell" height="189">
                                <Formats>
                                  <Format id="default">
                                    <Columns>
                                      <Column size="40"/>
                                      <Column size="80"/>
                                      <Column size="80"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                    </Columns>
                                    <Rows>
                                      <Row size="24" band="head"/>
                                      <Row size="24"/>
                                      <Row size="24" band="summ"/>
                                    </Rows>
                                    <Band id="head">
                                      <Cell text="No"/>
                                      <Cell col="1" text="LAYER" tooltiptext="44C87C99332444CC8A076FBDB35DA9C2"/>
                                      <Cell col="2" text="검사수" tooltiptext="QCMFINALINSPECTQTY"/>
                                      <Cell col="3" text="불량명 (그룹)" tooltiptext="DefectGroupName"/>
                                      <Cell col="4" text="불량수 (그룹)" tooltiptext="DefectGroupCount2"/>
                                      <Cell col="5" text="불량율 (그룹)" tooltiptext="DefectGroupRate2"/>
                                      <Cell col="6" text="불량명 (세부)" tooltiptext="DefectDetailName"/>
                                      <Cell col="7" text="불량수 (세부)" tooltiptext="DefectDetailCount"/>
                                      <Cell col="8" text="불량율 (세부)" tooltiptext="DefectDetailRate"/>
                                    </Band>
                                    <Band id="body">
                                      <Cell text="expr:currow+1"/>
                                      <Cell col="1" text="bind:LAYERNM" suppress="1"/>
                                      <Cell col="2" text="bind:TOTAL_INSPECTIONQTY" suppress="2" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="3" text="bind:GROUPNAME" suppress="3"/>
                                      <Cell col="4" suppress="4" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setTotalDefectCnt(GROUPCODE,LAYERID,'ds_defectGrp04')" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="5" suppress="5" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setGrpRate(GROUPCODE,LAYERID,TOTAL_INSPECTIONQTY,'ds_defectGrp04')"/>
                                      <Cell col="6" text="bind:SUBNAME" suppress="6"/>
                                      <Cell col="7" text="bind:DEFECTCOUNT" suppress="7" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="8" suppress="8" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setDetailRate(TOTAL_INSPECTIONQTY, DEFECTCOUNT)"/>
                                    </Band>
                                    <Band id="summary">
                                      <Cell/>
                                      <Cell col="1"/>
                                      <Cell col="2"/>
                                      <Cell col="3"/>
                                      <Cell col="4"/>
                                      <Cell col="5"/>
                                      <Cell col="6"/>
                                      <Cell col="7" text="expr:dataset.getSum(&quot;parseFloat(DEFECTCOUNT)&quot;)" displaytype="number"/>
                                      <Cell col="8" text="expr:comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setSumGrpRate('ds_defectGrpTotal04')"/>
                                    </Band>
                                  </Format>
                                </Formats>
                              </Grid>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="div_grp05" taborder="5" text="div_00" left="0" top="1165" height="223" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_subtitleGrp05" taborder="0" text="Group5&gt;&gt;1L-2L" left="0" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" width="770" fittocontents="none"/>
                              <Button id="btn_xlDn_grd_grp05" taborder="1" top="6" width="29" height="24" cssclass="btn_WF_grdExcelDown" tooltiptext="엑셀업로드" right="0"/>
                              <BasicChart id="chart_grp05" taborder="2" left="0" top="34" width="322" height="189" border="1px solid #e8e8e8" categorycolumn="bind:name" binddataset="">
                                <Contents><![CDATA[{
	"title": {
		"id": "title",
		"textfont": "normal 12pt/normal \"맑은 고딕\"",
		"subtextcolor": "#555555",
		"subtextalign": "right",
		"textcolor": "#222222",
		"subtextfont": "normal 10pt/normal \"맑은 고딕\"",
		"visible": true
	},
	"legend": {
		"id": "legend",
		"align": "topcenter",
		"padding": "10px",
		"itemtextfont": "normal 9pt/normal \"맑은 고딕\"",
		"itemtextcolor": "#555555",
		"markertextgap": 3,
		"itemautofit": "false",
		"itemgap": "10",
		"top": "",
		"visible": false,
		"markertype": "square"
	},
	"tooltip": {
		"id": "tooltip",
		"background": "#212121",
		"textcolor": "#ffffff",
		"textfont": "normal 9pt/normal \"맑은 고딕\"",
		"padding": "5px"
	},
	"board": {
		"id": "board",
		"visible": false
	},
	"categoryaxis": {
		"id": "categoryaxis",
		"titletextcolor": "#333333",
		"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
		"labeltextcolor": "#555555",
		"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
		"ticklinestyle": "0px none",
		"boardlinestyle": "1px solid #f1f1f1",
		"axislinestyle": "0px none",
		"gap": "5"
	},
	"seriesset": [
		{
			"id": "series0",
			"titletext": "series",
			"barvisible": true,
			"barfillstyle": "#62be1b,#3c4596,#be0071,#4bc4c2,#f8b334,#9c6add,#2ba3a8,#0c84c1,#ea5d66",
			"barsize": "60",
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:value",
			"barlinestyle": "0px none",
			"valueaxis": "valueaxis0",
			"lineareafillstyle": "#ffffff",
			"lineitemtextposition": "centertop",
			"stacktype": "none"
		},
		{
			"id": "series1",
			"titletext": "series",
			"barvisible": false,
			"barsize": "65",
			"itemtextvisible": true,
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:percentage",
			"linevisible": true,
			"valueaxis": "percentage",
			"lineitemtextgap": "5",
			"lineitemtextposition": "centertop",
			"linestyle": "2px solid #000000",
			"barlinestyle": "1px solid #000000",
			"pointlinestyle": "2px solid #000000",
			"pointfillstyle": "#ffffff",
			"pointitemtextposition": "centertop",
			"itemtext": "expr:percentage+'%'",
			"pointsize": "10"
		}
	],
	"valueaxes": [
		{
			"id": "valueaxis0",
			"boardlinevisible": true,
			"boardlinestyle": "1px solid #f1f1f1",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "0px none",
			"labeltype": "number",
			"titlegap": "10",
			"tickmax": "80",
			"tickmin": "0",
			"axislinestyle": "1px solid #e8e8e8",
			"visible": "true"
		},
		{
			"id": "percentage",
			"boardlinevisible": "false",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "1px solid #f1f1f1",
			"axislinestyle": "1px solid #e8e8e8",
			"gap": "0",
			"tickmin": "0",
			"tickmax": "3",
			"labelgap": "5",
			"visible": "true",
			"opposite": "true",
			"labeltype": "number",
			"boardlinestyle": "1px solid #f1f1f1",
			"labelmask": "#0.00",
			"titlegap": "0",
			"titletextalign": "middle"
		}
	]
}]]></Contents>
                              </BasicChart>
                              <Grid id="grd_grp05" taborder="3" left="332" top="34" autoenter="select" right="0" binddataset="ds_defectGrp05" selecttype="cell" height="189">
                                <Formats>
                                  <Format id="default">
                                    <Columns>
                                      <Column size="40"/>
                                      <Column size="80"/>
                                      <Column size="80"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                    </Columns>
                                    <Rows>
                                      <Row size="24" band="head"/>
                                      <Row size="24"/>
                                      <Row size="24" band="summ"/>
                                    </Rows>
                                    <Band id="head">
                                      <Cell text="No"/>
                                      <Cell col="1" text="LAYER" tooltiptext="44C87C99332444CC8A076FBDB35DA9C2"/>
                                      <Cell col="2" text="검사수" tooltiptext="QCMFINALINSPECTQTY"/>
                                      <Cell col="3" text="불량명 (그룹)" tooltiptext="DefectGroupName"/>
                                      <Cell col="4" text="불량수 (그룹)" tooltiptext="DefectGroupCount2"/>
                                      <Cell col="5" text="불량율 (그룹)" tooltiptext="DefectGroupRate2"/>
                                      <Cell col="6" text="불량명 (세부)" tooltiptext="DefectDetailName"/>
                                      <Cell col="7" text="불량수 (세부)" tooltiptext="DefectDetailCount"/>
                                      <Cell col="8" text="불량율 (세부)" tooltiptext="DefectDetailRate"/>
                                    </Band>
                                    <Band id="body">
                                      <Cell text="expr:currow+1"/>
                                      <Cell col="1" text="bind:LAYERNM" suppress="1"/>
                                      <Cell col="2" text="bind:TOTAL_INSPECTIONQTY" suppress="2" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="3" text="bind:GROUPNAME" suppress="3"/>
                                      <Cell col="4" suppress="4" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setTotalDefectCnt(GROUPCODE,LAYERID,'ds_defectGrp05')" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="5" suppress="5" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setGrpRate(GROUPCODE,LAYERID,TOTAL_INSPECTIONQTY,'ds_defectGrp05')"/>
                                      <Cell col="6" text="bind:SUBNAME" suppress="6"/>
                                      <Cell col="7" text="bind:DEFECTCOUNT" suppress="7" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="8" suppress="8" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setDetailRate(TOTAL_INSPECTIONQTY, DEFECTCOUNT)"/>
                                    </Band>
                                    <Band id="summary">
                                      <Cell/>
                                      <Cell col="1"/>
                                      <Cell col="2"/>
                                      <Cell col="3"/>
                                      <Cell col="4"/>
                                      <Cell col="5"/>
                                      <Cell col="6"/>
                                      <Cell col="7" text="expr:dataset.getSum(&quot;parseFloat(DEFECTCOUNT)&quot;)" displaytype="number"/>
                                      <Cell col="8" text="expr:comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setSumGrpRate('ds_defectGrpTotal05')"/>
                                    </Band>
                                  </Format>
                                </Formats>
                              </Grid>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="div_grp06" taborder="6" text="div_00" left="0" top="1398" height="223" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_subtitleGrp06" taborder="0" text="Group6&gt;&gt;1L-2L" left="0" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" width="770" fittocontents="none"/>
                              <Button id="btn_xlDn_grd_grp06" taborder="1" top="6" width="29" height="24" cssclass="btn_WF_grdExcelDown" tooltiptext="엑셀업로드" right="0"/>
                              <BasicChart id="chart_grp06" taborder="2" left="0" top="34" width="322" height="189" border="1px solid #e8e8e8" categorycolumn="bind:name" binddataset="">
                                <Contents><![CDATA[{
	"title": {
		"id": "title",
		"textfont": "normal 12pt/normal \"맑은 고딕\"",
		"subtextcolor": "#555555",
		"subtextalign": "right",
		"textcolor": "#222222",
		"subtextfont": "normal 10pt/normal \"맑은 고딕\"",
		"visible": true
	},
	"legend": {
		"id": "legend",
		"align": "topcenter",
		"padding": "10px",
		"itemtextfont": "normal 9pt/normal \"맑은 고딕\"",
		"itemtextcolor": "#555555",
		"markertextgap": 3,
		"itemautofit": "false",
		"itemgap": "10",
		"top": "",
		"visible": false,
		"markertype": "square"
	},
	"tooltip": {
		"id": "tooltip",
		"background": "#212121",
		"textcolor": "#ffffff",
		"textfont": "normal 9pt/normal \"맑은 고딕\"",
		"padding": "5px"
	},
	"board": {
		"id": "board",
		"visible": false
	},
	"categoryaxis": {
		"id": "categoryaxis",
		"titletextcolor": "#333333",
		"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
		"labeltextcolor": "#555555",
		"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
		"ticklinestyle": "0px none",
		"boardlinestyle": "1px solid #f1f1f1",
		"axislinestyle": "0px none",
		"gap": "5"
	},
	"seriesset": [
		{
			"id": "series0",
			"titletext": "series",
			"barvisible": true,
			"barfillstyle": "#62be1b,#3c4596,#be0071,#4bc4c2,#f8b334,#9c6add,#2ba3a8,#0c84c1,#ea5d66",
			"barsize": "60",
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:value",
			"barlinestyle": "0px none",
			"valueaxis": "valueaxis0",
			"lineareafillstyle": "#ffffff",
			"lineitemtextposition": "centertop",
			"stacktype": "none"
		},
		{
			"id": "series1",
			"titletext": "series",
			"barvisible": false,
			"barsize": "65",
			"itemtextvisible": true,
			"itemtextcolor": "#333333",
			"itemtextfont": "bold 10pt '맑은 고딕'",
			"valuecolumn": "bind:percentage",
			"linevisible": true,
			"valueaxis": "percentage",
			"lineitemtextgap": "5",
			"lineitemtextposition": "centertop",
			"linestyle": "2px solid #000000",
			"barlinestyle": "1px solid #000000",
			"pointlinestyle": "2px solid #000000",
			"pointfillstyle": "#ffffff",
			"pointitemtextposition": "centertop",
			"itemtext": "expr:percentage+'%'",
			"pointsize": "10"
		}
	],
	"valueaxes": [
		{
			"id": "valueaxis0",
			"boardlinevisible": true,
			"boardlinestyle": "1px solid #f1f1f1",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "0px none",
			"labeltype": "number",
			"titlegap": "10",
			"tickmax": "80",
			"tickmin": "0",
			"axislinestyle": "1px solid #e8e8e8",
			"visible": "true"
		},
		{
			"id": "percentage",
			"boardlinevisible": "false",
			"labeltextcolor": "#777777",
			"labeltextfont": "normal 9pt/normal \"맑은 고딕\"",
			"titletextcolor": "#333333",
			"titletextfont": "normal 700 10pt/normal \"맑은 고딕\"",
			"ticklinestyle": "1px solid #f1f1f1",
			"axislinestyle": "1px solid #e8e8e8",
			"gap": "0",
			"tickmin": "0",
			"tickmax": "3",
			"labelgap": "5",
			"visible": "true",
			"opposite": "true",
			"labeltype": "number",
			"boardlinestyle": "1px solid #f1f1f1",
			"labelmask": "#0.00",
			"titlegap": "0",
			"titletextalign": "middle"
		}
	]
}]]></Contents>
                              </BasicChart>
                              <Grid id="grd_grp06" taborder="3" left="332" top="34" autoenter="select" right="0" binddataset="ds_defectGrp06" selecttype="cell" height="189">
                                <Formats>
                                  <Format id="default">
                                    <Columns>
                                      <Column size="40"/>
                                      <Column size="80"/>
                                      <Column size="80"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                      <Column size="120"/>
                                    </Columns>
                                    <Rows>
                                      <Row size="24" band="head"/>
                                      <Row size="24"/>
                                      <Row size="24" band="summ"/>
                                    </Rows>
                                    <Band id="head">
                                      <Cell text="No"/>
                                      <Cell col="1" text="LAYER" tooltiptext="44C87C99332444CC8A076FBDB35DA9C2"/>
                                      <Cell col="2" text="검사수" tooltiptext="QCMFINALINSPECTQTY"/>
                                      <Cell col="3" text="불량명 (그룹)" tooltiptext="DefectGroupName"/>
                                      <Cell col="4" text="불량수 (그룹)" tooltiptext="DefectGroupCount2"/>
                                      <Cell col="5" text="불량율 (그룹)" tooltiptext="DefectGroupRate2"/>
                                      <Cell col="6" text="불량명 (세부)" tooltiptext="DefectDetailName"/>
                                      <Cell col="7" text="불량수 (세부)" tooltiptext="DefectDetailCount"/>
                                      <Cell col="8" text="불량율 (세부)" tooltiptext="DefectDetailRate"/>
                                    </Band>
                                    <Band id="body">
                                      <Cell text="expr:currow+1"/>
                                      <Cell col="1" text="bind:LAYERNM" suppress="1"/>
                                      <Cell col="2" text="bind:TOTAL_INSPECTIONQTY" suppress="2" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="3" text="bind:GROUPNAME" suppress="3"/>
                                      <Cell col="4" suppress="4" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setTotalDefectCnt(GROUPCODE,LAYERID,'ds_defectGrp06')" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="5" suppress="5" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setGrpRate(GROUPCODE,LAYERID,TOTAL_INSPECTIONQTY,'ds_defectGrp06')"/>
                                      <Cell col="6" text="bind:SUBNAME" suppress="6"/>
                                      <Cell col="7" text="bind:DEFECTCOUNT" suppress="7" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                      <Cell col="8" suppress="8" textAlign="right" expr="comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setDetailRate(TOTAL_INSPECTIONQTY, DEFECTCOUNT)"/>
                                    </Band>
                                    <Band id="summary">
                                      <Cell/>
                                      <Cell col="1"/>
                                      <Cell col="2"/>
                                      <Cell col="3"/>
                                      <Cell col="4"/>
                                      <Cell col="5"/>
                                      <Cell col="6"/>
                                      <Cell col="7" text="expr:dataset.getSum(&quot;parseFloat(DEFECTCOUNT)&quot;)" displaytype="number"/>
                                      <Cell col="8" text="expr:comp.parent.parent.parent.parent.parent.parent.parent.parent.fn_setSumGrpRate('ds_defectGrpTotal06')"/>
                                    </Band>
                                  </Format>
                                </Formats>
                              </Grid>
                            </Layout>
                          </Layouts>
                        </Div>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="Tabpage3" text="Raw Data" tooltiptext="TABROWDATA">
                    <Layouts>
                      <Layout>
                        <Static id="subtitle1" taborder="0" text="Raw Data" left="0" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" fittocontents="width" width="73" tooltiptext="TABROWDATA"/>
                        <Grid id="grd_rawData" taborder="1" left="0" top="34" autoenter="select" binddataset="ds_rawData" bottom="0" right="0">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="40"/>
                                <Column size="120"/>
                                <Column size="120"/>
                                <Column size="120"/>
                                <Column size="120"/>
                                <Column size="120"/>
                                <Column size="120"/>
                                <Column size="100"/>
                                <Column size="120"/>
                                <Column size="100"/>
                                <Column size="120"/>
                                <Column size="100"/>
                                <Column size="180"/>
                                <Column size="120"/>
                                <Column size="100"/>
                                <Column size="80"/>
                                <Column size="90"/>
                                <Column size="90"/>
                                <Column size="120"/>
                                <Column size="120"/>
                                <Column size="120"/>
                                <Column size="120"/>
                                <Column size="80"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="No"/>
                                <Cell col="1" text="이벤트 시간" tooltiptext="EVENTTIME"/>
                                <Cell col="2" text="설비 타입" tooltiptext="EQUIPMENTTYPE"/>
                                <Cell col="3" text="Site ID" tooltiptext="PLANTID"/>
                                <Cell col="4" text="회사 ID" tooltiptext="ENTERPRISEID"/>
                                <Cell col="5" text="작업장 ID" tooltiptext="WORKAREAID"/>
                                <Cell col="6" text="품목코드" tooltiptext="ITEMID"/>
                                <Cell col="7" text="Rev" tooltiptext="PRODUCTDEFVERSION"/>
                                <Cell col="8" text="공정 ID" tooltiptext="PROCID"/>
                                <Cell col="9" text="공정 Rev." tooltiptext="PROCESSSEGMENTVERSION"/>
                                <Cell col="10" text="라우팅ID" tooltiptext="PROCESSDEFID"/>
                                <Cell col="11" text="라우팅 버전" tooltiptext="PROCESSDEFVER"/>
                                <Cell col="12" text="Lot No." tooltiptext="LOTID"/>
                                <Cell col="13" text="Layer No" tooltiptext="LAYERID"/>
                                <Cell col="14" text="재작업 여부" tooltiptext="ISREWORK"/>
                                <Cell col="15" text="검사 수량" tooltiptext="INSPECTIONQTY"/>
                                <Cell col="16" text="분석 대상 수" tooltiptext="ANALYSISTARGET"/>
                                <Cell col="17" text="분석 후 양품 수" tooltiptext="ANALYSISRESULT"/>
                                <Cell col="18" text="그룹 코드" tooltiptext="GROUPCODE"/>
                                <Cell col="19" text="그룹 이름" tooltiptext="GROUPNAME"/>
                                <Cell col="20" text="서브 그룹 코드" tooltiptext="SUBCODE"/>
                                <Cell col="21" text="서브 그룹 이름" tooltiptext="SUBNAME"/>
                                <Cell col="22" text="불량수량" tooltiptext="DEFECTCOUNT"/>
                              </Band>
                              <Band id="body">
                                <Cell text="expr:currow+1"/>
                                <Cell col="1" text="bind:EVENTTIME" textAlign="left"/>
                                <Cell col="2" text="bind:EQUIPMENTTYPE" textAlign="left"/>
                                <Cell col="3" text="bind:PLANTID" textAlign="left"/>
                                <Cell col="4" text="bind:ENTERPRISEID" textAlign="left"/>
                                <Cell col="5" text="bind:AREAID" textAlign="left"/>
                                <Cell col="6" text="bind:PRODUCTDEFID" textAlign="left"/>
                                <Cell col="7" text="bind:PRODUCTDEFVERSION" textAlign="left"/>
                                <Cell col="8" text="bind:PROCESSSEGMENTID" textAlign="left"/>
                                <Cell col="9" text="bind:PROCESSSEGMENTVERSION" textAlign="left"/>
                                <Cell col="10" text="bind:PROCESSDEFID" textAlign="left"/>
                                <Cell col="11" text="bind:PROCESSDEFVERSION" textAlign="left"/>
                                <Cell col="12" text="bind:LOTID" textAlign="left"/>
                                <Cell col="13" text="bind:LAYERNM" textAlign="left"/>
                                <Cell col="14" text="bind:ISREWORK" textAlign="left"/>
                                <Cell col="15" text="bind:INSPECTIONQTY" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                <Cell col="16" text="bind:REPAIRTARGETQTY" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                <Cell col="17" text="bind:REPAIRRESULTQTY" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                                <Cell col="18" text="bind:GROUPCODE" textAlign="left"/>
                                <Cell col="19" text="bind:GROUPNAME" textAlign="left"/>
                                <Cell col="20" text="bind:SUBCODE" textAlign="left"/>
                                <Cell col="21" text="bind:SUBNAME" textAlign="left"/>
                                <Cell col="22" text="bind:DEFECTCOUNT" textAlign="right" displaytype="mask" maskeditformat="!#,##9"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Button id="btn_xlDn_grd_rawData" taborder="2" top="6" width="29" height="24" cssclass="btn_WF_grdExcelDown" tooltiptext="엑셀다운로드" right="0"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                </Tabpages>
              </Tab>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_header" taborder="3" left="0" top="0" height="47" right="0" formscrolltype="both">
          <Layouts>
            <Layout>
              <Static id="Static01" taborder="6" left="0" top="0" cssclass="sta_WF_titleBG" right="0" bottom="0"/>
              <Button id="btn_resetWork" taborder="0" top="16" width="26" height="24" cssclass="btn_com_reset" right="0" tooltiptext="Toolbar_Initialization" text="" initvalueid="x" onclick="div_header_btn_resetWork_onclick"/>
              <Button id="btn_help" taborder="1" top="16" width="26" height="24" cssclass="btn_com_help" right="btn_resetWork:0" tooltiptext="MANUAL" initvalueid="x"/>
              <Static id="sta_title" taborder="3" text="Layer별 불량 현황" left="30" top="16" width="142" height="24" cssclass="sta_WF_title" fittocontents="width" expr="nexacro.getApplication().gds_menu.lookup(&quot;PGM_ID&quot;,comp.parent.parent.parent.name,&quot;MENU_NM&quot;)"/>
              <Button id="btn_favorite" taborder="2" left="sta_title:0" top="16" width="24" height="24" cssclass="btn_WF_favorite"/>
              <Button id="btn_searchOpen" taborder="4" left="0" top="16" width="30" height="24" cssclass="btn_WF_searchOpen" onclick="nfn_searchOpen_onclick"/>
              <Static id="Static16" taborder="5" left="47" top="0" width="60" height="20" cssclass="guideTip" visible="false" text="h20"/>
            </Layout>
          </Layouts>
        </Div>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_searchCombo">
        <ColumnInfo>
          <Column id="P_PRODUCTDEFID" type="STRING" size="256" description="품목코드"/>
          <Column id="ENTERPRISEID" type="STRING" size="256"/>
          <Column id="P_REV" type="STRING" size="256" description="REV"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_revCombo" useclientlayout="true">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="VALUE" type="STRING" size="256"/>
          <Column id="P_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_layerGroupSum">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="LAYER" type="STRING" size="256"/>
          <Column id="GROUP" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rawData" useclientlayout="true">
        <ColumnInfo>
          <Column id="EQUIPMENTTYPE" type="STRING" size="256" description="설비타입"/>
          <Column id="PLANTID" type="STRING" size="256"/>
          <Column id="ENTERPRISEID" type="STRING" size="256"/>
          <Column id="AREAID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTVERSION" type="STRING" size="256"/>
          <Column id="PROCESSDEFID" type="STRING" size="256"/>
          <Column id="PROCESSDEFVERSION" type="STRING" size="256"/>
          <Column id="LOTID" type="STRING" size="256"/>
          <Column id="INSPECTIONQTY" type="STRING" size="256"/>
          <Column id="GROUPCODE" type="STRING" size="256"/>
          <Column id="GROUPNAME" type="STRING" size="256"/>
          <Column id="SUBCODE" type="STRING" size="256"/>
          <Column id="SUBNAME" type="STRING" size="256"/>
          <Column id="COLOR" type="STRING" size="256"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256"/>
          <Column id="LAYERID" type="STRING" size="256"/>
          <Column id="EVENTTIME" type="STRING" size="256"/>
          <Column id="ISREWORK" type="STRING" size="256"/>
          <Column id="REPAIRTARGETQTY" type="STRING" size="256"/>
          <Column id="REPAIRRESULTQTY" type="STRING" size="256"/>
          <Column id="LAYERNM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchMain">
        <ColumnInfo>
          <Column id="P_LOTID" type="STRING" size="256" description="Lot"/>
          <Column id="P_CONPERIOD_PERIODFR" type="STRING" size="256" description="From"/>
          <Column id="P_CONPERIOD_PERIODTO" type="STRING" size="256" description="To"/>
          <Column id="P_PRODUCTDEFID" type="STRING" size="256" description="품목코드"/>
          <Column id="P_PRODUCTDEFVERSION" type="STRING" size="256" description="품목버전"/>
          <Column id="P_INSPECTIONTYPE" type="STRING" size="256" description="검사구분"/>
          <Column id="P_LAYERID" type="STRING" size="256" description="Layer"/>
          <Column id="P_ENTERPRISEID" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmbDefectGrp" useclientlayout="true">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="VALUE" type="STRING" size="256"/>
          <Column id="P_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmbDefectCode" useclientlayout="true">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="VALUE" type="STRING" size="256"/>
          <Column id="P_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrpT">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrpChartTotal">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_chartTotal">
        <ColumnInfo>
          <Column id="name" type="STRING" size="256"/>
          <Column id="value" type="BIGDECIMAL" size="256"/>
          <Column id="percentage" type="BIGDECIMAL" size="256"/>
          <Column id="TOTALQTY" type="STRING" size="256" description="불량그룹병검사수"/>
          <Column id="TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_chartColor">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256" description="불량그룹코드"/>
          <Column id="COLOR" type="STRING" size="256" description="색상"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrp01">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrpChartSub">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_chart01">
        <ColumnInfo>
          <Column id="name" type="STRING" size="256"/>
          <Column id="value" type="FLOAT" size="256"/>
          <Column id="percentage" type="FLOAT" size="256"/>
          <Column id="TOTALQTY" type="STRING" size="256" description="불량그룹병검사수"/>
          <Column id="TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrp02">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_chart02">
        <ColumnInfo>
          <Column id="name" type="STRING" size="256"/>
          <Column id="value" type="FLOAT" size="256"/>
          <Column id="percentage" type="FLOAT" size="256"/>
          <Column id="TOTALQTY" type="STRING" size="256" description="불량그룹병검사수"/>
          <Column id="TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrp03">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_chart03">
        <ColumnInfo>
          <Column id="name" type="STRING" size="256"/>
          <Column id="value" type="FLOAT" size="256"/>
          <Column id="percentage" type="FLOAT" size="256"/>
          <Column id="TOTALQTY" type="STRING" size="256" description="불량그룹병검사수"/>
          <Column id="TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrp04">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_chart04">
        <ColumnInfo>
          <Column id="name" type="STRING" size="256"/>
          <Column id="value" type="FLOAT" size="256"/>
          <Column id="percentage" type="FLOAT" size="256"/>
          <Column id="TOTALQTY" type="STRING" size="256" description="불량그룹병검사수"/>
          <Column id="TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrp05">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_chart05">
        <ColumnInfo>
          <Column id="name" type="STRING" size="256"/>
          <Column id="value" type="FLOAT" size="256"/>
          <Column id="percentage" type="FLOAT" size="256"/>
          <Column id="TOTALQTY" type="STRING" size="256" description="불량그룹병검사수"/>
          <Column id="TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrp06">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_chart06">
        <ColumnInfo>
          <Column id="name" type="STRING" size="256"/>
          <Column id="value" type="FLOAT" size="256"/>
          <Column id="percentage" type="FLOAT" size="256"/>
          <Column id="TOTALQTY" type="STRING" size="256" description="불량그룹병검사수"/>
          <Column id="TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrpTcopy">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrpChartSubCopy">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrpTotal01">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrpTotal02">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrpTotal03">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrpTotal04">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrpTotal05">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_defectGrpTotal06">
        <ColumnInfo>
          <Column id="LAYERID" type="STRING" size="256" description="층"/>
          <Column id="LAYERNM" type="STRING" size="256" description="층명"/>
          <Column id="LOTID" type="STRING" size="256" description="로트"/>
          <Column id="GROUPCODE" type="STRING" size="256" description="불량그룹"/>
          <Column id="GROUPNAME" type="STRING" size="256" description="불량그룹명"/>
          <Column id="SUBCODE" type="STRING" size="256" description="불량코드"/>
          <Column id="SUBNAME" type="STRING" size="256" description="불량코드명"/>
          <Column id="DEFECTCOUNT" type="STRING" size="256" description="불량수"/>
          <Column id="TOTAL_INSPECTIONQTY" type="STRING" size="256" description="검사수"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256" description="공정id - 추가"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256" description="공정순수_210702_추가"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.1"><![CDATA[/***************************************************************************************
 * 시스템명 	: IFC MES시스템
 * 업무명 		: Defect Map / Layer별 불량 현황
 * 파일명 		: DFM00400M.xfdl
 * 작성자 		: 김진현
 * 작성일 		: 2021.06.01
 *
 * 설  명		: Defect Map / Layer별 불량 현황
 *---------------------------------------------------------------------------------------
 * 변경일		변경자		변경내역
 *---------------------------------------------------------------------------------------
 * 2021.06.01	김진현   	최초작성
 * 2021.07.16	김진현		소수점 표현 (3자리 -> 2자리로 변경)
 *---------------------------------------------------------------------------------------
 ****************************************************************************************/

/**************************************************************************
 * 1. 필수 include
 ***************************************************************************/
include "lib::lib_bas.xjs";	//기준관리 공통 라이브러리 include
include "lib::lib_tom.xjs";	//TOM 공통 라이브러리 include
include "lib::lib_mtm.xjs";	//MTM 공통 라이브러리 include

// 이미지 동적 생성 관련
include "lib::lib_base.xjs";
include "lib::lib_array.xjs";
include "lib::lib_color.xjs";
/**************************************************************************
 * 2. FORM 변수 선언 영역
 ***************************************************************************/


/**************************************************************************
 * 3. FORM LOAD
 ***************************************************************************/
this.fn_init = function (obj:Form, e:nexacro.LoadEventInfo)
{
	this.nfn_formInit(obj);	
	
	// 검색조건 달력 설정
	this.tab_search.tab_search01.form.cbo_period.set_value("thisweek");
	this.tab_search_tab_search01_cbo_period_onitemchanged();
	
	this.tab_search.tab_search01.form.div_dateFrom.form.pdiv_data.form.calStart.addEventHandler("onchanged", this.fn_preiodChang, this);
	this.tab_search.tab_search01.form.div_dateTo.form.pdiv_data.form.calStart.addEventHandler("onchanged", this.fn_preiodChang, this);
	
	
	// x 버튼 이벤트 설정(Lot)
	this.tab_search.tab_search01.form.btn_edt_lotNo.setEventHandler("onclick", this.fn_xClickLotNo, this );
	
	// x 버튼 이벤트 설정(품목코드)
	this.tab_search.tab_search01.form.btn_edt_itemCode.setEventHandler("onclick", this.fn_xClickItemNo, this );
	// x 버튼 이벤트 설정(Layer)
	this.tab_search.tab_search01.form.btn_edt_layer.setEventHandler("onclick", this.fn_xClickLayer, this );
	
	// 검사구분 AOI로 고정
	this.tab_search.tab_search01.form.cmb_inpType.set_index(0);
	
	
	// [Defect Map List] - Total
	//sort 제거	
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.grd_total.removeEventHandler("onheadclick", this.nfn_grd_onheadclick , this); 
	//filter 제거 
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.grd_total.removeEventHandler("onexpandup", this.nfn_grd_onexpandup , this); 
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.grd_total.removeEventHandler("onmousemove", this.nfn_grd_onmousemove, this); //filter 아이콘 안나오게 처리
	
	// 하단 sub 그리드 헤더 정리
	for(var h=1; h<=6; h++)
	{
		//sort 제거	
		this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+h].form.all["grd_grp0"+h].removeEventHandler("onheadclick", this.nfn_grd_onheadclick , this); 
		//filter 제거 
		this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+h].form.all["grd_grp0"+h].removeEventHandler("onexpandup", this.nfn_grd_onexpandup , this); 
		this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+h].form.all["grd_grp0"+h].removeEventHandler("onmousemove", this.nfn_grd_onmousemove, this); //filter 아이콘 안나오게 처리
		
	}
	
	// total 제외 그리드 / 차트 안보이게 설정
	this.fn_setChartGridVisibl(0);
	
	
	
	/*
	
	// 검색조건 콤보 설정 (Rev -> 공정)
	this.fn_setRev("");
	
	// 품목별 현황 초기 Tab적용
	this.fn_setInitTab();
	
	// [조회 조건 품목코드 선택시 조회 그리드]
	//sort 제거	(품목별 현황 - 품목선택한경우)  
	this.div_work.form.tab_work.tabpage_mainItem.form.grd_inputItem.removeEventHandler("onheadclick", this.nfn_grd_onheadclick , this); 
	//filter 제거 (품목별 현황 - 품목선택한경우)
	this.div_work.form.tab_work.tabpage_mainItem.form.grd_inputItem.removeEventHandler("onexpandup", this.nfn_grd_onexpandup , this); 
	this.div_work.form.tab_work.tabpage_mainItem.form.grd_inputItem.removeEventHandler("onmousemove", this.nfn_grd_onmousemove, this); //filter 아이콘 안나오게 처리
	
	
	// [Defect Map List]
	//sort 제거	(품목별 현황 - 품목선택한경우)  
	this.div_work.form.tab_work.tabpage_defectmap.form.grd_defectGrp.removeEventHandler("onheadclick", this.nfn_grd_onheadclick , this); 
	//filter 제거 (품목별 현황 - 품목선택한경우)
	this.div_work.form.tab_work.tabpage_defectmap.form.grd_defectGrp.removeEventHandler("onexpandup", this.nfn_grd_onexpandup , this); 
	this.div_work.form.tab_work.tabpage_defectmap.form.grd_defectGrp.removeEventHandler("onmousemove", this.nfn_grd_onmousemove, this); //filter 아이콘 안나오게 처리
	
	
	// defect map 설정
	// 검사유형 (AOI만 선택 불가능)
	this.div_work.form.tab_work.tabpage_defectmap.form.cmb_inpType.set_index(0);
	this.div_work.form.tab_work.tabpage_defectmap.form.cmb_inpType.set_readonly(true);
	*/
};



/**************************************************************************
 * 4. 공통버튼영역 (함수 삭제금지!!!!)
 ***************************************************************************/
/*
 * 기능 : 검색(메인 -  고객정보 그리드)
 */
this.fn_search = function (obj:Button, e:nexacro.ClickEventInfo)
{  
	
	// 품목코드 유무에 따른 분기 처리 진행
	this.ds_rawData.clearData();			// raw data용 ds 초기화
	this.ds_searchMain.clearData();			// 조회 조건 초기화
	
	this.ds_cmbDefectGrp.clearData();		// 불량그룹 콤보ds 초기화
	this.ds_cmbDefectCode.clearData();		// 불량코드 콤보ds 초기화
	this.ds_defectGrpT.clearData();			// Total 그리드 정보 ds 초기화
	this.ds_chartColor.clearData();			// 차트 불량그룹별 색상 정보 ds 
	this.ds_chartTotal.clearData();			// Total 차트 ds 초기화
	
	
	// 초기화 필요 (그리드 및 차트)
	this.ds_searchMain.addRow();
	
	var nPeriodfr = this.tab_search.tab_search01.form.div_dateFrom.form.calStart.value;
	var nPeriodto = this.tab_search.tab_search01.form.div_dateTo.form.calStart.value;
	
	// total 제외 그리드 / 차트 안보이게 설정
	this.fn_setChartGridVisibl(0);
	
	// 하단 sub ds 초기화
	for(var h=1; h<=6; h++)
	{
		this.all["ds_defectGrp0"+h].clearData();
		this.all["ds_chart0"+h].clearData();
		// (21.06.28) (Total용 추가)
		this.all["ds_defectGrpTotal0"+h].clearData();
	}
	
	
	// 날짜체크
	if( nPeriodfr  > nPeriodto )
	{
		this.gfn_Message("ValidateDate", "", "warning", "ok");//시작 일자는 종료일자보다 작아야합니다. 
		return false;
	}
	var nPeriodfr8 = nPeriodfr.substr(0,8);
	var nPeriodto8 = nPeriodto.substr(0,8);
	
	// 날짜 체크
	if(!this.gfn_isDate(nPeriodfr8) || !this.gfn_isDate(nPeriodto8))
	{
		this.gfn_Message("ValidateMWONONEDATE", "", "warning", "ok");//잘못된날짜데이터입니다.
		return;
	}
	
	
	// 필수값 체크 (AOI인 경우 , 품목코드, Layer 필수입력값)
	if(!this.fn_chkRequired()) return;
	
	this.ds_searchMain.setColumn(0,"P_CONPERIOD_PERIODFR"	, nPeriodfr.substr(0,14)); 	// 시작일
	this.ds_searchMain.setColumn(0,"P_CONPERIOD_PERIODTO"	, nPeriodto.substr(0,14)); 	// 종료일	
	
	this.ds_searchMain.setColumn(0,"P_LOTID"				, this.tab_search.tab_search01.form.edt_lotNo.value); 		// Lot No	
	this.ds_searchMain.setColumn(0,"P_PRODUCTDEFID"			, this.tab_search.tab_search01.form.edt_itemCode.value); 	// 품목코드
	// 품목 버전
	var nRevDs = this.tab_search.tab_search01.form.div_revMulti.form;
	var nFs			= "";
	for(var i=0; i<nRevDs.ds_initData.rowcount; i++){
		var chk 	= nRevDs.ds_initData.getColumn(i,"CHK");
		var code 	= nRevDs.ds_initData.getColumn(i,"CODE");
		if(chk == 1 && !this.gfn_isNull(code))
		{
			nFs += this.gfn_isNull(nFs)? code : ", " +code;
		}
	}
	
	this.ds_searchMain.setColumn(0,"P_PRODUCTDEFVERSION"	, nFs); 													// 품목 버전	
	this.ds_searchMain.setColumn(0,"P_INSPECTIONTYPE"		, this.tab_search.tab_search01.form.cmb_inpType.value); 	// 검사구분
	// layer 
	var nLayerCnt = this.ds_layerGroupSum.rowcount;
	var nFl			= "";
	for(var j=0; j<nLayerCnt; j++){
		var layer 	= this.ds_layerGroupSum.getColumn(j,"LAYER");
		
		nFl += this.gfn_isNull(nFl)? layer : ", " +layer;
		
	}
	this.ds_searchMain.setColumn(0,"P_LAYERID"				, nFl); 	// Layer
	
	this.ds_searchMain.setColumn(0,"P_ENTERPRISEID"			, this.gf_getEnterpriseId()); 	// ENTERPRISEID
	
	
	//trace(" [메인 조호 조건] : "+this.ds_searchMain.saveXML());
	
	
	// 그리드(불량율 계산할 값도 조회 필요  / 콤보 / 차트 값)
	var sSvcID 			= "selectDefectRateByLayerList";
	var sController 	= "/dfm00400/selectDefectRateByLayerList.do";
	var sInDatasets 	= "INPUT=ds_searchMain";
	var sOutDatasets 	= "ds_rawData=output1 ds_cmbDefectGrp=output2 ds_cmbDefectCode=output3 ds_defectGrpT=output4 ds_chartColor=output5";		//색상정보 조회 해야됨
	var sArgs 			= "";	
	sArgs += this.gfn_setParam("", "");
	
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
	
	
};

/*
 * 기능 : 저장
 */
this.fn_save = function (obj:Button, e:nexacro.ClickEventInfo)
{  
	
};

/*
 * 기능 : 검색 초기화
 */
this.fn_searchClear = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
   
};

/*
 * 기능 : 신규
 */
this.fn_new = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
  
};


/*
 * 기능 : 삭제
 */
this.fn_delete = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
   
};
/*
 * 기능 : 도움말  => 공통 처리
 */
this.fn_help = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{

};

/*
 * 기능 : 출력
 */
this.fn_print = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
   
};

/**************************************************************************
 * 5. TRANSACTION, CALLBACK 영역
 ***************************************************************************/
this.fn_callBack = function (trId, errCD, errMsg)
{
	if (errCD != 0) 
	{
		if (trId == "saveProcGrpList") 
		{
			var msgArray = errMsg.split(("|"));			
			if(msgArray.length==2) {
				this.gfn_Message(msgArray[0], "\n"+msgArray[1], "error", "ok");
				return;
			} else {
				this.gfn_Message("ProcessingError", "\n"+errMsg, "error", "ok");
				return;
			}			
		}
		if(trId == "selectLayerImageInfo")
		{
			var msgArray = errMsg.split(("|"));			
			if(msgArray.length==2) {
				this.gfn_Message(msgArray[0], "\n"+msgArray[1], "error", "ok");
				return;
			}else {
				this.gfn_Message("ProcessingError", "\n"+errMsg, "error", "ok");
				return;
			}
		}
		else {
			this.gfn_Message("ProcessingError", trId + errMsg, "error", "ok");	
			return;
		}
		return;
	}
	
	switch(trId) {		
		case "selectProductDefVersionByRate": 			//[조회조건] rev 조회 성공		
			
			// 멀티 콤보 적용
			//trace(" 콤보값 조회 결과 : "+this.ds_revCombo.saveXML());
			
			// (21.06.18) 전체조회 선택 된상태여야 한다 초기에.
			this.ds_revCombo.setColumn(0,"CHK",1);
			
			
			// 하위 멀티 콤보 이벤트 설정.
			this.tab_search.tab_search01.form.div_revMulti.form.fn_init_multicombo_data(this.ds_revCombo);
			this.tab_search.tab_search01.form.div_revMulti.form.ds_initData.applyChange();
			
			// 연결된 하위 멀티 콤보 초기화 
			this.tab_search.tab_search01.form.div_revMulti.form.btn_hide.addEventHandler( "onclick"
									, this.fn_clickRev
									, this
									);
			this.tab_search.tab_search01.form.div_revMulti.form.btn_dropcombo.addEventHandler( "onclick"
									, this.fn_clickRev
									, this
									);
			
			
			// Layer 초기화
			this.ds_layerGroupSum.clearData();
			this.tab_search.tab_search01.form.edt_layer.set_value("");
			
			// 조회 ()
			//this.fn_setProc();
			
			break;
		
		case "selectDefectRateByLayerList": 					//[ 메인 조회]		
			if(this.ds_rawData.rowcount == 0)
			{
				this.gfn_Message("NoSelectData", null, "warning", "ok");
				return;
			}
			//trace(" 조회 성공 : "+this.ds_cmbDefectCode.rowcount);
			
			// 조회 후 멀티 콤보(상위설정)
			this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectGrpMulti.form.fn_init_multicombo_data(this.ds_cmbDefectGrp);
			this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectGrpMulti.form.ds_initData.applyChange(); 
			// 연결된 하위 멀티 콤보 초기화 
			this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectGrpMulti.form.btn_hide.addEventHandler( "onclick"
									, this.fn_clickDefectGrp
									, this
									);
			this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectGrpMulti.form.btn_dropcombo.addEventHandler( "onclick"
									, this.fn_clickDefectGrp
									, this
									);
			// 하위 멀티 콤보 이벤트 설정.
			this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectCodeMulti.form.fn_init_multicombo_data(this.ds_cmbDefectCode);
			this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectCodeMulti.form.ds_initData.applyChange();
			this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectCodeMulti.form.btn_hide.addEventHandler( "onclick"
									, this.fn_clickDefectCode
									, this
									);
			this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectCodeMulti.form.btn_dropcombo.addEventHandler( "onclick"
									, this.fn_clickDefectCode
									, this
									);	
			
			// Total 차트 설정
			this.fn_setChartLayer();
			
			// group 수
			var nGroupCnt 	= 0;
			var nGrpSumCnt 	= this.ds_layerGroupSum.rowcount;
			var nPreGrpCd	= "";
			for(var i=0; i<nGrpSumCnt; i++)
			{
				var nGrpCd	= this.ds_layerGroupSum.getColumn(i,"GROUP");
				if(nPreGrpCd != nGrpCd)
				{
					nGroupCnt++;
					nPreGrpCd = nGrpCd;
				}
			}
			
			//----------------------------------------------------------
			// 불량수 0 인것 제외 
			this.ds_defectGrpT.filter("");		// 필터 내용 초기화
			this.ds_defectGrpTcopy.clearData();
			this.ds_defectGrpTcopy.copyData(this.ds_defectGrpT, true);		// 필터링 후 설정
			this.ds_defectGrpT.filter("DEFECTCOUNT != '0'");
			//----------------------------------------------------------
			
			
			// total 제외 그리드 / 차트 안보이게 설정
			this.fn_setChartGridVisibl(nGroupCnt);
			
			// Total 하단의 그리드 및 차트 설정
			this.fn_setSubChartGrid();
			
			break;
			
		
	default:
	
	}

};



/**************************************************************************
 * 6. 팝업 호출/콜백
 **************************************************************************/
this.fn_popupAfter = function(sPopupId, Variant)
{  
	var rtn = this.fv_rtnValue;	
	if(this.nfn_isNull(rtn)) return;
    switch(sPopupId)
	{
		case "SCH_LOTNo" :			// 필터 Lot No
			
			var nLotNo 		= rtn[0];
			var nItemCode	= rtn[1];
			var nItemNm		= rtn[2];
			
			this.tab_search.tab_search01.form.edt_lotNo.set_value(nLotNo);
			this.tab_search.tab_search01.form.edt_itemCode.set_value(nItemCode);
			this.tab_search.tab_search01.form.edt_itemNm.set_value(nItemNm);
			
			// Rev 조회(필요함)
			this.fn_setRev(nItemCode);
			
			
			break;	
		
		case "SCH_ITEMCODE" :			// 필터 품목코드
			
			var nItemCode	= rtn[0];
			var nItemNm		= rtn[1];
			
			this.tab_search.tab_search01.form.edt_lotNo.set_value("");
			this.tab_search.tab_search01.form.edt_itemCode.set_value(nItemCode);
			this.tab_search.tab_search01.form.edt_itemNm.set_value(nItemNm);
			
			// Rev 조회(필요함)
			this.fn_setRev(nItemCode);
			
			
			break;	
		case "SCH_LAYER" :				// 필터 Layer
			var nLen = rtn.length;
			
			if(nLen != 0)
			{
				var nStandard = "";
				
				// ds에 설정
				this.ds_layerGroupSum.clearData();
				
				for(var i=0; i<nLen; i++)
				{	
					nStandard += i==0? rtn[i][0] : ", " +rtn[i][0];
					var nAdd = this.ds_layerGroupSum.addRow();
					this.ds_layerGroupSum.setColumn(nAdd,"LAYER",rtn[i][0]);
					this.ds_layerGroupSum.setColumn(nAdd,"GROUP",rtn[i][1]);
				}
				
				this.tab_search.tab_search01.form.edt_layer.set_value(nStandard);
				//trace(" ==========> : "+this.ds_layerGroupSum.saveXML());
			}
			else
			{
				// ds에 설정
				this.ds_layerGroupSum.clearData();
				this.tab_search.tab_search01.form.edt_layer.set_value("");
			}
			break;	
		
		default :
			break;
	}
};



 /*
 * 기능(공통팝업) : 조회
 */
this.fn_openPop = function(svcId, popId, pArg)
{

	var popupId = svcId;
	var oArg = {};
	var opts = "width=500,height=400";
	
	oArg.arg_type = "B";		// 단일 선택 / 자동조회
	oArg.arg_popupCd = popId;
	oArg.arg_popupNm = "";
	oArg.arg_paramCols = this.gfn_getExtractArgument(pArg,"name");
	oArg.arg_paramValues = this.gfn_getExtractArgument(pArg,"value");
	
	if(popId=="P00278"){ //품목(필터)
		oArg.arg_rtnCols = "P_PRODUCTDEFID|PROCESSDEFNAME";			// 리턴 받을 값	
		
		var nItemCode = this.tab_search.tab_search01.form.edt_itemCode.value;
		
		oArg.arg_searchStr = "P_PRODUCTDEFID="+nItemCode;	// 검색 조건(이미 입력 된값)
	}
	
	this.gfn_openPopup(popupId,"cmd::CMSA00100P.xfdl",oArg,opts);
}

/**************************************************************************
 * 7. 기타 함수(화면 로컬 정의) 
 **************************************************************************/
/*
 * 이벤트 : 조회조건- 조회기간 직접 변경시
 */
this.fn_preiodChang = function(obj:nexacro.Calendar,e:nexacro.ChangeEventInfo)
{
	if (!this.nfn_isNull(this.tab_search.tab_search01.form.cbo_period.value))
	{
		this.tab_search.tab_search01.form.cbo_period.set_value(undefined);		// 21.05.20 명보다는 코드로 설정
	}	
}; 

/*
 * 품목코드 x 버튼 클릭시
 */
this.fn_xClickItemNo = function ()
{
	// 지우고 콤보 초기화 필요
	this.tab_search.tab_search01.form.edt_itemCode.set_value("");
	this.tab_search.tab_search01.form.edt_itemNm.set_value("");
	// Rev 조회
	this.fn_setRev("");
	
}; 

/*
 * LotNo x 버튼 클릭시
 */
this.fn_xClickLotNo = function ()
{
	// 지우고 콤보 초기화 필요
	this.tab_search.tab_search01.form.edt_lotNo.set_value("");
	this.tab_search.tab_search01.form.edt_itemCode.set_value("");
	this.tab_search.tab_search01.form.edt_itemNm.set_value("");
	// Rev 조회
	this.fn_setRev("");
};


/*
 * Layer x 버튼 클릭시
 */
this.fn_xClickLayer = function ()
{
	// ds에 설정
	this.ds_layerGroupSum.clearData();
	this.tab_search.tab_search01.form.edt_layer.set_value("");
}; 

/*
 * 품목코드에 해당 하는 Rev 조회
 */
this.fn_setRev = function (nItemCd)
{
	//trace(" [조회 조건] ===> : "+nItemCd);
	this.ds_revCombo.clearData();
	this.ds_searchCombo.clearData();
	this.ds_searchCombo.addRow();
	this.ds_searchCombo.setColumn(0,"P_PRODUCTDEFID",nItemCd);
	
	var sSvcID 			= "selectProductDefVersionByRate";
	var sController 	= "/dfm00400/selectProductDefVersionByRate.do";
	var sInDatasets 	= "INPUT=ds_searchCombo";
	var sOutDatasets 	= "ds_revCombo=output";
	var sArgs 			= "";	
	sArgs += this.gfn_setParam("", "");
	
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
	
}; 

/*
 * 멀티 콤보 활성화시...
 */
this.fn_clickRev = function (obj:Grid, e:nexacro.GridClickEventInfo)
{
	// Layer 정보 초기화
	this.ds_layerGroupSum.clearData();
	this.tab_search.tab_search01.form.edt_layer.set_value("");
}


/*
 * 하위 멀티 콤보값 초기화
 */
this.fn_clickDefectGrp = function (obj:Grid, e:nexacro.GridClickEventInfo)
{
	//trace("이벤트 발생!!!! 하위 데이터셋 초기화");
	
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectCodeMulti.form.fn_init_multicombo_data(this.ds_cmbDefectCode);
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectCodeMulti.form.ds_initData.applyChange(); 
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectCodeMulti.form.edt_comboResult.set_value("데이터 미 선택");
};


/*
 * 하위 멀티 콤보 설정
 */
this.fn_clickDefectCode =  function (obj:Grid, e:nexacro.GridClickEventInfo)
{
	//trace("상위값 있으면 필터링 걸어야 한다.");
	var nPreFilter 	= "";
	nPreFilter 		= this.ds_cmbDefectCode.filterstr;
	//trace(" [form의 데이터셋] ====> : "+nPreFilter);
	var nDefectGrpDs = this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectGrpMulti.form;
	
	var nFs			= "";
	this.ds_cmbDefectCode.filter("");		// 필터 초기화
	for(var i=0; i<nDefectGrpDs.ds_initData.rowcount; i++){
		var chk 	= nDefectGrpDs.ds_initData.getColumn(i,"CHK");
		var code 	= nDefectGrpDs.ds_initData.getColumn(i,"CODE");
		//trace(" [form의 데이터셋 체크값] ====> : "+chk+" || [code] : "+code);
		if(chk == 1 && !this.gfn_isNull(code))
		{
			nFs += this.gfn_isNull(nFs) ? "P_CODE=='*'||P_CODE=='"+code+"'" : "||P_CODE=='"+code+"'";
			//trace(" [필터 조건 설정] ====");
		}
	}
	/*
	trace("필터 조건 : "+nFs);
	trace("(필터 설정) ====> : "+(nFs != nPreFilter));
	trace("----------------------------------");
	trace(nFs);
	trace(nPreFilter);
	trace("----------------------------------");
	*/
	this.ds_cmbDefectCode.filter(nFs);			// 필터 초기화(21.06.04) 필터 하나 추가
	if(nFs != nPreFilter)			// 이전 필터 조건과 같지 않으면 설정(21.05.12) 이전 선택값 가지고 있기 위해 
	{	
		this.ds_cmbDefectCode.filter(nFs);		// 필터 초기화
		this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectCodeMulti.form.fn_init_multicombo_data(this.ds_cmbDefectCode);
		this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectCodeMulti.form.ds_initData.applyChange(); 
		this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectCodeMulti.form.edt_comboResult.set_value("데이터 미 선택");
	}	
}


/*
 *	조회시 필수값 체크(AOI인 경우만 Layer 필수값 현재는 AOI만 사용 가능) 
 */
this.fn_chkRequired = function ()
{
	var nItem	= this.tab_search.tab_search01.form.edt_itemCode.value;
	var nType	= this.tab_search.tab_search01.form.cmb_inpType.value;
	var nLayer	= this.tab_search.tab_search01.form.edt_layer.value;
	if(this.gfn_isNull(nItem) )  
	{
		// 필수값 입력
		this.gfn_Message("InputSomeThing",this.nfn_getDictionaryname("F112527EF89E45D8BA876725E97E3B30",true) , "warning","ok");// 품목코드+"을(를) 입력 해주세요");
		return false;
	}
	
	if(nType == "AOI")
	{
		if(this.gfn_isNull(nLayer) )
		{
			// 필수값 입력
			this.gfn_Message("InputSomeThing",this.nfn_getDictionaryname("9BA0994900D94F21A6709010DBAE0532",true) , "warning","ok");// 품목코드+"을(를) 입력 해주세요");
			return false;
		}
	}
	
	return true;
	
};

/*
 * 세부 불량 율 계산
 */
this.fn_setDetailRate = function (nInspQty, nDefectQty)
{
	//trace(" ----------------- : "+nInspQty+" | "+nDefectQty+" | "+nPos+" | "+nDs);
	var nR = 0;
	if(!this.gfn_isNull(nInspQty) && !this.gfn_isNull(nDefectQty))
	{
		var nPreRate = parseFloat(nDefectQty) / parseFloat(nInspQty) * 100;
		nR = nexacro.round(nPreRate, 2);				// (소수점 2째 자리) (21.07.16)
	}
	
	return nR+"%";
	
}; 
/*
 * 세부 Sum불량율(Layer별로 불량그룹 불량율)	 ds 넘겨 받음
 */
this.fn_setSumGrpRate = function (nDs)
{	
	var nChkDs	= this.all[nDs];		// 선택된 ds
	
	var nTotal	= 0;
	var nGrpQty = 0;
	var nCnt = nChkDs.rowcount;
	
	//******************************************************************[21.06.21]
	// 이전 검사공정 id (21.06.21) 
	//var nPreProcId	= "";
	var nArrProcId	= [];
	nArrProcId.length = 0;
	//******************************************************************
	
	// 모든 불량수
	for(var i=0; i<nCnt; i++)
	{
		var nDefectQty 	= nChkDs.getColumn(i,"DEFECTCOUNT");
		var nTotalQty 	= nChkDs.getColumn(i,"TOTAL_INSPECTIONQTY");
		nGrpQty += parseInt(nDefectQty);
		
		/*
		if(i == 0)
		{
			nTotal = nTotalQty;
		}
		*/
		//******************************************************************[21.06.21]
		// (21.06.21) 검사공정이 달라지면 합계를 더해야 한다. 
		var nProcId =  nChkDs.getColumn(i,"PROCESSSEGMENTID");
		
		var nArrLen = nArrProcId.length;
		var nChkId  = true;
		for(var a=0; a<nArrLen; a++)
		{
			if(nArrProcId[a] == nProcId)		// 기존의 공정의 검사 수량이 존재하는지 판단
			{
				nChkId = false;
			}
		}
		if(nChkId)
		{
			nArrProcId.push(nProcId);
			nTotal = nTotal + nTotalQty;
		}
		//******************************************************************
	}
	//trace(" ###[" +nDs+ "] ##(총 수)## : "+nTotal);
	
	// 불량율 계산
	var nR = 0;
	
	if(!this.gfn_isNull(nTotal) && !this.gfn_isNull(nGrpQty))
	{
		var nPreRate = parseFloat(nGrpQty) / parseFloat(nTotal) * 100;
		nR = nexacro.round(nPreRate, 2);				// (소수점 2째 자리) (21.07.16)
		
	}
	
	if(nTotal == 0 && nGrpQty == 0)
	{
		nR = 0;
	}
	return nR+"%";
};

/*
 * 세부 Sum불량율(Layer별로 불량그룹 불량율)	 ds 넘겨 받음 -> Total만 따로 생성 (검사수가 공정순수가 가장 큰 것의 검사수로만 계산하면됨)
 * (21.07.02) 수정
 */
this.fn_setSumGrpRateTotal = function (nDs)
{	
	var nChkDs	= this.all[nDs];		// 선택된 ds
	
	var nTotal	= 0;
	var nGrpQty = 0;
	var nCnt = nChkDs.rowcount;
	
	//******************************************************************[21.06.21]
	// 이전 검사공정 id (21.06.21) 
	//var nPreProcId	= "";
	var nArrProcId	= [];
	nArrProcId.length = 0;
	//******************************************************************
	
	
	// (21.07.02) 공정 수순 최대값
	var nMaxSeq = 0;
	
	// 모든 불량수
	for(var i=0; i<nCnt; i++)
	{
		var nDefectQty 	= nChkDs.getColumn(i,"DEFECTCOUNT");
		var nTotalQty 	= nChkDs.getColumn(i,"TOTAL_INSPECTIONQTY");
		nGrpQty += parseInt(nDefectQty);
		
		/*
		if(i == 0)
		{
			nTotal = nTotalQty;
		}
		*/
		//******************************************************************[21.06.21]
		// (21.06.21) 검사공정이 달라지면 합계를 더해야 한다. 
		var nProcId =  nChkDs.getColumn(i,"PROCESSSEGMENTID");
		
		// (21.07.02) - 공정 수순 값
		var nOpeSeq =  nChkDs.getColumn(i,"OPERATIONSEQUENCE");
		if(nOpeSeq > nMaxSeq)
		{
			nMaxSeq = nOpeSeq;
			nTotal = nTotalQty;
		}
		
		var nArrLen = nArrProcId.length;
		var nChkId  = true;
		for(var a=0; a<nArrLen; a++)
		{
			if(nArrProcId[a] == nProcId)		// 기존의 공정의 검사 수량이 존재하는지 판단
			{
				nChkId = false;
			}
		}
		if(nChkId)
		{
			nArrProcId.push(nProcId);
			//(21.07.02) - 공정 수순에 따른 최대값 1개만 담음 (변경)
			//nTotal = nTotal + nTotalQty;
		}
		//******************************************************************
	}
	//trace(" ###[" +nDs+ "] ##(전체 검사수)## : "+nTotal+" || "+nCnt);
	
	/****************************************************
	 월요일 문의 할 것
		ㄴ 7/5 기타의 경우 불량수가 0이다
		ㄴ 그래서 화면에선 안보이는데 공정 수순이 aoi외층이 가장 크다 그래서 
		ㄴ 2200 / 179520 * 100 이된다. total의 경우.. 확인 필요 이게 맞는지... 불량수가 0인 경우 ..
	****************************************************/
	
	// 불량율 계산
	var nR = 0;
	
	if(!this.gfn_isNull(nTotal) && !this.gfn_isNull(nGrpQty))
	{
		var nPreRate = parseFloat(nGrpQty) / parseFloat(nTotal) * 100;
		nR = nexacro.round(nPreRate, 2);				// (소수점 2째 자리) (21.07.16)
		
	}
	
	if(nTotal == 0 && nGrpQty == 0)
	{
		nR = 0;
	}
	return nR+"%";
};

/*
 * 불량수(Layer별로 불량그룹)	- ds넘겨 받음
 */
this.fn_setTotalDefectCnt  = function (grpCode,grpLayer, nDs)
{
	//trace(" ---(grpCode) : "+grpCode);
	var nChkDs	= this.all[nDs];		// 선택된 ds
	var nGrpQty = 0;
	var nCnt = nChkDs.rowcount;
	for(var i=0; i<nCnt; i++)
	{
		var nGrpCode 	= nChkDs.getColumn(i,"GROUPCODE");
		var nDefectQty 	= nChkDs.getColumn(i,"DEFECTCOUNT");
		var nLayer 	    = nChkDs.getColumn(i,"LAYERID");
		
		if((nGrpCode == grpCode) && (grpLayer == nLayer))
		{
			nGrpQty += parseInt(nDefectQty);
		}
	}
	return nGrpQty;
};

/*
 * 불량율(Layer별로 불량그룹 불량율) - ds넘겨 받음
 */
this.fn_setGrpRate = function (grpCode,grpLayerId,total,nDs)
{	
	var nChkDs	= this.all[nDs];		// 선택된 ds
	var nGrpQty = 0;
	var nCnt = nChkDs.rowcount;
	for(var i=0; i<nCnt; i++)
	{
		var nGrpCode 	= nChkDs.getColumn(i,"GROUPCODE");
		var nDefectQty 	= nChkDs.getColumn(i,"DEFECTCOUNT");
		var nLayerId 	= nChkDs.getColumn(i,"LAYERID");
		if((nGrpCode == grpCode) && (grpLayerId == nLayerId))
		{
			nGrpQty += parseInt(nDefectQty);
		}
	}
	
	var nR = 0;
	if(!this.gfn_isNull(total) && !this.gfn_isNull(nGrpQty))
	{
		var nPreRate = parseFloat(nGrpQty) / parseFloat(total) * 100;
		nR = nexacro.round(nPreRate, 2);		// (21.07.20) 소수점 2자리 누락된 부분 적용
	}
	return nR+"%";
};


/*
 * 차트 값 설정   (Total - 차트)
 */
this.fn_setChartLayer = function ()
{	
	
	this.ds_defectGrpChartTotal.filter("");		// 필터 내용 초기화
	
	this.ds_defectGrpChartTotal.clearData();	
	this.ds_defectGrpChartTotal.copyData(this.ds_defectGrpT, true);		// 필터링 후 설정
	this.ds_chartTotal.clearData();
	
	this.ds_defectGrpChartTotal.set_keystring("S:+LAYERID");				// Layer 기준으로 차트 구성
	
	// (21.06.25) 불량수가 0인경우 안나오도록 설정 DEFECTCOUNT
	//------------------------------------------------------------------------------
	//trace(" ====> Total 차트 설정(전) : "+this.ds_defectGrpChartTotal.saveXML());
	//trace(" ====> Total 차트 설정(후) : "+this.ds_defectGrpChartTotal.saveXML());
	this.ds_defectGrpChartTotal.filter("DEFECTCOUNT != '0'");
	//------------------------------------------------------------------------------
	
	
	var nDefectSum 	= 0;
	var nPreLayerId = "";
	var nInpProc	= "";				// 불량 그룹별 검사공정별 검사수 
	var nCnt = this.ds_defectGrpChartTotal.rowcount;	
	
	for(var i=0; i<nCnt; i++)
	{
		var nRow = i;
		var nDefectQty 	= this.ds_defectGrpChartTotal.getColumn(i,"DEFECTCOUNT");
		var nLayerId 	= this.ds_defectGrpChartTotal.getColumn(i,"LAYERID");
		var nPostLaterId= this.ds_defectGrpChartTotal.getColumn((nRow+1),"LAYERID");
		var nTotal 		= this.ds_defectGrpChartTotal.getColumn(i,"TOTAL_INSPECTIONQTY");
		var nLayerName	= this.ds_defectGrpChartTotal.getColumn(i,"LAYERNM");
		
		if(i == 0)		// 첫행 경우 합침
		{
			nDefectSum += parseInt(nDefectQty);
			nPreLayerId = nLayerId;
		}
		
		if(i!=0 && (nPreLayerId != nLayerId))		// 첫행 이후 같지않은경우 설정(기준점 재설정)
		{
			nPreLayerId = nLayerId;					// 초기화
			nDefectSum  = 0;						// 초기화
		}
		if(i != 0 && (nPreLayerId == nLayerId))		// 첫행 이후 같지않은경우 설정(불량 수량 증가)
		{
			nDefectSum += parseInt(nDefectQty);
		}
		
		// 검사수..
		if(((nPostLaterId != nLayerId)) ||  nCnt == 1)
		{	
			var nChkInsp = "";						// 같은 불량그룹에 다른 검사공정인 경우 더함 검사수
			var nCt		 = 0;
			for(var j=0; j<nCnt; j++)
			{
				var nTLayerId 		= this.ds_defectGrpChartTotal.getColumn(j,"LAYERID");
				var nTInspProc		= this.ds_defectGrpChartTotal.getColumn(j,"INPPROC");
				var nTTotal 		= this.ds_defectGrpChartTotal.getColumn(j,"TOTAL_INSPECTIONQTY");
				
				if((nLayerId == nTLayerId))
				{
					nCt += parseInt(nTTotal);
					break;
				}
			}
			// 불량율 계산 
			var nAdd = this.ds_chartTotal.addRow();
			this.ds_chartTotal.setColumn(nAdd,"name",nLayerName);
			this.ds_chartTotal.setColumn(nAdd,"value",parseFloat(nDefectSum));			// 불량수
			this.ds_chartTotal.setColumn(nAdd,"TOTALQTY",parseFloat(nCt));				// 검사수
			
			var nPreRate = parseFloat(nDefectSum) / parseFloat(nCt) * 100;
			var nR = nexacro.round(nPreRate, 2);				// (소수점 2째 자리) (21.07.16)
			this.ds_chartTotal.setColumn(nAdd,"percentage",parseFloat(nR));					// 불량율
			this.ds_chartTotal.setColumn(nAdd,"TYPE","A");								// TYPE
		}
	}
	
	//trace(" --------------> : "+this.ds_chartTotal.saveXML());
	
	// 차트 설정
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.chart_grpTotal.set_binddataset("ds_chartTotal");
	// 타이틀 보이지 않게 설정
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.chart_grpTotal.title.set_visible( false );
	// 범례 보이지 않게 설정
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.chart_grpTotal.legend.set_visible( false );
	// X축 타이틀 제거
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.chart_grpTotal.categoryaxis.set_titletext("");
	
	//this.div_work.form.tab_work.tabpage_defectMap.form.chart_2y.show();
	
	// 색상 다양하게
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.chart_grpTotal.seriesset[0].set_barfillstyle("#62be1b,#3c4596,#be0071,#4bc4c2,#f8b334,#2ba3a8,#ea5d66,#ffe100");
	// "#86B5BC,#E30513,#C1C1C1,#86BC24,#E5007D,#2F8DCD,#F9D900,#F6A200,#BCBCBC"
	this.fn_setMaxY();
};

/*
 * Y 축 최대값 설정(차트)
 */
this.fn_setMaxY = function ()
{	
	var nMaxCol = this.ds_chartTotal.getCaseMax( "TYPE != ''", "value" );				// col의 최대값
	
	var nMaxLine = this.ds_chartTotal.getCaseMax( "TYPE != ''", "percentage" );			// line의 최대값
	
	//this.div_work.form.tab_work.Tabpage1.form.div_total.form.chart_grpTotal.valueaxes[0].set_tickmax(parseFloat(nMaxCol)+20);
	//(21.08.03) x 축 소소점 나오지 않도록 설정
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.chart_grpTotal.valueaxes[0].set_tickmax(parseInt(parseFloat(nMaxCol)*1.20));
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.chart_grpTotal.valueaxes[1].set_tickmax(parseFloat(nMaxLine)+2);
	//this.div_work.form.tab_work.Tabpage1.form.div_total.form.chart_grpTotal.valueaxes[1].set_tickmax(parseFloat(nMaxLine)*1.1);
	//trace("최대값 설정 : "+nMaxCol);
	//trace("최대값 설정 : "+nMaxLine);
};

/*
 * Total제외 하단 그리드 및 차트 보이게, 안보이게 설정
 */
this.fn_setChartGridVisibl = function (nCnt)
{
	var nVisibleCnt = nCnt
	for(var i=6 ; i>nVisibleCnt;i--)
	{
		this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+i].set_visible(false);		
	}
	
	for(var j=0 ; j<nVisibleCnt;j++)
	{
		this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+(j+1)].set_visible(true);		
	}
	
	this.div_work.form.tab_work.Tabpage1.form.set_scrollbartype('auto fixed');		// 스크롤바 생성
	this.div_work.form.tab_work.Tabpage1.form.resetScroll();
	this.resetScroll();
}; 

/*
 * [Total 제외 하단 그리드 차트 설정]
 */
this.fn_setSubChartGrid = function ()
{
	// sum 그리드 / 차트 ds 초기화 필요 (조회, 생성전에, 초기화시)
	this.ds_defectGrpChartSub.clearData();
	// 하단 sub ds 초기화
	for(var h=1; h<=6; h++)
	{
		this.all["ds_defectGrp0"+h].clearData();
		this.all["ds_chart0"+h].clearData();
		// (21.06.28) (Total용 추가)
		this.all["ds_defectGrpTotal0"+h].clearData();
	}
	
	var nGrpSumCnt 		= this.ds_layerGroupSum.rowcount;
	var nPreGrpCd		= "";		// 이전 Group 코드 값 담는 변수
	var nPreGrpCdArr	= [];
	nPreGrpCdArr.length = 0;
	for(var b=0; b<nGrpSumCnt; b++)
	{
		var nGrpCd	= this.ds_layerGroupSum.getColumn(b,"GROUP");
		if(nPreGrpCd != nGrpCd)
		{
			nPreGrpCdArr.push(nGrpCd); 
			nPreGrpCd = nGrpCd;
		}
	}
	
	trace(" 배열 수 : "+nPreGrpCdArr.length);
	// for문 돌면서 배열에 해당 하는 Group 값 추출 그 안에서 그리드 / 차트 각각 (필터 후) 적용 
	for(var a=0; a<nPreGrpCdArr.length; a++)
	{
		var nFilterLayer 	= "";
		var nLayerTitle		= "";						// div 타이틀 설정
		this.ds_defectGrpChartSub.filter("");			// 차트 그리드 사용 필터 초기화
		
		var nGrpCd	= nPreGrpCdArr[a];
		for(var s=0; s<nGrpSumCnt; s++)
		{
			var nLayer 	= this.ds_layerGroupSum.getColumn(s,"LAYER");
			var nGrp	= this.ds_layerGroupSum.getColumn(s,"GROUP");
			if(nGrp == nGrpCd)
			{	
				nFilterLayer 	+= this.gfn_isNull(nFilterLayer) ? "LAYERID == '"+nLayer+"'" : " || LAYERID == '"+nLayer+"'";
				nLayerTitle 	+= this.gfn_isNull(nLayerTitle) ? nLayer : "-"+nLayer;
			}
		}
		
		//그리드 필터 및 차트 필터 적용
		this.ds_defectGrpChartSub.filter("");
		
		this.ds_defectGrpChartSub.clearData();
		
		this.ds_defectGrpChartSub.copyData(this.ds_defectGrpT, true);					// 필터링 전 조회 데이터 가져옴 (조회 및 필터 걸린 상태 ds)
		
		
		
		//-----------------------------------------------------------[21.06.28] 0포함된 ds 복사
		this.ds_defectGrpChartSubCopy.filter("");
		this.ds_defectGrpChartSubCopy.clearData();
		this.ds_defectGrpChartSubCopy.copyData(this.ds_defectGrpTcopy, true);
		this.ds_defectGrpChartSubCopy.filter(nFilterLayer);
		// 그리드 그리드 Layer 설정 (Total 용추가)
		this.all["ds_defectGrpTotal0"+(a+1)].copyData(this.ds_defectGrpChartSubCopy, true);		// 필터링 후 설정(Total용)
		// (21.06.21) Layer별 정렬 추가 (Total 용추가)
		this.all["ds_defectGrpTotal0"+(a+1)].set_keystring("S:+LAYERID");						// Layer별 정렬 (Total용)
		//-----------------------------------------------------------
		
		
		
		this.ds_defectGrpChartSub.filter(nFilterLayer);
		
		// 그리드 그리드 Layer 설정
		this.all["ds_defectGrp0"+(a+1)].copyData(this.ds_defectGrpChartSub, true);		// 필터링 후 설정
		
		// (21.06.21) Layer별 정렬 추가
		this.all["ds_defectGrp0"+(a+1)].set_keystring("S:+LAYERID");			// Layer별 정렬 
		
		// 차트 설정 
		this.all["ds_chart0"+(a+1)].clearData();
		this.ds_defectGrpChartSub.set_keystring("S:+GROUPCODE");			// 불량 그룹별로 정렬
		
		var nDefectSum 	= 0;
		var nPreLayerId = "";
		
		var nPreGrpCode = "";				// 불량그룹
		
		var nInpProc	= "";				// 불량 그룹별 검사공정별 검사수 
		
		// (21.05.27 추가 - 불량코드별 색상 정보)
		var nArrDefect = [];
		nArrDefect.length = 0;
		
		var nCnt = this.ds_defectGrpChartSub.rowcount;	
		
		for(var i=0; i<nCnt; i++)
		{
			var nRow = i;
			var nDefectQty 	= this.ds_defectGrpChartSub.getColumn(i,"DEFECTCOUNT");
			var nGrpCode 	= this.ds_defectGrpChartSub.getColumn(i,"GROUPCODE");			// 현재 불량그룹
			var nPostGrpCode= this.ds_defectGrpChartSub.getColumn((nRow+1),"GROUPCODE");	// 이후 불량 그룹
			var nTotal 		= this.ds_defectGrpChartSub.getColumn(i,"TOTAL_INSPECTIONQTY");
			var nGrpName	= this.ds_defectGrpChartSub.getColumn(i,"GROUPNAME");			// 불량 그룹명
			
			if(i == 0)		// 첫행이거낭 같은 경우 합침
			{
				nDefectSum += parseInt(nDefectQty);
				nPreGrpCode = nGrpCode;
			}
			
			if(i!=0 && (nPreGrpCode != nGrpCode))		// 첫행 이후 같지않은경우 설정(기준점 재설정)
			{
				nPreGrpCode = nGrpCode;					// 초기화
				nDefectSum  = 0;						// 초기화
			}
			
			if(i != 0 && (nPreGrpCode == nGrpCode))		// 첫행 이후 같지않은경우 설정(불량 수량 증가)
			{
				nDefectSum += parseInt(nDefectQty);
			}
			
			
			// 검사수, 변경점 체크
			if(((nPostGrpCode  != nGrpCode)) ||  nCnt == 1)
			{	
			
				var nChkInsp = "";						// 같은 불량그룹에 다른 검사공정인 경우 더함 검사수
				var nCt		 = 0;
				
				for(var j=0; j<nCnt; j++)
				{
					var nTGrpCode 		= this.ds_defectGrpChartSub.getColumn(j,"GROUPCODE");
					//var nTInspProc		= this.ds_defectGrpChartSub.getColumn(j,"INPPROC");
					var nTTotal 		= this.ds_defectGrpChartSub.getColumn(j,"TOTAL_INSPECTIONQTY");
					
					if((nGrpCode == nTGrpCode))
					{
						nCt += parseInt(nTTotal);
						break;
					}
				}
				
				// 불량율 계산 
				var nAdd = this.all["ds_chart0"+(a+1)].addRow();
				this.all["ds_chart0"+(a+1)].setColumn(nAdd,"name",nGrpName);
				this.all["ds_chart0"+(a+1)].setColumn(nAdd,"value",parseFloat(nDefectSum));			// 불량수
				this.all["ds_chart0"+(a+1)].setColumn(nAdd,"TOTALQTY",parseFloat(nCt));				// 검사수
				
				var nPreRate = parseFloat(nDefectSum) / parseFloat(nCt) * 100;
				var nR = nexacro.round(nPreRate, 2);												// (소수점 2째 자리) (21.07.16)
				this.all["ds_chart0"+(a+1)].setColumn(nAdd,"percentage",parseFloat(nR));					// 불량율
				this.all["ds_chart0"+(a+1)].setColumn(nAdd,"TYPE","A");								// TYPE
				
				// (21.05.27 - 추가 - 배열 찾아서 색상 추가)
				var nColorPos 	= this.ds_chartColor.findRow("CODE",nGrpCode);
				var nColor		= this.ds_chartColor.getColumn(nColorPos,"COLOR");
				if(!this.gfn_isNull(nColor))
				{
					nArrDefect.push(nColor);
				}
			}
		}
		
		//trace(" --------------> : "+this.ds_chartTotal.saveXML());
		
		// 차트 설정
		this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+(a+1)].form.all["chart_grp0"+(a+1)].set_binddataset("ds_chart0"+(a+1));
		// 타이틀 보이지 않게 설정
		this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+(a+1)].form.all["chart_grp0"+(a+1)].title.set_visible( false );
		// 범례 보이지 않게 설정
		this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+(a+1)].form.all["chart_grp0"+(a+1)].legend.set_visible( false );
		// X축 타이틀 제거
		this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+(a+1)].form.all["chart_grp0"+(a+1)].categoryaxis.set_titletext("");
		
		//this.div_work.form.tab_work.tabpage_defectMap.form.chart_2y.show();
		
		// 색상 다양하게
		//this.div_detail.form.tab_work.Tabpage1.form.all["div_grp0"+(a+1)].form.all["chart_grp0"+(a+1)].seriesset[0].set_barfillstyle("#62be1b,#3c4596,#be0071,#4bc4c2,#f8b334,#2ba3a8,#ea5d66,#ffe100");
		// "#86B5BC,#E30513,#C1C1C1,#86BC24,#E5007D,#2F8DCD,#F9D900,#F6A200,#BCBCBC"
		//this.fn_setMaxY();
		
		
		var nColor	= "";
		if(nArrDefect.length != this.all["ds_chart0"+(a+1)].rowcount)
		{
			nColor	= "#62be1b,#3c4596,#be0071,#4bc4c2,#f8b334,#2ba3a8,#ea5d66,#ffe100";
		}
		else
		{
			for(var c=0; c<nArrDefect.length; c++)
			{
				nColor += c == 0 ? nArrDefect[c] : ","+nArrDefect[c];
			}
		}
		// 색상 다양하게
		this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+(a+1)].form.all["chart_grp0"+(a+1)].seriesset[0].set_barfillstyle(nColor);
		
		var nMaxCol = this.all["ds_chart0"+(a+1)].getCaseMax( "TYPE == 'A'", "value" );				// col의 최대값
		
		var nMaxLine = this.all["ds_chart0"+(a+1)].getCaseMax( "TYPE == 'A'", "percentage" );			// line의 최대값
		
		//trace(" =====> : "+nMaxCol+" | "+nMaxLine);
		
		//this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+(a+1)].form.all["chart_grp0"+(a+1)].valueaxes[0].set_tickmax(parseFloat(nMaxCol)+20);
		
		// (21.08.03) x 축 소소점 안보이도록 설정
		this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+(a+1)].form.all["chart_grp0"+(a+1)].valueaxes[0].set_tickmax(parseInt(parseFloat(nMaxCol)*1.10));
		this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+(a+1)].form.all["chart_grp0"+(a+1)].valueaxes[1].set_tickmax(parseFloat(nMaxLine)+2);
		//this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+(a+1)].form.all["chart_grp0"+(a+1)].valueaxes[1].set_tickmax(parseFloat(nMaxLine)*1.1);
		
		// sta 설정 변경
		var nTitle = "Group"+nPreGrpCdArr[a].substring(nPreGrpCdArr[a].length-1, nPreGrpCdArr[a].length)+">>"+nLayerTitle;
		
		this.div_work.form.tab_work.Tabpage1.form.all["div_grp0"+(a+1)].form.all["sta_subtitleGrp0"+(a+1)].set_text(nTitle);
		
		trace(" =====> : "+nPreGrpCdArr[a]+" | "+nFilterLayer+" | "+this.ds_defectGrpChartSub.rowcount+" | "+nTitle);
	}
}; 

/**************************************************************************
 * 8. 이벤트
 ***************************************************************************/ 
 /*
  * 조회기간 콤보 변경시
  */
this.tab_search_tab_search01_cbo_period_onitemchanged = function(obj:nexacro.Combo,e:nexacro.ItemChangeEventInfo)
{
	var val = this.tab_search.tab_search01.form.cbo_period.value; //var val = e.postvalue
	
	if(this.gfn_isNull(val)) return;

	var sDate 		= this.nfn_getCurrentSystemTime(0,0,val);
	var arrDate 	= sDate.split(",");
	var sDateFrom 	= arrDate[1];
	var sDateTo 	= arrDate[2];
	var sTime 		= "0830";
	
	var dateFrom 	= this.tab_search.tab_search01.form.div_dateFrom.form.calStart.value;
	var dateTo 		= this.tab_search.tab_search01.form.div_dateTo.form.calStart.value;
	
	if(!this.gfn_isNull(dateFrom) && dateTo.length>=12){
		sTime = dateTo.substring(8,12);
	}
	this.tab_search.tab_search01.form.div_dateFrom.form.calStart.set_value(sDateFrom+sTime);
	if(!this.gfn_isNull(dateTo) && dateTo.length==12){
		sTime = dateTo.substring(8,12);
	}
	this.tab_search.tab_search01.form.div_dateTo.form.calStart.set_value(sDateTo+sTime);	
};

/*
 * 필터 - Lot No 조회 팝업
 */
this.tab_search_tab_search01_btn_lotNo_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var nEnterpriseId 	= this.gf_getEnterpriseId();	//ENTERPRISEID
	var nSite 			= this.gf_getSiteType();		//Site
	var popupId = "SCH_LOTNo";
	var oArg = {};
	var opts = "width=850,height=500";
	
	// 기 입력값 있는지 확인
	var nSearch 	= this.tab_search.tab_search01.form.edt_lotNo.value;
	var nPeriodfr 	= this.tab_search.tab_search01.form.div_dateFrom.form.calStart.value;
	var nPeriodto 	= this.tab_search.tab_search01.form.div_dateTo.form.calStart.value;
	
	if(!this.gfn_isNull(nSearch))
	{
		// 기입력된 값이 있으면
		oArg.arg_lotNo 		= nSearch;
	}
	oArg.arg_periodfr 	= nPeriodfr;
	oArg.arg_periodto 	= nPeriodto;
		
	this.gfn_openPopup(popupId,"dfm::DFM00400P.xfdl" ,oArg ,opts);
};

/*
 * 필터 - 품목코드 조회 팝업
 */
this.tab_search_tab_search01_btn_itemCode_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var nEnterpriseId 	= this.gf_getEnterpriseId();	//ENTERPRISEID
	var nSite 			= this.gf_getSiteType();		//Site
	var popupId = "SCH_ITEMCODE";
	var oArg = {};
	var opts = "width=650,height=500";
	
	// 기 입력값 있는지 확인
	var nSearch 	= this.tab_search.tab_search01.form.edt_itemCode.value;
	var nPeriodfr 	= this.tab_search.tab_search01.form.div_dateFrom.form.calStart.value;
	var nPeriodto 	= this.tab_search.tab_search01.form.div_dateTo.form.calStart.value;
	
	if(!this.gfn_isNull(nSearch))
	{
		// 기입력된 값이 있으면
		oArg.arg_itemCode	= nSearch;
	}
	oArg.arg_periodfr 		= nPeriodfr;
	oArg.arg_periodto 		= nPeriodto;
		
	this.gfn_openPopup(popupId,"dfm::DFM00401P.xfdl" ,oArg ,opts);
};

/*
 * 필터 - Layer 조회 팝업
 */
this.tab_search_tab_search01_btn_layer_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var nRevDs = this.tab_search.tab_search01.form.div_revMulti.form;
	var nFs			= "";
	for(var i=0; i<nRevDs.ds_initData.rowcount; i++){
		var chk 	= nRevDs.ds_initData.getColumn(i,"CHK");
		var code 	= nRevDs.ds_initData.getColumn(i,"CODE");
		if(chk == 1 && !this.gfn_isNull(code))
		{
			nFs += this.gfn_isNull(nFs)? code : ", " +code;
		}
	}
	// 조회 조건 담아 둔것 초기화.(필터용으로 사용 할 것!)
	
	//trace(" Rev 여러건 선택시 : "+nFs);
	
	var nEnterpriseId 	= this.gf_getEnterpriseId();	//ENTERPRISEID
	
	var popupId = "SCH_LAYER";
	var oArg = {};
	var opts = "width=800,height=550";
	
	// 기 입력값 있는지 확인
	var nItemCode	 	= this.tab_search.tab_search01.form.edt_itemCode.value;
	
	
	oArg.arg_rev 		= nFs;
	oArg.arg_enter 		= nEnterpriseId;
	oArg.arg_item 		= nItemCode;
	oArg.arg_rtnCols 	= "LAYER|GROUP";				// 리턴 받을값
	
	oArg.arg_chkDs 		= this.ds_layerGroupSum;		// 이미 선택된 ds값
		
	this.gfn_openPopup(popupId,"dfm::DFM00402P.xfdl" ,oArg ,opts);
};

/*
 * 필터 초기화
 */
this.fn_initSearch = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	// 지우고 콤보 초기화 필요
	this.tab_search.tab_search01.form.edt_lotNo.set_value("");
	this.tab_search.tab_search01.form.edt_itemCode.set_value("");
	this.tab_search.tab_search01.form.edt_itemNm.set_value("");
	
	// 검색조건 달력 설정
	this.tab_search.tab_search01.form.cbo_period.set_value("thisweek");
	this.tab_search_tab_search01_cbo_period_onitemchanged();
	// Rev 조회
	this.fn_setRev("");
};

/*
 * 메인 초기화
 */
this.div_header_btn_resetWork_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	// 품목코드 유무에 따른 분기 처리 진행
	this.ds_rawData.clearData();			// raw data용 ds 초기화
	this.ds_searchMain.clearData();			// 조회 조건 초기화
	
	this.ds_cmbDefectGrp.clearData();		// 불량그룹 콤보ds 초기화
	this.ds_cmbDefectCode.clearData();		// 불량코드 콤보ds 초기화
	this.ds_defectGrpT.clearData();			// Total 그리드 정보 ds 초기화
	this.ds_chartColor.clearData();			// 차트 불량그룹별 색상 정보 ds 
	this.ds_chartTotal.clearData();			// Total 차트 ds 초기화
	
	// 멀티 콤보 초기화
	// 조회 후 멀티 콤보(상위설정)
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectGrpMulti.form.fn_init_multicombo_data(this.ds_cmbDefectGrp);
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectGrpMulti.form.ds_initData.applyChange(); 
	
	// 하위 멀티 콤보 이벤트 설정.
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectCodeMulti.form.fn_init_multicombo_data(this.ds_cmbDefectCode);
	this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectCodeMulti.form.ds_initData.applyChange();
	
	// total 제외 그리드 / 차트 안보이게 설정
	this.fn_setChartGridVisibl(0);
	
	// 하단 sub ds 초기화
	for(var h=1; h<=6; h++)
	{
		this.all["ds_defectGrp0"+h].clearData();
		this.all["ds_chart0"+h].clearData();
	}
	
};

/*
 * Layer 포커스 들어 올경우 초기화
 */
this.tab_search_tab_search01_edt_layer_onsetfocus = function(obj:nexacro.Edit,e:nexacro.SetFocusEventInfo)
{
	// ds에 설정
	this.ds_layerGroupSum.clearData();
	this.tab_search.tab_search01.form.edt_layer.set_value("");
};

/*
 * 필터 버튼 클릭
 */
this.div_detail_tab_work_Tabpage1_div_total_btn_filter_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var nFs			= "";		// 필터 조건
	var nFsub		= "";		// 필터 조건(세부)
	
	// 상위
	var nDefectGrpDs = this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectGrpMulti.form;
	
	this.ds_defectGrpT.filter("");		// 필터 초기화
	
	
	for(var i=0; i<nDefectGrpDs.ds_initData.rowcount; i++){
		var chk = nDefectGrpDs.ds_initData.getColumn(i,"CHK");
		var code = nDefectGrpDs.ds_initData.getColumn(i,"CODE");
		if(chk == 1 && !this.gfn_isNull(code))
		{
			nFs += this.gfn_isNull(nFs) ? "GROUPCODE == '"+code+"'" : " || GROUPCODE == '"+code+"'";
		}
	}
	
	if(!this.gfn_isNull(nFs))
	{
		nFs = "("+nFs+")";
	}
	
	// 하위
	var nDefectCodeDs = this.div_work.form.tab_work.Tabpage1.form.div_total.form.div_defectCodeMulti.form;
	
	for(var i=0; i<nDefectCodeDs.ds_initData.rowcount; i++){
		var chk = nDefectCodeDs.ds_initData.getColumn(i,"CHK");
		var code = nDefectCodeDs.ds_initData.getColumn(i,"CODE");
		if(chk == 1 && !this.gfn_isNull(code))
		{
			nFsub += this.gfn_isNull(nFsub) ? "SUBCODE == '"+code+"'" : " || SUBCODE == '"+code+"'";
		}
	}
	
	// (21.08.03) 필터 하위만 선택한 경우 필터 되도록 수정
	if(!this.gfn_isNull(nFsub) && !this.gfn_isNull(nFs))
	{
		nFsub = "&& ("+nFsub+")";
	}
	
	
	nFs = nFs+nFsub;
	
	
	this.ds_defectGrpT.filter("");		// 필터 초기화
	//------------------------------------------------
	// (21.06.25) 불량수 0인것 제외
	//this.ds_defectGrpT.filter("DEFECTCOUNT != '0'");
	this.ds_defectGrpTcopy.filter("");		// 필터 초기화
	this.ds_defectGrpTcopy.filter(nFs);		// 필터 초기화 (불량수 0인것 미제외 한 ds)
	if(!this.gfn_isNull(nFs))
	{
		nFs = nFs+ "&& (DEFECTCOUNT != '0')";
	}
	else
	{
		nFs =  "(DEFECTCOUNT != '0')";
	}
	trace(" ------ (필터 조건) : "+nFs);
	//------------------------------------------------
	this.ds_defectGrpT.filter(nFs);		// 필터 설정
	
	
	// 차트 설정
	//this.fn_setChart();
	//this.fn_setChartLayer();
	
	// 이미지 설정(기존은 재조회 / 샘플인경우 필터링건다.)
	//this.fn_reSetImageLayer();
	
	// Total 차트 설정
	this.fn_setChartLayer();
	
	// group 수
	var nGroupCnt 	= 0;
	var nGrpSumCnt 	= this.ds_layerGroupSum.rowcount;
	var nPreGrpCd	= "";
	for(var i=0; i<nGrpSumCnt; i++)
	{
		var nGrpCd	= this.ds_layerGroupSum.getColumn(i,"GROUP");
		if(nPreGrpCd != nGrpCd)
		{
			nGroupCnt++;
			nPreGrpCd = nGrpCd;
		}
	}
	// total 제외 그리드 / 차트 안보이게 설정
	this.fn_setChartGridVisibl(nGroupCnt);
	
	// Total 하단의 그리드 및 차트 설정
	this.fn_setSubChartGrid();
	
};













]]></Script>
  </Form>
</FDL>

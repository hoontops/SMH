<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="BAS02100M" width="1258" height="747" titletext="ROUTING" onload="fn_init">
    <Layouts>
      <Layout height="747" mobileorientation="landscape" width="1258" stepcount="0">
        <Tab id="tab_search" taborder="1" tabindex="0" left="0" top="47" cssclass="tab_search" bottom="0" width="290">
          <Tabpages>
            <Tabpage id="Tabpage1" text="Tabpage1">
              <Layouts>
                <Layout>
                  <Button id="btn_clear2" taborder="7" top="150" width="102" height="36" cssclass="btn_SA_reset" left="171" text="초기화" tooltiptext="Toolbar_Initialization" onclick="fn_formInit"/>
                  <Button id="btn_search" taborder="6" top="150" width="146" height="36" cssclass="btn_SA_search" left="15" text="검색" tooltiptext="Toolbar_Search" onclick="fn_search"/>
                  <Static id="Static12_00_00_00_00" taborder="8" text="w&#13;&#10;15" width="15" top="0" visible="false" height="300" cssclass="guideTip" left="0"/>
                  <Static id="Static12_00_00_00_00_00" taborder="9" text="w&#13;&#10;10" width="10" top="156" visible="false" height="27" cssclass="guideTip" left="161"/>
                  <Static id="staPlantList" taborder="10" text="Site" left="0" top="10" width="103" height="20" cssclass="sta_WF_label"/>
                  <Combo id="cbo_site" taborder="0" text="CCT" left="108" top="10" height="20" index="1" value="" width="165"/>
                  <Static id="staProductDefVersion" taborder="11" text="품목 버전" left="0" top="85" width="103" height="20" cssclass="sta_WF_label" tooltiptext="D803F17F3C844E62AA1972AB54C4432A"/>
                  <Static id="guidetip02" taborder="12" text="h10" top="0" visible="false" height="10" cssclass="guideTip" left="0" right="0"/>
                  <Static id="guidetip03" taborder="13" text="h5" top="55" visible="false" height="5" cssclass="guideTip" left="0" right="0"/>
                  <Static id="guidetip04" taborder="14" text="h20" top="130" visible="false" height="20" cssclass="guideTip" left="0" right="0"/>
                  <Static id="staProcductName" taborder="15" text="품목명" left="0" top="110" width="103" height="20" cssclass="sta_WF_label" tooltiptext="ITEMNAME"/>
                  <Edit id="edt_item_cd" taborder="4" left="108" top="85" height="20" width="165" enable="false" tabstop="false" readonly="true" value="FA1" text="FA1"/>
                  <Edit id="edt_item_nm" taborder="5" left="108" top="110" height="20" width="165" enable="false" tabstop="false" readonly="true"/>
                  <Static id="staProductCode" taborder="16" text="품목코드" left="0" top="60" width="103" height="20" cssclass="sta_WF_label_point" tooltiptext="PRODUCTDEFID"/>
                  <Edit id="edt_item" taborder="2" left="108" top="60" height="20" width="143" value="1010759A5" text="1010759A5" onkeydown="tab_search_Tabpage1_edt_item_onkeydown"/>
                  <Button id="btn_item" taborder="3" width="22" height="20" cssclass="btn_WF_finder" top="60" right="15" onclick="tab_search_Tabpage1_btnProductCode_onclick"/>
                  <Combo id="cbo_validState" taborder="1" text="CCT" left="108" top="35" height="20" index="1" value="" width="165" codecolumn="C,ValidState,ALL,Y,Y"/>
                  <Static id="staValidState" taborder="17" text="유효상태" left="0" top="35" width="103" height="20" cssclass="sta_WF_label" tooltiptext="VALIDSTATE"/>
                  <Static id="guidetip03_00" taborder="18" text="h5" top="30" visible="false" height="5" cssclass="guideTip" left="0" right="0"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="sta_searchTitle" taborder="0" text="검색조건" left="0" top="47" width="281" height="34" cssclass="sta_WF_subTitle" fittocontents="width" usedecorate="true" tooltiptext="SEARCH_CONDITION_GROUP"/>
        <Div id="div_work" taborder="2" text="Div00" top="47" formscrollbarsize="10" left="300" bottom="0" right="1">
          <Layouts>
            <Layout>
              <Static id="Static01" taborder="0" text="서브타이틀" left="112" top="-63" width="101" height="20" cssclass="sta_WF_title" fittocontents="width"/>
              <Static id="Static12_00_00_00" taborder="1" text="w&#13;&#10;15" width="15" top="0" visible="false" height="300" cssclass="guideTip" right="669"/>
              <Grid id="treeRouting" taborder="10" left="0" top="35" width="230" cssclass="grd_tree" binddataset="ds_tree" autofittype="col" autoenter="select" treeinitstatus="collapse,all" treeuseexpandkey="true" treeusecheckbox="false" treeusebutton="use" bottom="0" oncellclick="div_work_treeRouting_oncellclick">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="260"/>
                    </Columns>
                    <Rows>
                      <Row size="24"/>
                    </Rows>
                    <Band id="body">
                      <Cell displaytype="treeitemcontrol" edittype="tree" text="bind:DISPLAYNAME" treestartlevel="0" treelevel="bind:BOMLEVEL" autosizecol="none"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Tab id="tab_00" taborder="7" tabindex="0" left="treeRouting:5" top="473" bottom="0" right="0" cssclass="tab_master" onchanged="div_work_tab_00_onchanged">
                <Tabpages>
                  <Tabpage id="Tabpage1" text="자재" tooltiptext="CONSUMABLE">
                    <Layouts>
                      <Layout>
                        <Grid id="grd_consumable" taborder="0" left="0" right="0" bottom="0" autosizingtype="none" autofittype="none" autoenter="select" binddataset="ds_consumable" top="31" onexpandup="div_work_tab_00_Tabpage1_grd_consumable_onexpandup" oncloseup="div_work_tab_00_Tabpage1_grd_consumable_oncloseup">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="30"/>
                                <Column size="120"/>
                                <Column size="48"/>
                                <Column size="150"/>
                                <Column size="110"/>
                                <Column size="90"/>
                                <Column size="90"/>
                                <Column size="73"/>
                                <Column size="90"/>
                                <Column size="120"/>
                                <Column size="90"/>
                                <Column size="90"/>
                                <Column size="90"/>
                                <Column size="90"/>
                                <Column size="90"/>
                                <Column size="90"/>
                                <Column size="70"/>
                                <Column size="90"/>
                                <Column size="150"/>
                                <Column size="100"/>
                                <Column size="120"/>
                                <Column size="150"/>
                                <Column size="120"/>
                                <Column size="150"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell displaytype="normal" edittype="none" text="No"/>
                                <Cell col="1" text="자재코드" cssclass="cell_point"/>
                                <Cell col="2" text="Rev"/>
                                <Cell col="3" text="자재명"/>
                                <Cell col="4" text="자재유형"/>
                                <Cell col="5" text="사용층"/>
                                <Cell col="6" text="작업방식"/>
                                <Cell col="7" text="인쇄면"/>
                                <Cell col="8" text="소요량"/>
                                <Cell col="9" text="BOM 소요량 계산식"/>
                                <Cell col="10" text="변수1(기본값)"/>
                                <Cell col="11" text="변수2(LOSS)"/>
                                <Cell col="12" text="변수3(합수)"/>
                                <Cell col="13" text="변수4(자재SIZE)"/>
                                <Cell col="14" text="변수5(기타)"/>
                                <Cell col="15" text="공급유형" cssclass="cell_point"/>
                                <Cell col="16" text="UOM"/>
                                <Cell col="17" text="RTR 투입"/>
                                <Cell col="18" text="대체품목"/>
                                <Cell col="19" text="제조사"/>
                                <Cell col="20" tooltiptext="CREATOR" text="생성자"/>
                                <Cell col="21" tooltiptext="CREATEDTIME" text="생성일"/>
                                <Cell col="22" tooltiptext="MODIFIER" text="수정자"/>
                                <Cell col="23" tooltiptext="MODIFIEDTIME" text="수정일"/>
                              </Band>
                              <Band id="body">
                                <Cell edittype="none" displaytype="number" text="expr:currow+1"/>
                                <Cell col="1" text="bind:COMPONENTITEMID" expandimage="url('theme://images/grd_expand.png')" expandsize="24" expandshow="expr:dataset.getRowType(currow) ==2 ? 'show':'hide'" displaytype="text" textAlign="left"/>
                                <Cell col="2" text="bind:COMPONENTITEMVERSION"/>
                                <Cell col="3" text="bind:COMPONENTITEMNAME" displaytype="text" textAlign="left"/>
                                <Cell col="4" text="bind:MATERIALDETAILTYPE" displaytype="combotext" edittype="combo" combocodecol="C,MaterialDetailType,null,Y,Y"/>
                                <Cell col="5" text="bind:USERLAYER" displaytype="combotext" edittype="combo" combocodecol="C,UserLayer,,Y,Y"/>
                                <Cell col="6" text="bind:WORKMETHOD" displaytype="combotext" edittype="expr:dataset.parent.fn_chkMaterialType(MATERIALDETAILTYPE)" combocodecol="C,OutsourcingSpecWorkType,,Y,Y"/>
                                <Cell col="7" edittype="expr:MATERIALDETAILTYPE=='PSR' ? 'combo' : 'none'" displaytype="combotext" combocodecol="C,PSRPRINTTYPE,null,Y,Y" text="bind:PSRPRINTTYPE"/>
                                <Cell col="8" text="bind:COMPONENTQTY" displaytype="number" edittype="normal" editinputtype="number"/>
                                <Cell col="9" text="bind:BOMFORMULAID" displaytype="combotext" edittype="combo" combodataset="ds_bomList" combocodecol="CODE" combodatacol="NAME"/>
                                <Cell col="10" edittype="expr:ISEDITABLE1==&quot;true&quot; ? &quot;normal&quot; : &quot;none&quot;" editinputtype="number" displaytype="number" text="bind:VARIABLE1"/>
                                <Cell col="11" edittype="expr:ISEDITABLE2==&quot;true&quot; ? &quot;normal&quot; : &quot;none&quot;" editinputtype="number" displaytype="number" text="bind:VARIABLE2"/>
                                <Cell col="12" edittype="expr:ISEDITABLE3==&quot;true&quot; ? &quot;normal&quot; : &quot;none&quot;" editinputtype="number" displaytype="number" text="bind:VARIABLE3"/>
                                <Cell col="13" edittype="expr:ISEDITABLE4==&quot;true&quot; ? &quot;normal&quot; : &quot;none&quot;" editinputtype="number" displaytype="number" text="bind:VARIABLE4"/>
                                <Cell col="14" edittype="expr:ISEDITABLE5==&quot;true&quot; ? &quot;normal&quot; : &quot;none&quot;" editinputtype="number" displaytype="number" text="bind:VARIABLE5"/>
                                <Cell col="15" text="bind:WIPSUPPLYTYPE" displaytype="combotext" edittype="expr:MATERIALTYPE==&quot;Product&quot; ? &quot;none&quot; : &quot;combo&quot;" combocodecol="C,WipSupplyType,,Y,Y"/>
                                <Cell col="16" text="bind:COMPONENTUOM" displaytype="combotext" combodataset="ds_uom" combocodecol="CODE" combodatacol="NAME"/>
                                <Cell col="17" text="bind:ISREQUIREDMATERIAL" displaytype="combotext" edittype="combo" combocodecol="C,YesNo,,Y,Y"/>
                                <Cell col="18" text="bind:ALTITEM" displaytype="normal" edittype="none" combocodecol="C,YesNo,,Y,Y" expandimage="url('theme://images/grd_expand.png')" expandshow="show" expandsize="24"/>
                                <Cell col="19" text="bind:MAKER"/>
                                <Cell col="20" text="bind:CREATOR"/>
                                <Cell col="21" text="bind:CREATEDTIME" displaytype="text" calendardateformat="yyyy-MM-dd HH:mm:ss" calendareditformat="yyyy-MM-dd HH:mm:ss"/>
                                <Cell col="22" text="bind:MODIFIER"/>
                                <Cell col="23" text="bind:MODIFIEDTIME" displaytype="text" calendardateformat="yyyy-MM-dd HH:mm:ss" calendareditformat="yyyy-MM-dd HH:mm:ss"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Button id="btn_delconsumable" taborder="2" width="29" height="24" cssclass="btn_WF_grdDel" tooltiptext="GridDelete" right="29" initvalueid="x" onclick="fn_delDetail" text="" bottom="grd_consumable:0" visible="true"/>
                        <Button id="btn_addconsumable" taborder="1" width="29" cssclass="btn_WF_grdAdd" tooltiptext="GridAdd" right="btn_delconsumable:0" initvalueid="x" height="24" bottom="grd_consumable:0" visible="true" onclick="fn_addDetail"/>
                        <Button id="btn_xlDn_grd_consumable" taborder="3" width="29" cssclass="btn_WF_grdExcelDown" tooltiptext="GridExport" right="0" initvalueid="x" height="24" bottom="grd_consumable:0"/>
                        <Static id="sta_cnt_ds_consumable" taborder="4" left="0" top="-3" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" text="Count : &lt;fc v=&quot;#f31d24&quot;&gt;0&lt;/fc&gt;" width="200"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="Tabpage2" text="공정SPEC" tooltiptext="SPECINSPITEM">
                    <Layouts>
                      <Layout>
                        <Grid id="grd_operationSpec" taborder="1" left="0" top="31" right="0" bottom="0" autosizingtype="none" autofittype="none" autoenter="select" binddataset="ds_operationSpec" onexpandup="div_work_tab_00_Tabpage2_grd_operationSpec_onexpandup">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="30"/>
                                <Column size="160"/>
                                <Column size="120"/>
                                <Column size="90"/>
                                <Column size="90"/>
                                <Column size="90"/>
                                <Column size="70"/>
                                <Column size="100"/>
                                <Column size="140"/>
                                <Column size="100"/>
                                <Column size="140"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell rowspan="2" displaytype="normal" edittype="none" text="No"/>
                                <Cell col="1" rowspan="2" tooltiptext="INSPECTIONDEFID" text="검사항목명" cssclass="cell_point"/>
                                <Cell col="2" rowspan="2" tooltiptext="INSPITEMCLASSID" text="위치"/>
                                <Cell col="3" colspan="3" tooltiptext="INSPITEMID" text="사양 SPEC"/>
                                <Cell col="6" rowspan="2" text="동박두께&#13;&#10;(OZ)"/>
                                <Cell col="7" rowspan="2" tooltiptext="CREATOR" text="생성자"/>
                                <Cell col="8" rowspan="2" tooltiptext="CREATEDTIME" text="생성일"/>
                                <Cell col="9" rowspan="2" text="수정자" tooltiptext="MODIFIER"/>
                                <Cell col="10" rowspan="2" text="수정일" tooltiptext="MODIFIEDTIME"/>
                                <Cell row="1" col="3" text="하한값"/>
                                <Cell row="1" col="4" text="기준값"/>
                                <Cell row="1" col="5" text="상한값"/>
                              </Band>
                              <Band id="body">
                                <Cell edittype="none" displaytype="number" text="expr:currow+1"/>
                                <Cell col="1" text="bind:INSPITEMNAME" expandimage="url('theme://images/grd_expand.png')" expandshow="show" expandsize="24" displaytype="text" textAlign="left" cssclass="point"/>
                                <Cell col="2" text="bind:LOCATION" displaytype="text" edittype="normal" combodataset="ds_inspection" combocodecol="CODE" combodatacol="NAME" textAlign="left"/>
                                <Cell col="3" text="bind:LSL" expandshow="hide" expandsize="24" displaytype="text" textAlign="right" edittype="normal" editinputtype="number"/>
                                <Cell col="4" text="bind:SL" displaytype="text" textAlign="right" edittype="normal" editinputtype="number"/>
                                <Cell col="5" text="bind:USL" displaytype="text" edittype="normal" combocodecol="C,YesNo,,Y,Y" textAlign="right" editinputtype="number"/>
                                <Cell col="6" text="bind:COPPERTHICKNESS" displaytype="number" edittype="expr:dataset.parent.fn_InspType(SPECTRANSTYPE)"/>
                                <Cell col="7" text="bind:CREATOR"/>
                                <Cell col="8" text="bind:CREATEDTIME" displaytype="text" calendardateformat="yyyy-MM-dd HH:mm:ss" calendareditformat="yyyy-MM-dd HH:mm:ss"/>
                                <Cell col="9" text="bind:MODIFIER"/>
                                <Cell col="10" text="bind:MODIFIEDTIME" displaytype="text" calendardateformat="yyyy-MM-dd HH:mm:ss" calendareditformat="yyyy-MM-dd HH:mm:ss"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Static id="sta_cnt_ds_operationSpec" taborder="0" left="0" top="-3" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" text="Count : &lt;fc v=&quot;#f31d24&quot;&gt;0&lt;/fc&gt;" width="200"/>
                        <Button id="btn_addoperationSpec" taborder="2" width="29" cssclass="btn_WF_grdAdd" tooltiptext="GridAdd" right="58" initvalueid="x" height="24" bottom="grd_operationSpec:0" visible="true" onclick="fn_addDetail"/>
                        <Button id="btn_deloperationSpec" taborder="3" width="29" height="24" cssclass="btn_WF_grdDel" tooltiptext="GridDelete" right="29" initvalueid="x" onclick="fn_delDetail" text="" bottom="grd_operationSpec:0" visible="true"/>
                        <Button id="btn_xlDn_grd_operationSpec" taborder="4" cssclass="btn_WF_grdExcelDown" tooltiptext="GridExport" initvalueid="x" height="24" bottom="grd_operationSpec:0" width="29" right="0"/>
                        <Combo id="cbo_barcharinfo" taborder="5" text="CCT" top="7" height="20" index="1" value="" codecolumn="C,ControlType,,Y,Y" right="btn_addoperationSpec:5" width="115" onitemchanged="div_work_tab_00_Tabpage2_cbo_barcharinfo_onitemchanged"/>
                        <Static id="sta_00_00_00" taborder="6" text="기본 차트 유형" left="sta_cnt_ds_operationSpec:10" top="5" height="24" wordWrap="english" tooltiptext="DEFAULTCHARTTYPE" right="cbo_barcharinfo:5" cssclass="sta_WF_detail" textAlign="right"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="Tabpage3" text="치공구" tooltiptext="DURABLE">
                    <Layouts>
                      <Layout>
                        <Static id="sta_cnt_ds_durable" taborder="0" left="0" top="-3" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" text="Count : &lt;fc v=&quot;#f31d24&quot;&gt;0&lt;/fc&gt;" width="200"/>
                        <Grid id="grd_durable" taborder="4" left="0" top="26" binddataset="ds_durable" right="4" bottom="0" autoupdatetype="itemselect" onexpandup="div_work_tab_00_Tabpage3_grd_durable_onexpandup" autoenter="select">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="30"/>
                                <Column size="120"/>
                                <Column size="111"/>
                                <Column size="250"/>
                                <Column size="120"/>
                                <Column size="80"/>
                                <Column size="250"/>
                                <Column size="200"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="80"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="No"/>
                                <Cell col="1" text="품목코드" tooltiptext="ITEMCODE" cssclass="cell_point"/>
                                <Cell col="2" text="Rev." tooltiptext="INNERREVISION"/>
                                <Cell col="3" text="품목명" tooltiptext="ITEMNAME"/>
                                <Cell col="4" text="치공구ID"/>
                                <Cell col="5" text="치공구 Rev" tooltiptext="TXTTOOLVERSION"/>
                                <Cell col="6" text="치공구명"/>
                                <Cell col="7" text="설명"/>
                                <Cell col="8" text="생성자"/>
                                <Cell col="9" text="생성일"/>
                                <Cell col="10" text="수정자"/>
                                <Cell col="11" text="수정일"/>
                              </Band>
                              <Band id="body">
                                <Cell text="expr:currow+1" textAlign="right"/>
                                <Cell col="1" text="bind:PRODUCTDEFID" expandshow="show" expandimage="url('theme://images/grd_expand.png')"/>
                                <Cell col="2" text="bind:PRODUCTDEFVERSION"/>
                                <Cell col="3" text="bind:PRODUCTDEFNAME" textAlign="left"/>
                                <Cell col="4" text="bind:TOOLCODE"/>
                                <Cell col="5" text="bind:TOOLVERSION"/>
                                <Cell col="6" text="bind:TOOLNAME" textAlign="left"/>
                                <Cell col="7" text="bind:DESCRIPTION" edittype="normal" textAlign="left"/>
                                <Cell col="8" text="bind:CREATOR"/>
                                <Cell col="9" text="bind:CREATEDTIME" calendardateformat="yyyy-MM-dd HH:mm:ss"/>
                                <Cell col="10" text="bind:MODIFIER"/>
                                <Cell col="11" text="bind:MODIFIEDTIME" calendardateformat="yyyy-MM-dd HH:mm:ss"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Button id="btn_deldurable" taborder="2" width="29" height="24" cssclass="btn_WF_grdDel" tooltiptext="GridDelete" right="29" initvalueid="x" onclick="fn_delDetail" text="" bottom="grd_durable:0" visible="true"/>
                        <Button id="btn_adddurable" taborder="1" width="29" cssclass="btn_WF_grdAdd" tooltiptext="GridAdd" right="btn_deldurable:0" initvalueid="x" height="24" bottom="grd_durable:0" visible="true" onclick="fn_addDetail"/>
                        <Button id="btn_xlDn_grd_durable" taborder="3" cssclass="btn_WF_grdExcelDown" tooltiptext="GridExport" initvalueid="x" height="24" bottom="grd_durable:0" right="0" width="29"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="Tabpage4" text="AOI 층" tooltiptext="AOIQCLAYER">
                    <Layouts>
                      <Layout>
                        <Grid id="grd_aoiLayer" taborder="0" left="0" top="31" right="0" bottom="0" autosizingtype="none" autofittype="none" autoenter="select" onexpandup="div_work_tab_Tabpage1_tab_00_Tabpage2_grd_processD_onexpandup" oncloseup="div_work_tab_Tabpage1_tab_00_Tabpage2_grd_processD_oncloseup" binddataset="ds_aoiLayer">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="30"/>
                                <Column size="100"/>
                                <Column size="100"/>
                                <Column size="250"/>
                                <Column size="100"/>
                                <Column size="140"/>
                                <Column size="100"/>
                                <Column size="140"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell displaytype="none" edittype="none" text="No"/>
                                <Cell col="1" tooltiptext="INSPECTIONDEFID" text="AOI 층"/>
                                <Cell col="2" tooltiptext="INSPITEMCLASSID" text="AOI2 층"/>
                                <Cell col="3" tooltiptext="DESCRIPTIOn" text="설명"/>
                                <Cell col="4" tooltiptext="CREATOR" text="생성자"/>
                                <Cell col="5" tooltiptext="CREATEDTIME" text="생성일"/>
                                <Cell col="6" text="수정자" tooltiptext="MODIFIER"/>
                                <Cell col="7" text="수정일" tooltiptext="MODIFIEDTIME"/>
                              </Band>
                              <Band id="body">
                                <Cell edittype="none" displaytype="number" text="expr:currow+1"/>
                                <Cell col="1" displaytype="combotext" edittype="combo" combocodecol="C,Layer,,Y,Y" text="bind:AOIQCLAYER"/>
                                <Cell col="2" displaytype="combotext" edittype="combo" combodataset="ds_inspection" combocodecol="C,Layer,,Y,Y" combodatacol="NAME" text="bind:AOIQCLAYER2"/>
                                <Cell col="3" text="bind:DESCRIPTION" expandshow="hide" expandsize="24" displaytype="text" edittype="normal" textAlign="left"/>
                                <Cell col="4" text="bind:CREATOR"/>
                                <Cell col="5" text="bind:CREATEDTIME" displaytype="text" calendardateformat="yyyy-MM-dd HH:mm:ss" calendareditformat="yyyy-MM-dd HH:mm:ss"/>
                                <Cell col="6" text="bind:MODIFIER"/>
                                <Cell col="7" text="bind:MODIFIEDTIME" displaytype="text" calendardateformat="yyyy-MM-dd HH:mm:ss" calendareditformat="yyyy-MM-dd HH:mm:ss"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Static id="sta_cnt_ds_aoiLayer" taborder="1" left="0" top="-3" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" text="Count : &lt;fc v=&quot;#f31d24&quot;&gt;0&lt;/fc&gt;" width="200"/>
                        <Button id="btn_delaoiLayer" taborder="3" width="29" height="24" cssclass="btn_WF_grdDel" tooltiptext="GridDelete" right="29" initvalueid="x" onclick="fn_delDetail" text="" bottom="grd_aoiLayer:0" visible="true"/>
                        <Button id="btn_addaoiLayer" taborder="2" width="29" cssclass="btn_WF_grdAdd" tooltiptext="GridAdd" right="btn_delaoiLayer:0" initvalueid="x" height="24" bottom="grd_aoiLayer:0" visible="true" onclick="fn_addDetail"/>
                        <Button id="btn_xlDn_grd_aoiLayer" taborder="4" cssclass="btn_WF_grdExcelDown" tooltiptext="GridExport" initvalueid="x" height="24" bottom="grd_aoiLayer:0" right="0" width="29"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                </Tabpages>
              </Tab>
              <Static id="sta_subTitle" taborder="2" text="공정" left="260" top="129" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" fittocontents="width" tooltiptext="OPERATION" width="90"/>
              <Static id="sta_cnt_ds_operation" taborder="3" left="sta_subTitle:15" top="129" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" text="Count : &lt;fc v=&quot;#f31d24&quot;&gt;0&lt;/fc&gt;" width="200"/>
              <Grid id="grd_operation" taborder="11" left="treeRouting:5" right="0" binddataset="ds_operation" autoenter="select" top="166" height="307" treeinitstatus="expand,null" onexpandup="div_work_grd_operation_onexpandup" oncloseup="div_work_grd_operation_oncloseup">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="40"/>
                      <Column size="60"/>
                      <Column size="60"/>
                      <Column size="80"/>
                      <Column size="160"/>
                      <Column size="250"/>
                      <Column size="60"/>
                      <Column size="60"/>
                      <Column size="60"/>
                      <Column size="60"/>
                      <Column size="60"/>
                      <Column size="100"/>
                      <Column size="140"/>
                      <Column size="100"/>
                      <Column size="140"/>
                    </Columns>
                    <Rows>
                      <Row size="24" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="No"/>
                      <Cell col="1" text="Site ID" cssclass="cell_point"/>
                      <Cell col="2" text="공정수순" cssclass="cell_point"/>
                      <Cell col="3" text="공정코드" cssclass="cell_point" tooltiptext="PROCESSSEGMENTID"/>
                      <Cell col="4" text="공정명"/>
                      <Cell col="5" text="특이사항"/>
                      <Cell col="6" text="자재" tooltiptext="MATERIALCHANGETYPE"/>
                      <Cell col="7" text="공정SPEC"/>
                      <Cell col="8" text="치공구" tooltiptext="TOOLCHANGETYPE"/>
                      <Cell col="9" text="주차관리"/>
                      <Cell col="10" text="유효상태"/>
                      <Cell col="11" text="생성자"/>
                      <Cell col="12" text="생성일"/>
                      <Cell col="13" text="수정자"/>
                      <Cell col="14" text="수정일"/>
                    </Band>
                    <Band id="body">
                      <Cell text="expr:currow+1" textAlign="center" displaytype="number"/>
                      <Cell col="1" text="bind:PLANTID" textAlign="center" displaytype="combotext" edittype="expr:dataset.getRowType(currow) ==2 ? 'combo':'none'" combodataset="ds_factory" combocodecol="CODE" combodatacol="NAME"/>
                      <Cell col="2" text="bind:USERSEQUENCE" textAlign="right" displaytype="text" edittype="normal" editinputtype="number"/>
                      <Cell col="3" text="bind:PROCESSSEGMENTID" textAlign="center" displaytype="text" expandimage="url('theme://images/grd_expand.png')" expandshow="expr:dataset.getRowType(currow) ==2 ? 'show':'hide'" expandsize="24"/>
                      <Cell col="4" text="bind:PROCESSSEGMENTNAME" textAlign="left" displaytype="text"/>
                      <Cell col="5" text="bind:DESCRIPTION" textAlign="left" displaytype="text" edittype="normal"/>
                      <Cell col="6" text="bind:ISREQUIREDMATERIAL"/>
                      <Cell col="7" text="bind:ISREQUIREDOPERATIONSPEC"/>
                      <Cell col="8" text="bind:ISREQUIREDTOOL"/>
                      <Cell col="9" edittype="combo" combocodecol="C,YesNo,null,Y,Y" text="bind:ISWEEKMNG" displaytype="combotext"/>
                      <Cell col="10" text="bind:VALIDSTATE" edittype="combo" combocodecol="C,UsageStatus,,Y,Y" displaytype="combotext"/>
                      <Cell col="11" text="bind:CREATOR"/>
                      <Cell col="12" text="bind:CREATEDTIME" displaytype="text" calendardateformat="yyyy-MM-dd HH:mm:ss" calendareditformat="yyyy-MM-dd HH:mm:ss"/>
                      <Cell col="13" text="bind:MODIFIER"/>
                      <Cell col="14" text="bind:MODIFIEDTIME" displaytype="text" calendardateformat="yyyy-MM-dd HH:mm:ss" calendareditformat="yyyy-MM-dd HH:mm:ss"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Button id="btn_xlUpCustom_grd_operation" taborder="12" top="142" width="29" height="24" cssclass="btn_WF_grdExcelUp" tooltiptext="엑셀업로드" right="0" onclick="tab_work_Tabpage1_btn_xlUp_grd_basIdclass_onclick"/>
              <Button id="btn_xlDn_grd_operation" taborder="6" width="29" cssclass="btn_WF_grdExcelDown" tooltiptext="GridExport" initvalueid="x" height="24" bottom="grd_operation:0" right="btn_xlUpCustom_grd_operation:0"/>
              <Button id="btn_delOperation" taborder="4" width="29" height="24" cssclass="btn_WF_grdDel" tooltiptext="GridDelete" right="btn_xlDn_grd_operation:0" initvalueid="x" onclick="fn_deleteOperation" text="" bottom="grd_operation:0"/>
              <Button id="btn_addOperation" taborder="5" width="29" height="24" cssclass="btn_WF_grdAdd" tooltiptext="GridAdd" right="btn_delOperation:0" initvalueid="x" onclick="fn_addOperation" bottom="grd_operation:0" text=""/>
              <Static id="StaticTitleBOM" taborder="8" text="BOM 구조" left="0" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" width="230" tooltiptext="TREEROUNTING"/>
              <Div id="Div01" taborder="9" left="treeRouting:5" top="35" height="94" cssclass="div_WF_detail_line" text="" right="0">
                <Layouts>
                  <Layout>
                    <Static id="sta_00" taborder="7" text="고객사명" left="0" top="0" width="9%" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" tooltiptext="CUTOMERNAME"/>
                    <Edit id="edt_customerName" taborder="0" left="sta_00:1" top="7" height="20" text="IFV" cssclass="display" width="10%" readonly="true" enable="false"/>
                    <Static id="sta_03" taborder="8" text="품목코드" left="edt_customerName:0" top="0" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" width="9%" tooltiptext="PRODUCTDEFID"/>
                    <Edit id="edt_itemId" taborder="1" left="sta_03:5" top="7" height="20" text="1025362J1" cssclass="display" width="10%" readonly="true" enable="false"/>
                    <Static id="sta_04" taborder="9" text="Rev" left="edt_itemId:0" top="0" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" width="9%"/>
                    <Edit id="edt_itemRev" taborder="2" left="sta_04:5" top="7" height="20" text="FA1" cssclass="display" width="10%" readonly="true" enable="false"/>
                    <Static id="sta_07_00" taborder="10" text="품목명" left="edt_itemRev:0" top="0" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" width="9%" tooltiptext="ITEMNAME"/>
                    <Edit id="edt_itemName" taborder="3" left="sta_07_00:5" top="7" height="20" text="변경" cssclass="display" readonly="true" enable="false" right="0"/>
                    <Static id="sta_00_00" taborder="11" text="작업구분" left="0" top="31" width="9%" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" tooltiptext="JOBTYPE"/>
                    <Edit id="edt_jobType" taborder="4" left="sta_00:1" top="36" height="20" text="IFV" cssclass="display" width="10%" readonly="true" enable="false"/>
                    <Static id="sta_03_00" taborder="12" text="생산구분" left="edt_jobType:0" top="31" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" width="9%" tooltiptext="PRODUCTIONTYPE"/>
                    <Edit id="edt_productType" taborder="5" left="sta_03_00:5" top="36" height="20" text="1025362J1" cssclass="display" width="10%" readonly="true" enable="false"/>
                    <Static id="sta_04_00" taborder="13" text="RTR/SHEET" left="edt_productType:0" top="31" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" width="9%" tooltiptext="E4DA2FCD959342E4A46DA2A80F76FB42"/>
                    <Combo id="cbo_rtr" taborder="6" text="CCT" left="sta_04_00:0" top="36" height="20" index="1" value="" width="10.00%" codecolumn="C,RTRSHT,,Y,Y" cssclass="display"/>
                    <Static id="sta_07_00_00" taborder="14" text="PNL X" left="cbo_rtr:5" top="31" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" width="9%" tooltiptext="PANELX"/>
                    <Static id="sta_00_00_00" taborder="15" text="합수(PCS)" left="0" top="62" width="9%" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" tooltiptext="ARRAYPCS"/>
                    <Edit id="edt_pcspnl" taborder="23" left="sta_00_00_00:1" top="67" height="20" text="변경" readonly="false" enable="true" visible="true" width="10.00%" inputtype="number" cssclass="display"/>
                    <Static id="sta_03_00_00" taborder="16" text="산출수(PCS)" left="edt_pcspnl:0" top="62" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" width="9%" tooltiptext="CALCULATEPCS"/>
                    <Edit id="edt_pcsmm" taborder="22" left="sta_03_00_00:5" top="67" height="20" text="변경" readonly="false" enable="true" visible="true" width="10.00%" inputtype="number" cssclass="display"/>
                    <Static id="sta_04_00_00" taborder="17" text="사용층" left="edt_pcsmm:0" top="62" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" width="9%" visible="false" tooltiptext="USERLAYER"/>
                    <Combo id="cbo_layer" taborder="21" text="CCT" left="sta_04_00_00:0" top="68" height="20" index="1" value="" width="10%" codecolumn="C,Layer,null,Y,Y" visible="false" cssclass="display"/>
                    <Static id="sta_07_00_00_00" taborder="18" text="비고" left="cbo_layer:5" top="62" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" width="9%" visible="false" tooltiptext="REMARK"/>
                    <Edit id="edt_remark" taborder="19" left="sta_07_00_00_00:0" top="67" height="20" text="변경" readonly="false" enable="true" right="0" visible="false" cssclass="display"/>
                    <Edit id="edt_pnlX" taborder="24" left="sta_07_00_00:0" top="37" height="20" text="변경" readonly="false" enable="true" visible="true" width="10.00%" inputtype="number" cssclass="display"/>
                    <Static id="sta_07_00_00_01" taborder="20" text="PNL Y" left="edt_pnlX:5" top="31" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" width="10.94%" tooltiptext="PANELY"/>
                    <Edit id="edt_pnlY" taborder="25" left="sta_07_00_00_01:0" top="37" height="20" text="변경" readonly="false" enable="true" visible="true" width="10.00%" inputtype="number" cssclass="display"/>
                  </Layout>
                </Layouts>
              </Div>
              <Grid id="grd_operation00" taborder="13" left="730" right="114" autoenter="select" top="256" height="84" treeinitstatus="expand,null" binddataset="ds_operationExcel" visible="false">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="80"/>
                      <Column size="80"/>
                      <Column size="80"/>
                      <Column size="80"/>
                      <Column size="80"/>
                      <Column size="80"/>
                      <Column size="80"/>
                      <Column size="80"/>
                      <Column size="80"/>
                    </Columns>
                    <Rows>
                      <Row band="head" size="24"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="PLANTID"/>
                      <Cell col="1" text="USERSEQUENCE"/>
                      <Cell col="2" text="PROCESSSEGMENTID"/>
                      <Cell col="3" text="PROCESSSEGMENTNAME"/>
                      <Cell col="4" text="DESCRIPTION"/>
                      <Cell col="5" text="ISREQUIREDMATERIAL"/>
                      <Cell col="6" text="ISREQUIREDOPERATIONSPEC"/>
                      <Cell col="7" text="ISREQUIREDTOOL"/>
                      <Cell col="8" text="VALIDSTATE"/>
                    </Band>
                    <Band id="body">
                      <Cell text="bind:PLANTID"/>
                      <Cell col="1" text="bind:USERSEQUENCE"/>
                      <Cell col="2" text="bind:PROCESSSEGMENTID"/>
                      <Cell col="3" text="bind:PROCESSSEGMENTNAME"/>
                      <Cell col="4" text="bind:DESCRIPTION"/>
                      <Cell col="5" text="bind:ISREQUIREDMATERIAL"/>
                      <Cell col="6" text="bind:ISREQUIREDOPERATIONSPEC"/>
                      <Cell col="7" text="bind:ISREQUIREDTOOL"/>
                      <Cell col="8" text="bind:VALIDSTATE"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_header" taborder="3" left="0" top="0" height="47" right="0" formscrolltype="both">
          <Layouts>
            <Layout>
              <Static id="Static01" taborder="7" left="0" top="0" cssclass="sta_WF_titleBG" right="0" bottom="0"/>
              <Button id="btn_reset" taborder="0" top="16" width="26" height="24" cssclass="btn_com_reset" right="3" tooltiptext="Toolbar_Initialization" text="" initvalueid="x"/>
              <Button id="btn_help" taborder="1" top="16" width="26" height="24" cssclass="btn_com_help" right="btn_reset:0" tooltiptext="MANUAL" initvalueid="x"/>
              <Button id="btn_saveArea" taborder="2" top="16" width="26" height="24" cssclass="btn_com_save" right="btn_help:0" tooltiptext="Toolbar_Save" initvalueid="x" onclick="fn_save"/>
              <Static id="sta_title" taborder="4" text="ROUTING" left="30" top="16" width="100" height="24" cssclass="sta_WF_title" fittocontents="width" expr="nexacro.getApplication().gds_menu.lookup(&quot;PGM_ID&quot;,comp.parent.parent.parent.name,&quot;MENU_NM&quot;)"/>
              <Button id="btn_favorite" taborder="3" left="sta_title:10" top="16" width="24" height="24" cssclass="btn_WF_favorite"/>
              <Button id="btn_searchOpen" taborder="5" left="0" top="16" width="30" height="24" cssclass="btn_WF_searchOpen" onclick="nfn_searchOpen_onclick"/>
              <Static id="Static16" taborder="6" left="47" top="0" width="60" height="20" cssclass="guideTip" visible="false" text="h20"/>
              <Button id="btn_genNumber" taborder="10" text="공정 수순 채번" top="16" width="100" height="24" cssclass="btn_com_basic" right="btn_saveArea:25" fittocontents="width" onclick="fn_genNumber" tooltiptext="Toolbar_RoutingSegmentSequence"/>
              <Button id="btn_warehouse" taborder="9" text="완료창고" top="16" width="80" height="24" cssclass="btn_com_basic" right="btn_genNumber:5" fittocontents="width" onclick="fn_warehouse" tooltiptext="Toolbar_SetWarehouse"/>
              <Button id="btn_copyRouting" taborder="8" text="Routing 복사" top="16" width="90" height="24" cssclass="btn_com_basic" right="btn_warehouse:5" fittocontents="width" onclick="fn_copyProduct"/>
            </Layout>
          </Layouts>
        </Div>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_tree" canrowposchange="ds_tree_canrowposchange">
        <ColumnInfo>
          <Column id="ASSEMBLYITEMNAME" type="STRING" size="32"/>
          <Column id="DISPLAYNAME" type="STRING" size="32"/>
          <Column id="USERSEQUENCE" type="BIGDECIMAL" size="16"/>
          <Column id="PARENTBOMSEQUENCE" type="STRING" size="32"/>
          <Column id="ASSEMBLYQTY" type="BIGDECIMAL" size="16"/>
          <Column id="BOMSEQUENCE" type="STRING" size="32"/>
          <Column id="ASSEMBLYITEMID" type="STRING" size="32"/>
          <Column id="PARENTBOMID" type="STRING" size="32"/>
          <Column id="MASTERDATACLASSID" type="STRING" size="32"/>
          <Column id="ASSEMBLYTYPE" type="STRING" size="32"/>
          <Column id="ASSEMBLYITEMVERSION" type="STRING" size="32"/>
          <Column id="BOMID" type="STRING" size="32"/>
          <Column id="PLANTID" type="STRING" size="32"/>
          <Column id="ASSEMBLYSEQUENCE" type="BIGDECIMAL" size="16"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search">
        <ColumnInfo>
          <Column id="ENTERPRISEID" type="STRING" size="256"/>
          <Column id="PLANTID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFTYPE" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNM" type="STRING" size="256"/>
          <Column id="VALIDSTATE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="PRODUCTDEFTYPE"/>
            <Col id="PRODUCTDEFID"/>
            <Col id="PRODUCTDEFVERSION"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_productDef">
        <ColumnInfo>
          <Column id="CUSTOMERNAME" type="STRING" size="256"/>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="PRODUCTDEFCLASSID" type="STRING" size="256"/>
          <Column id="COMPLETIONWAREHOUSEID" type="STRING" size="256"/>
          <Column id="WAREHOUSENAME" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNAME" type="STRING" size="256"/>
          <Column id="UOMDEFID" type="STRING" size="256"/>
          <Column id="JOBTYPE" type="STRING" size="256"/>
          <Column id="JOBTYPENAME" type="STRING" size="256"/>
          <Column id="PRODUCTIONTYPE" type="STRING" size="256"/>
          <Column id="PRODUCTIONTYPENAME" type="STRING" size="256"/>
          <Column id="RTRSHT" type="STRING" size="256"/>
          <Column id="PNLSIZEXAXIS" type="STRING" size="256"/>
          <Column id="PNLSIZEYAXIS" type="STRING" size="256"/>
          <Column id="PCSPNL" type="STRING" size="256"/>
          <Column id="PCSMM" type="STRING" size="256"/>
          <Column id="USELAYER" type="STRING" size="256"/>
          <Column id="REMARK" type="STRING" size="256"/>
          <Column id="VALIDSTATE" type="STRING" size="256"/>
          <Column id="MASTERITEMID" type="STRING" size="256"/>
          <Column id="MASTERITEMVERSION" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_operation" useclientlayout="true" canrowposchange="ds_operation_canrowposchange" oncolumnchanged="ds_operation_oncolumnchanged" onrowposchanged="ds_operation_onrowposchanged" cancolumnchange="ds_operation_cancolumnchange">
        <ColumnInfo>
          <Column id="PLANTID" type="STRING" size="256"/>
          <Column id="OPERATIONID" type="STRING" size="256"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256"/>
          <Column id="ORIUSERSEQUENCE" type="STRING" size="256"/>
          <Column id="USERSEQUENCE" type="INT" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="PROCESSUOM" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTNAME" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTCLASSID" type="STRING" size="256"/>
          <Column id="DESCRIPTION" type="STRING" size="256"/>
          <Column id="ISREQUIREDMATERIAL" type="STRING" size="256"/>
          <Column id="ISREQUIREDOPERATIONSPEC" type="STRING" size="256"/>
          <Column id="ISREQUIREDTOOL" type="STRING" size="256"/>
          <Column id="VALIDSTATE" type="STRING" size="256"/>
          <Column id="CREATEDTIME" type="STRING" size="256"/>
          <Column id="CREATOR" type="STRING" size="256"/>
          <Column id="MODIFIEDTIME" type="STRING" size="256"/>
          <Column id="MODIFIER" type="STRING" size="256"/>
          <Column id="ISWEEKMNG" type="STRING" size="256"/>
          <Column id="MAINPRODUCTID" type="STRING" size="256"/>
          <Column id="MAINPRODUCTVERSION" type="STRING" size="256"/>
          <Column id="SUBSEGMENTID" type="STRING" size="0"/>
          <Column id="ASSEMBLYROUTINGID" type="STRING" size="256"/>
          <Column id="VERSIONSTATE" type="STRING" size="256"/>
          <Column id="PROCESSDEFTYPE" type="STRING" size="256"/>
          <Column id="PATHTYPE" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTTYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_factory">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_consumable" useclientlayout="true" oncolumnchanged="ds_consumable_oncolumnchanged">
        <ColumnInfo>
          <Column id="PLANTID" type="STRING" size="256"/>
          <Column id="COMPONENTITEMID" type="STRING" size="256"/>
          <Column id="COMPONENTITEMVERSION" type="STRING" size="256"/>
          <Column id="COMPONENTITEMNAME" type="STRING" size="256"/>
          <Column id="COMPONENTUOM" type="STRING" size="256"/>
          <Column id="SUMQTY" type="STRING" size="256"/>
          <Column id="COMPONENTQTY" type="STRING" size="256"/>
          <Column id="WIPSUPPLYTYPE" type="STRING" size="256"/>
          <Column id="USERLAYER" type="STRING" size="256"/>
          <Column id="ISREQUIREDMATERIAL" type="STRING" size="256"/>
          <Column id="ISALTERABLE" type="STRING" size="256"/>
          <Column id="MATERIALTYPE" type="STRING" size="256"/>
          <Column id="SEQ" type="STRING" size="256"/>
          <Column id="CREATOR" type="STRING" size="256"/>
          <Column id="CREATEDTIME" type="STRING" size="256"/>
          <Column id="MODIFIER" type="STRING" size="256"/>
          <Column id="MODIFIEDTIME" type="STRING" size="256"/>
          <Column id="BOMFORMULAID" type="STRING" size="256"/>
          <Column id="VARIABLE1" type="STRING" size="256"/>
          <Column id="VARIABLE2" type="STRING" size="256"/>
          <Column id="VARIABLE3" type="STRING" size="256"/>
          <Column id="VARIABLE4" type="STRING" size="256"/>
          <Column id="VARIABLE5" type="STRING" size="256"/>
          <Column id="MAKER" type="STRING" size="256"/>
          <Column id="SPEC" type="STRING" size="256"/>
          <Column id="MATERIALDETAILTYPE" type="STRING" size="256"/>
          <Column id="INKTYPE" type="STRING" size="256"/>
          <Column id="WORKMETHOD" type="STRING" size="256"/>
          <Column id="DESCRIPTION" type="STRING" size="256"/>
          <Column id="MULTIPLE" type="STRING" size="256"/>
          <Column id="ALTITEM" type="STRING" size="256"/>
          <Column id="ALTREVISION" type="STRING" size="256"/>
          <Column id="COMPONENTSEQUENCE" type="STRING" size="256"/>
          <Column id="COMPONENTBOMID" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="OPERATIONID" type="STRING" size="256"/>
          <Column id="ISEDITABLE1" type="STRING" size="0"/>
          <Column id="ISEDITABLE2" type="STRING" size="256"/>
          <Column id="ISEDITABLE3" type="STRING" size="256"/>
          <Column id="ISEDITABLE4" type="STRING" size="256"/>
          <Column id="ISEDITABLE5" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTVERSION" type="STRING" size="256"/>
          <Column id="PSRPRINTTYPE" type="STRING" size="256"/>
          <Column id="USERSEQUENCE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_operationSpec" onrowposchanged="ds_operationSpec_onrowposchanged" useclientlayout="true" oncolumnchanged="ds_operationSpec_oncolumnchanged">
        <ColumnInfo>
          <Column id="SPECSEQUENCE" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="INSPITEMID" type="STRING" size="256"/>
          <Column id="INSPITEMVERSION" type="STRING" size="256"/>
          <Column id="INSPECTIONDEFID" type="STRING" size="256"/>
          <Column id="INSPECTIONDEFVERSION" type="STRING" size="256"/>
          <Column id="RESOURCETYPE" type="STRING" size="256"/>
          <Column id="INSPITEMNAME" type="STRING" size="256"/>
          <Column id="SPECCLASSID" type="STRING" size="256"/>
          <Column id="LOCATION" type="STRING" size="256"/>
          <Column id="DEFAULTCHARTTYPE" type="STRING" size="256"/>
          <Column id="LCL" type="STRING" size="256"/>
          <Column id="CL" type="STRING" size="256"/>
          <Column id="UCL" type="STRING" size="256"/>
          <Column id="LSL" type="STRING" size="256"/>
          <Column id="SL" type="STRING" size="256"/>
          <Column id="USL" type="STRING" size="256"/>
          <Column id="LOL" type="STRING" size="256"/>
          <Column id="UOL" type="STRING" size="256"/>
          <Column id="CREATOR" type="STRING" size="256"/>
          <Column id="CREATEDTIME" type="STRING" size="256"/>
          <Column id="MODIFIER" type="STRING" size="256"/>
          <Column id="MODIFIEDTIME" type="STRING" size="256"/>
          <Column id="RESOURCEID" type="STRING" size="256"/>
          <Column id="RESOURCEVERSION" type="STRING" size="256"/>
          <Column id="COPPERTHICKNESS" type="STRING" size="256"/>
          <Column id="OSL" type="STRING" size="256"/>
          <Column id="OUSL" type="STRING" size="256"/>
          <Column id="OLSL" type="STRING" size="256"/>
          <Column id="SPECTRANSTYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_durable" useclientlayout="true">
        <ColumnInfo>
          <Column id="TOOLCODE" type="STRING" size="256"/>
          <Column id="TOOLNAME" type="STRING" size="256"/>
          <Column id="TOOLVERSION" type="STRING" size="256"/>
          <Column id="FILMUSELAYER1" type="STRING" size="256"/>
          <Column id="FILMUSELAYER2" type="STRING" size="256"/>
          <Column id="FILMUSELAYER1NAME" type="STRING" size="256"/>
          <Column id="FILMUSELAYER2NAME" type="STRING" size="256"/>
          <Column id="DESCRIPTION" type="STRING" size="256"/>
          <Column id="DURABLETYPE" type="STRING" size="256"/>
          <Column id="RESOURCETYPE" type="STRING" size="256"/>
          <Column id="EQUIPMENTID" type="STRING" size="256"/>
          <Column id="RESOURCECLASSID" type="STRING" size="256"/>
          <Column id="SEQ" type="STRING" size="256"/>
          <Column id="CREATOR" type="STRING" size="256"/>
          <Column id="CREATEDTIME" type="STRING" size="256"/>
          <Column id="MODIFIER" type="STRING" size="256"/>
          <Column id="MODIFIEDTIME" type="STRING" size="256"/>
          <Column id="OPERATIONID" type="STRING" size="256"/>
          <Column id="TOOLTYPE" type="STRING" size="256"/>
          <Column id="TOOLDETAILTYPE" type="STRING" size="256"/>
          <Column id="FORM" type="STRING" size="256"/>
          <Column id="HITCOUNT" type="STRING" size="256"/>
          <Column id="SUMMARY" type="STRING" size="256"/>
          <Column id="WRAPTYPE" type="STRING" size="256"/>
          <Column id="DURABLECLASSID" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTCLASSID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNAME" type="STRING" size="256"/>
          <Column id="RESOURCEID" type="STRING" size="256"/>
          <Column id="OPERATIONRESOURCEID" type="STRING" size="256"/>
          <Column id="MAINPRODUCTID" type="STRING" size="256"/>
          <Column id="MAINPRODUCTVERSION" type="STRING" size="256"/>
          <Column id="VALIDSTATE" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTVERSION" type="STRING" size="256"/>
          <Column id="RESOURCEVERSION" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_aoiLayer" onrowposchanged="ds_operationSpec_onrowposchanged" useclientlayout="true">
        <ColumnInfo>
          <Column id="OPERATIONID" type="STRING" size="256"/>
          <Column id="ENTERPRISEID" type="STRING" size="256"/>
          <Column id="PLANTID" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="AOIQCLAYER" type="STRING" size="256"/>
          <Column id="AOIQCLAYER2" type="STRING" size="256"/>
          <Column id="DESCRIPTION" type="STRING" size="256"/>
          <Column id="VALIDSTATE" type="STRING" size="256"/>
          <Column id="SEQUENCE" type="STRING" size="256"/>
          <Column id="CREATEDTIME" type="STRING" size="256"/>
          <Column id="CREATOR" type="STRING" size="256"/>
          <Column id="MODIFIEDTIME" type="STRING" size="256"/>
          <Column id="MODIFIER" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_uom">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_checkLot">
        <ColumnInfo>
          <Column id="LOTID" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bom">
        <ColumnInfo>
          <Column id="ID" type="STRING" size="256"/>
          <Column id="MATERIALTYPE" type="STRING" size="256"/>
          <Column id="DEFAULTVAR1" type="FLOAT" size="256"/>
          <Column id="ISEDITABLE1" type="STRING" size="256"/>
          <Column id="DEFAULTVAR2" type="FLOAT" size="256"/>
          <Column id="ISEDITABLE2" type="STRING" size="256"/>
          <Column id="DEFAULTVAR3" type="FLOAT" size="256"/>
          <Column id="ISEDITABLE3" type="STRING" size="256"/>
          <Column id="DEFAULTVAR4" type="FLOAT" size="256"/>
          <Column id="ISEDITABLE4" type="STRING" size="256"/>
          <Column id="DEFAULTVAR5" type="FLOAT" size="256"/>
          <Column id="ISEDITABLE5" type="STRING" size="256"/>
          <Column id="FORMULA" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="ID">BOM_P_0000001</Col>
            <Col id="DEFAULTVAR1">365</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="DEFAULTVAR2">3</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="DEFAULTVAR4">1</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3 / v4</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000002</Col>
            <Col id="DEFAULTVAR1">365</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="DEFAULTVAR2">3</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="DEFAULTVAR4">1</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3 / v4</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000003</Col>
            <Col id="DEFAULTVAR1">365</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="DEFAULTVAR2">3</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="DEFAULTVAR4">1</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3 / v4</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000004</Col>
            <Col id="DEFAULTVAR1">365</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="DEFAULTVAR2">0</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="DEFAULTVAR4">1</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3 / v4</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000005</Col>
            <Col id="DEFAULTVAR1">1</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="DEFAULTVAR5">0</Col>
            <Col id="ISEDITABLE5">true</Col>
            <Col id="FORMULA">v1 / v5</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000006</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3 / v4</Col>
            <Col id="MATERIALTYPE">Product</Col>
            <Col id="DEFAULTVAR1">365</Col>
            <Col id="DEFAULTVAR2">3</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="DEFAULTVAR4">1</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000007</Col>
            <Col id="DEFAULTVAR1">1</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000008</Col>
            <Col id="DEFAULTVAR1">1</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="DEFAULTVAR5">0</Col>
            <Col id="ISEDITABLE5">true</Col>
            <Col id="FORMULA">v1 / v5</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000009</Col>
            <Col id="DEFAULTVAR1">1</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000010</Col>
            <Col id="DEFAULTVAR1">1</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="DEFAULTVAR5">0</Col>
            <Col id="ISEDITABLE5">true</Col>
            <Col id="FORMULA">v1 / v5</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000011</Col>
            <Col id="DEFAULTVAR1">1</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000012</Col>
            <Col id="DEFAULTVAR1">1</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000013</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000014</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000015</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">보류</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000016</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000017</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000018</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000019</Col>
            <Col id="DEFAULTVAR1">7000</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="DEFAULTVAR5">0.03</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 * v5 * 0.01 * 0.0001 * 19.32 * 100 / 68.1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000020</Col>
            <Col id="DEFAULTVAR1">7000</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="DEFAULTVAR5">0.1</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 * v5 * 0.01 * 0.0001 * 19.32 * 100 / 68.1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000021</Col>
            <Col id="DEFAULTVAR1">7000</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="DEFAULTVAR5">0.5</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 * v5 * 0.01 * 0.0001 * 19.32 * 100 / 68.1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000022</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000023</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1 / v3</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_P_0000024</Col>
            <Col id="DEFAULTVAR1">1</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="DEFAULTVAR3">392</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1</Col>
            <Col id="MATERIALTYPE">Product</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000001</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">365</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="DEFAULTVAR2">4</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="DEFAULTVAR3">1</Col>
            <Col id="ISEDITABLE3">true</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000002</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">365</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="DEFAULTVAR2">4</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="ISEDITABLE3">true</Col>
            <Col id="DEFAULTVAR3">1</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000003</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">1</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="DEFAULTVAR4">0</Col>
            <Col id="FORMULA">v1 / v4</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000004</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">365</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="DEFAULTVAR2">5</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="ISEDITABLE3">true</Col>
            <Col id="DEFAULTVAR3">1</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000005</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="DEFAULTVAR2">5</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="ISEDITABLE3">true</Col>
            <Col id="DEFAULTVAR3">1</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000006</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="DEFAULTVAR2">5</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="ISEDITABLE3">true</Col>
            <Col id="DEFAULTVAR3">1</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000007</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">1</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">v1</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000008</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">365</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="DEFAULTVAR2">4</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="ISEDITABLE3">true</Col>
            <Col id="DEFAULTVAR3">1</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000009</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">365</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="DEFAULTVAR2">7</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="ISEDITABLE3">true</Col>
            <Col id="DEFAULTVAR3">1</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000010</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="DEFAULTVAR2">3</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="ISEDITABLE3">true</Col>
            <Col id="DEFAULTVAR3">2</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">true</Col>
            <Col id="DEFAULTVAR4">0</Col>
            <Col id="DEFAULTVAR5">0</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3 / v4 / v5</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000011</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="DEFAULTVAR2">3</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="ISEDITABLE3">true</Col>
            <Col id="DEFAULTVAR3">2</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">true</Col>
            <Col id="DEFAULTVAR4">0</Col>
            <Col id="DEFAULTVAR5">0</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3 / v4 / v5</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000012</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">보류</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000013</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="DEFAULTVAR2">4</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="DEFAULTVAR4">0</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v4</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000014</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="DEFAULTVAR2">3</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000015</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="DEFAULTVAR2">3</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="DEFAULTVAR4">0</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v4</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000016</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">0.00257</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="ISEDITABLE3">false</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="DEFAULTVAR4">0</Col>
            <Col id="FORMULA">v1 / v3</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000017</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">1</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="ISEDITABLE3">true</Col>
            <Col id="DEFAULTVAR3">0</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="DEFAULTVAR4">0</Col>
            <Col id="FORMULA">v1 / v3 / v4</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000018</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="ISEDITABLE3">true</Col>
            <Col id="DEFAULTVAR3">2</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="DEFAULTVAR4">0</Col>
            <Col id="FORMULA">v1 / 1000 / v4 / v3</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000019</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">0</Col>
            <Col id="ISEDITABLE1">true</Col>
            <Col id="DEFAULTVAR2">3</Col>
            <Col id="ISEDITABLE2">true</Col>
            <Col id="ISEDITABLE3">true</Col>
            <Col id="DEFAULTVAR3">0</Col>
            <Col id="ISEDITABLE4">false</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="FORMULA">(v1 + v2) / 1000 / v3</Col>
          </Row>
          <Row>
            <Col id="ID">BOM_SA_0000020</Col>
            <Col id="MATERIALTYPE">SubAssembly</Col>
            <Col id="DEFAULTVAR1">365</Col>
            <Col id="ISEDITABLE1">false</Col>
            <Col id="ISEDITABLE2">false</Col>
            <Col id="ISEDITABLE3">true</Col>
            <Col id="DEFAULTVAR3">0</Col>
            <Col id="ISEDITABLE4">true</Col>
            <Col id="ISEDITABLE5">false</Col>
            <Col id="DEFAULTVAR4">0</Col>
            <Col id="FORMULA">v1 / 1000 / v4 / v3</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_bomList">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_operationExcel" useclientlayout="true">
        <ColumnInfo>
          <Column id="PLANTID" type="STRING" size="256"/>
          <Column id="USERSEQUENCE" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTNAME" type="STRING" size="256"/>
          <Column id="DESCRIPTION" type="STRING" size="256"/>
          <Column id="ISREQUIREDMATERIAL" type="STRING" size="256"/>
          <Column id="ISREQUIREDOPERATIONSPEC" type="STRING" size="256"/>
          <Column id="ISREQUIREDTOOL" type="STRING" size="256"/>
          <Column id="VALIDSTATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_operationExcelOut" useclientlayout="true">
        <ColumnInfo>
          <Column id="PLANTID" type="STRING" size="256"/>
          <Column id="OPERATIONID" type="STRING" size="256"/>
          <Column id="OPERATIONSEQUENCE" type="STRING" size="256"/>
          <Column id="ORIUSERSEQUENCE" type="STRING" size="256"/>
          <Column id="USERSEQUENCE" type="INT" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="PROCESSUOM" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTNAME" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTCLASSID" type="STRING" size="256"/>
          <Column id="DESCRIPTION" type="STRING" size="256"/>
          <Column id="ISREQUIREDMATERIAL" type="STRING" size="256"/>
          <Column id="ISREQUIREDOPERATIONSPEC" type="STRING" size="256"/>
          <Column id="ISREQUIREDTOOL" type="STRING" size="256"/>
          <Column id="VALIDSTATE" type="STRING" size="256"/>
          <Column id="CREATEDTIME" type="STRING" size="256"/>
          <Column id="CREATOR" type="STRING" size="256"/>
          <Column id="MODIFIEDTIME" type="STRING" size="256"/>
          <Column id="MODIFIER" type="STRING" size="256"/>
          <Column id="ISWEEKMNG" type="STRING" size="256"/>
          <Column id="MAINPRODUCTID" type="STRING" size="256"/>
          <Column id="MAINPRODUCTVERSION" type="STRING" size="256"/>
          <Column id="SUBSEGMENTID" type="STRING" size="0"/>
          <Column id="ASSEMBLYROUTINGID" type="STRING" size="256"/>
          <Column id="VERSIONSTATE" type="STRING" size="256"/>
          <Column id="PROCESSDEFTYPE" type="STRING" size="256"/>
          <Column id="PATHTYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_resultDurable" firefirstcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DURABLECLASSTYPE" type="STRING" size="256"/>
          <Column id="DURABLETYPENAME" type="STRING" size="256"/>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNAME" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="TOOLCODE" type="STRING" size="256"/>
          <Column id="DURABLEDEFID" type="STRING" size="256"/>
          <Column id="DURABLEDEFVERSION" type="STRING" size="256"/>
          <Column id="DURABLEDEFNAME" type="STRING" size="256"/>
          <Column id="FILMUSELAYER1" type="STRING" size="256"/>
          <Column id="FILMUSELAYER2" type="STRING" size="256"/>
          <Column id="FILMUSELAYER1NAME" type="STRING" size="256"/>
          <Column id="FILMUSELAYER2NAME" type="STRING" size="256"/>
          <Column id="DURABLECLASSID" type="STRING" size="256"/>
          <Column id="TOOLTYPE" type="STRING" size="256"/>
          <Column id="TOOLDETAILTYPE" type="STRING" size="256"/>
          <Column id="FORM" type="STRING" size="256"/>
          <Column id="SUMMARY" type="STRING" size="256"/>
          <Column id="HITCOUNT" type="STRING" size="256"/>
          <Column id="DURABLETYPE" type="STRING" size="256"/>
          <Column id="DURABLECLASSNAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_spec">
        <ColumnInfo>
          <Column id="VAL13_1" type="STRING" size="256"/>
          <Column id="VAL13_2" type="STRING" size="256"/>
          <Column id="VAL14_1" type="STRING" size="256"/>
          <Column id="VAL14_2" type="STRING" size="256"/>
          <Column id="VAL15_1" type="STRING" size="256"/>
          <Column id="VAL15_2" type="STRING" size="256"/>
          <Column id="VAL3" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_productDefMaster">
        <ColumnInfo>
          <Column id="CUSTOMERNAME" type="STRING" size="256"/>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="PRODUCTDEFCLASSID" type="STRING" size="256"/>
          <Column id="COMPLETIONWAREHOUSEID" type="STRING" size="256"/>
          <Column id="WAREHOUSENAME" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNAME" type="STRING" size="256"/>
          <Column id="UOMDEFID" type="STRING" size="256"/>
          <Column id="JOBTYPE" type="STRING" size="256"/>
          <Column id="JOBTYPENAME" type="STRING" size="256"/>
          <Column id="PRODUCTIONTYPE" type="STRING" size="256"/>
          <Column id="PRODUCTIONTYPENAME" type="STRING" size="256"/>
          <Column id="RTRSHT" type="STRING" size="256"/>
          <Column id="PNLSIZEXAXIS" type="STRING" size="256"/>
          <Column id="PNLSIZEYAXIS" type="STRING" size="256"/>
          <Column id="PCSPNL" type="STRING" size="256"/>
          <Column id="PCSMM" type="STRING" size="256"/>
          <Column id="USELAYER" type="STRING" size="256"/>
          <Column id="REMARK" type="STRING" size="256"/>
          <Column id="VALIDSTATE" type="STRING" size="256"/>
          <Column id="MASTERITEMID" type="STRING" size="256"/>
          <Column id="MASTERITEMVERSION" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_checkAOI" useclientlayout="true">
        <ColumnInfo>
          <Column id="INPUTCNT" type="STRING" size="256"/>
          <Column id="AOICNT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_aoiLayerCheck" onrowposchanged="ds_operationSpec_onrowposchanged" useclientlayout="true">
        <ColumnInfo>
          <Column id="OPERATIONID" type="STRING" size="256"/>
          <Column id="ENTERPRISEID" type="STRING" size="256"/>
          <Column id="PLANTID" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="AOIQCLAYER" type="STRING" size="256"/>
          <Column id="AOIQCLAYER2" type="STRING" size="256"/>
          <Column id="DESCRIPTION" type="STRING" size="256"/>
          <Column id="VALIDSTATE" type="STRING" size="256"/>
          <Column id="SEQUENCE" type="STRING" size="256"/>
          <Column id="CREATEDTIME" type="STRING" size="256"/>
          <Column id="CREATOR" type="STRING" size="256"/>
          <Column id="MODIFIEDTIME" type="STRING" size="256"/>
          <Column id="MODIFIER" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_checkNow" useclientlayout="true">
        <ColumnInfo>
          <Column id="LOTID" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_checkNowParam" useclientlayout="true">
        <ColumnInfo>
          <Column id="ITEMID" type="STRING" size="256"/>
          <Column id="ITEMVERSION" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="USERSEQUENCE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_checkWeek" useclientlayout="true">
        <ColumnInfo>
          <Column id="INPUTCNT" type="STRING" size="256"/>
          <Column id="WEEKCNT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_checkUser">
        <ColumnInfo>
          <Column id="USER_ID" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.1"><![CDATA[/***************************************************************************************
 * 시스템명 	: IFC MES시스템
 * 업무명 		: ROUTING
 * 파일명 		: BAS02100M.xfdl
 * 작성자 		: 최성민
 * 작성일 		: 2021.03.08
 *
 * 설  명		: 기준관리 - ROUTING
 *---------------------------------------------------------------------------------------
 * 변경일		변경자		변경내역
 *---------------------------------------------------------------------------------------
 * 2021.03.08	최성민   	최초작성
 *---------------------------------------------------------------------------------------
 ****************************************************************************************/

/**************************************************************************
 * 1. 필수 include
 ***************************************************************************/
include "lib::lib_bas.xjs";	//기준관리 공통 라이브러리 include
/**************************************************************************
 * 2. FORM 변수 선언 영역
 ***************************************************************************/
 this.searchDiv1 = this.tab_search.Tabpage1.form;
 this.g_positionTree; 	//저장 후 위치고정을 위한 전역변수
 this.g_positionGrid; 	//저장 후 위치고정을 위한 전역변수
 this.g_positionA; 		//저장 후 위치고정을 위한 전역변수
 this.g_init = true;
/**************************************************************************
 * 3. FORM LOAD
 ***************************************************************************/
this.fn_init = function (obj:Form, e:nexacro.LoadEventInfo)
{
	this.nfn_formInit(obj);		
	this.fn_comboInit();
	this.fn_formInit();
	this.basfn_saveBtn(this.div_header.form.btn_saveArea); //저장버튼 공통처리 함수 호출
	
	//공정그리드 이벤트 제거
	this.basfn_removeEventGrid(this.div_work.form.grd_operation);	
};

/**************************************************************************
 * 4. 공통버튼영역 (함수 삭제금지!!!!)
 ***************************************************************************/
this.fn_save = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{

	if(this.ds_productDef.rowcount < 1){
		this.gfn_Message("NoSaveData", "", "warning", "ok");
		return;
	}
	
	if(this.nfn_isNull(this.ds_productDef.getColumn(0, "PRODUCTDEFID"))){
		this.gfn_Message("NoSaveData", "", "warning", "ok");
		return;
	}
	
	//공정수순/공정ID 중복값 체크
	this.ds_operation.set_enableevent(false);
	this.ds_operation.filter("VALIDSTATE=='Valid'");
	if(!this.basfn_checkGridDup(this.ds_operation
								, "USERSEQUENCE|PROCESSSEGMENTID"
								, "DuplicationUserSequence|DuplicationSegmentID")){ 
		this.ds_operation.filter("");
		this.ds_operation.set_enableevent(true);
		return;
	} else {
		this.ds_operation.filter("");
	}
	this.ds_operation.set_enableevent(true);
	
	
	/* 그리드 필수체크 */
	var componentA = this.div_work.form.grd_operation;
	var componentB = this.div_work.form.tab_00.Tabpage1.form.grd_consumable;	
	var componentC = this.div_work.form.tab_00.Tabpage3.form.grd_durable;	
	var componentD = this.div_work.form.tab_00.Tabpage2.form.grd_operationSpec;	
	
	var strColIdListA = "PLANTID,USERSEQUENCE,PROCESSSEGMENTID";		
	var strColIdListB = "COMPONENTITEMID,WIPSUPPLYTYPE";		
	var strColIdListC = "TOOLCODE";			
	var strColIdListD = "INSPITEMNAME";			

	/* 공정 그리드 체크 */	
	if(!this.nfn_MandatoryCheckGrid(componentA, strColIdListA)) return;
	
	if(!this.nfn_MandatoryCheckGrid(componentD, strColIdListD)) return;
	
	/* 자재 그리드 체크 */	
	if(!this.nfn_MandatoryCheckGrid(componentB, strColIdListB)) {
		this.div_work.form.tab_00.set_tabindex(0);
		return;
	}
	

	
	if(!this.nfn_MandatoryCheckGrid(componentC, strColIdListC)) {
		this.div_work.form.tab_00.set_tabindex(2);
		return;
	}
	
	//자재 그리드 중복값 체크
	if(!this.basfn_checkGridDup(this.ds_consumable
								, "COMPONENTITEMID"
								, "DuplicationConsumableID")){ return;}
	//공정Spec 그리드 중복값 체크
	if(!this.basfn_checkGridDup(this.ds_operationSpec
								, "INSPITEMID"
								, "DuplicationInspectionItemID")){ return;}	
								
	
	//치공구 그리드 중복값 체크	
	for(var i=0; i <this.ds_durable.rowcount; i++){		
		if(this.ds_durable.getRowType(i) == 2 || this.ds_durable.getRowType(i) == 4){
			var toolCode 	= this.ds_durable.getColumn(i, "TOOLCODE");
			var toolVersion = this.ds_durable.getColumn(i, "TOOLVERSION");
			
			var chkCnt = this.ds_durable.getCaseCount("TOOLCODE=='" + toolCode +"' && TOOLVERSION=='" +toolVersion+"'");
			if(chkCnt>1){
				this.gfn_Message("DuplicatedDurable",toolCode+"/"+toolVersion , "warning", "ok");								
				return false;
			}
		}
	}
	
	//제품상세정보에 컬럼 Update (As-Is)
	this.ds_productDef.setColumn(0, "PROCESSDEFTYPE", "Main");
	this.ds_productDef.setColumn(0, "VERSIONSTATE", "Active");
	this.ds_productDef.setColumn(0, "VALIDSTATE", "Valid");
	
	this.g_positionTree = this.ds_tree.rowposition;
	this.g_positionGrid = this.div_work.form.treeRouting.getSelectedRows();	
	this.g_positionA = this.ds_operation.rowposition;
	
	var productDefId		= this.ds_productDef.getColumn(0, "PRODUCTDEFID");
	var productDefVersion	= this.ds_productDef.getColumn(0, "PRODUCTDEFVERSION");
	var defaultCharType 	= this.div_work.form.tab_00.Tabpage2.form.cbo_barcharinfo.value;	

	for(var i=0; i<this.ds_productDef.rowcount; i++){
		this.ds_productDef.setColumn(i,"VALIDSATE", "Valid");		
		this.ds_productDef.setColumn(i,"VERSIONSTATE", "Active");		
		this.ds_productDef.setColumn(i,"PROCESSDEFTYPE", "Main");		
		this.ds_productDef.setColumn(i,"PATHTYPE", "StartEnd");		
		this.ds_productDef.setColumn(i,"PROCESSSEGMENTVERSION", "*");		
		this.ds_productDef.setColumn(i,"OPERATIONSEQUENCE", "1");						
	}
	
	for(var i=0; i<this.ds_operationSpec.rowcount; i++){
		this.ds_operationSpec.setColumn(i,"DEFAULTCHARTTYPE", defaultCharType);
		this.ds_operationSpec.setColumn(i,"RESOURCEID", productDefId);
		this.ds_operationSpec.setColumn(i,"RESOURCEVERSION", productDefVersion);
	}
	
	this.ds_tree.set_enableevent(false);


	//AOI 입력항목 체크
	if(!this.fn_checkAOI()){
		this.ds_tree.set_enableevent(true);
		return;
	}

	//주차관리 입력항목 체크
	if(!this.fn_checkWeek()){
		this.ds_tree.set_enableevent(true);
		return;
	}
	
	
	// -------------------------
	// 저장
	// ':U' 는 갱신된 내용만을 입력 데이터세트로 보내며, ':A' 는 모든 정보를 보냅니다.
	// ':N' 은 현재 Delete를 제외한 데이터를 Normal 상태로 보냅니다. 지정하지 않는 데이터세트는 Normal로 동작합니다
	// -------------------------
	var sSvcID 			= "saveRouting";
	var sController 	= "/bas02100/saveRouting.do";
	var sInDatasets 	= "ds_def=ds_productDef:A ds_operation=ds_operation:U ds_consumable=ds_consumable:U ds_operationSpec=ds_operationSpec:U ds_durable=ds_durable:U ds_aoiLayer=ds_aoiLayer:U";
	var sOutDatasets 	= "";
	var sArgs 			= "";
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
	
};

/* 
	2021-06-15, 임용희 차장
	AOI공정이 존재하는데 AOI 층 시트값이 존재 하지 않으면 확인창 표시
*/
this.fn_checkAOI = function()
{
	var fRow = this.ds_operation.findRowExpr("PROCESSSEGMENTNAME.toUpperCase().indexOf('AOI')>-1|| PROCESSSEGMENTNAME.toUpperCase().indexOf('VRS')>-1");
	//AOI공정
	if(fRow > -1){	
		this.ds_checkAOI.clearData();
		this.ds_aoiLayerCheck.copyData(this.ds_aoiLayer);
		var sSvcID 			= "checkAOI";
		var sController 	= "/bas02100/checkAOI.do";
		var sInDatasets 	= "ds_def=ds_productDef:A ds_aoiLayer=ds_aoiLayerCheck:A";
		var sOutDatasets 	= "ds_checkAOI=output";
		var sArgs 			= "";
		this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs, "fn_callBack", true, false);   
		
		var inputCnt = nexacro.toNumber(this.nfn_nvl(this.ds_checkAOI.getColumn(0, "INPUTCNT"),"0"));
		//입력된 aoi공정도 더하기
		inputCnt = inputCnt + (this.ds_aoiLayer.rowcount>0 ? 1 : 0 );
		
		var aoiCnt = nexacro.toNumber(this.nfn_nvl(this.ds_checkAOI.getColumn(0, "AOICNT"), "0"));
		
		//var result = this.ds_checkAOI.getColumn(0, "RESULT");
		
		if(inputCnt < aoiCnt){
		//if(result=="N"){
			var bOk = this.gfn_Message("NotInputAOILayer", null, "conf", "yesno");				
			return bOk;
		}
	}
	return true;
}

/* 
	2021-07-13, 임용희 차장
	M/K 인쇄공정이 존재하는데 주차관리값이 존재 하지 않으면 확인창 표시
*/
this.fn_checkWeek = function()
{
	var inputCnt 	= this.ds_operation.getCaseCount("ISWEEKMNG=='Y' && PROCESSSEGMENTTYPE=='MKPrint'");
	var weekCnt 	= this.ds_operation.getCaseCount("PROCESSSEGMENTTYPE=='MKPrint'");
	
	if(inputCnt < weekCnt){
		var bOk = this.gfn_Message("NotInputPrintWeek", null, "conf", "yesno");				
		return bOk;
	}
	
	return true;
}

/*
 * 기능 : 검색
 */
this.fn_search = function (obj:Button, e:nexacro.ClickEventInfo)
{
	if(!this.g_init){
		if(!this.fn_checkDsUpdate("A"))return;
	}
	var component = this.tab_search.Tabpage1;
	var strColIdList = "edt_item";
	var strColNmList = this.nfn_nvl(this.nfn_getDictionarynameUpper("PRODUCTDEFID"),"품목코드");
	if(!this.nfn_MandatoryCheck(component, strColIdList, strColNmList)) { return}

	this.g_positionTree = null;
	this.g_positionA = null;
	this.g_positionGrid = null;
	//BOM 트리 조회
	this.g_init = false;
	this.ds_tree.set_enableevent(true);
	this.fn_searchTreeList();	 
};


/**************************************************************************
 * 5. TRANSACTION, CALLBACK 영역
 ***************************************************************************/
this.fn_callBack = function (trId, errCD, errMsg)
{

	this.setWaitCursor(false, true); //커서 비활성화.
	if (errCD < 0) 
	{
		if (trId == "saveRouting") 
		{
			var msgArray = errMsg.split(("|"));			
			if(msgArray.length==2) {
				this.gfn_Message(msgArray[0], "\n"+msgArray[1], "error", "ok");		
			} else {
				this.gfn_Message("ProcessingError", "\n"+errMsg, "error", "ok");		
			}			
			this.ds_tree.set_enableevent(true);
		} else {
			this.gfn_Message("ProcessingError", trId + errMsg, "error", "ok");		
		}		
	} else {
		if (trId == "selectTreeList") 
		{
			this.div_work.form.treeRouting.setTreeStatus(0,true);
			if(this.ds_tree.rowcount>0){				
				var idx = 0;	
				var grdIdx = 0;
				
				if(!this.nfn_isNull(this.g_positionTree)){
					idx = this.g_positionTree;										
				}
				if(!this.nfn_isNull(this.g_positionGrid)){
					grdIdx = this.g_positionGrid;										
				}
				this.ds_tree.set_rowposition(idx);					
				this.fn_selectProductDEFInfo(idx);										
				this.div_work.form.treeRouting.selectRow(grdIdx, true);					
			} else {
				this.fn_selectProductDEFInfo(-1);
			}
			this.g_positionTree = null;
			this.g_positionGrid = null;
			this.ds_tree.set_enableevent(true);
		} else if (trId == "selectProductDEFInfo") { 		
			if(this.ds_operation.rowcount>0){				
				var idx = 0;
				if(!this.nfn_isNull(this.g_positionA)){
					idx = this.g_positionA;
				}				
				this.ds_operation.set_rowposition(idx);								
				this.fn_searchProductDetail(idx);				
				this.fn_changeBOMValue();										
			} else {			
				this.fn_searchProductDetail(-1);
			}		
			
			if(this.ds_tree.rowposition==0){
				//첫번째 조회후에 마스터데이터 복사				
				this.ds_productDefMaster.copyRow(0,this.ds_productDef,0);				
			}
			//반제품인 경우 기준값이 존재하지 않으면 부모제품의 기준값을 세팅(2021-04-01, 임용희 차장 요청)
			var masterdataClassId = this.ds_tree.getColumn(this.ds_tree.rowposition, "MASTERDATACLASSID");				
			if(masterdataClassId=="SubAssembly"){						
				var pnlX	= this.nfn_nvl(this.ds_productDef.getColumn(0, "PNLSIZEXAXIS"), this.ds_productDefMaster.getColumn(0, "PNLSIZEXAXIS"));
				var pnlY	= this.nfn_nvl(this.ds_productDef.getColumn(0, "PNLSIZEYAXIS"), this.ds_productDefMaster.getColumn(0, "PNLSIZEYAXIS"));
				var pcsPnl	= this.nfn_nvl(this.ds_productDef.getColumn(0, "PCSPNL"), 		this.ds_productDefMaster.getColumn(0, "PCSPNL"));
				
				this.ds_productDef.setColumn(0, "PNLSIZEXAXIS", pnlX);
				this.ds_productDef.setColumn(0, "PNLSIZEYAXIS", pnlY);
				this.ds_productDef.setColumn(0, "PCSPNL", 		pcsPnl);
			}
					
			this.g_positionA = null;
			this.ds_operation.set_enableevent(true);
			
			var strCnt = 'Count : <fc v="#f31d24">'+this.ds_operation.rowcount+'</fc><fc v="#999999"></fc>'
			this.div_work.form.sta_cnt_ds_operation.set_text(strCnt);
			
			this.fn_chkFormulaId(); //제품 구분에 따른 소요계산식 동적콤보 호출
		} else if (trId == "selectProductDetail") { 						
			this.ds_operation.set_enableevent(true);
			this.fn_changeOperationSpec(); //공정SPEC 관련 함수			
		} else if (trId == "saveRouting") { 
			this.gfn_Message("SuccessSave", null, "info", "ok");
			this.ds_tree.set_enableevent(true);
			this.fn_searchTreeList();			
		}
	}
};


/**************************************************************************
 * 6. 팝업 호출/콜백
 **************************************************************************/
 this.fn_openPop = function(svcId, popId)
{
	// gfn_openPopup(arg_type, popupCd, popupNm, rtnCols, paramCols, paramValues, searchStr);
	//-----------------
	// arg_type    : A::사용자가 선택, B:: 한건존재시 자동 셋팅
	// popupCd     : 공통팝업 관리 화면에서 생성되는 팝업코드
	// popupNm     : 변경할팝업화면명 , 변경하지 않을 경우 팝업화면 타이틀은 관리화면의 타이틀로 지정됨
	// rtnCols     : 구분자 : "|"   : 그리드에 출력될 컬럼 지정 (않을 경우 관리화면의 그리드로 출력됨)
	// paramCols   : 구분자 : "|" : where 구문에 들어갈 컬럼
	// paramValues : 구분자 : "|"  : where 구문에 들어갈 컬럼에 대한 값
	// searchStr   : 팝업 조회조건 콤보값 = 조회 값 	
	var popupId = svcId;
	var oArg = {};
	var opts = "width=650,height=500";
	
	oArg.arg_type = "B";
	oArg.arg_popupCd = popId;
	oArg.arg_popupNm = "";		
	oArg.arg_searchStr = "";
	oArg.arg_paramCols = "";
	oArg.arg_paramValues = "";
	
	//품목코드 조회
	if(svcId =="SCH_ITEM"){	
		//var pPRODUCTDIVISION = "Product";
		var processDefId = this.ds_search.getColumn(0,"PRODUCTDEFID");
		var prductIDCondition = processDefId == "" ? "" : "TXTPRODUCTDEFNAME=" + processDefId + "|";
		var pPlantID =  this.ds_search.getColumn(0,"PLANTID");
		opts = "width=800,height=800";		
		oArg.arg_type = "BA";
		oArg.arg_rtnCols = "PRODUCTDEFID|PRODUCTDEFNAME|PRODUCTDEFVERSION";
		oArg.arg_paramCols = "PLANTID";
		oArg.arg_paramValues = pPlantID;
		oArg.arg_searchStr = prductIDCondition;// + "PRODUCTDIVISION=" + pPRODUCTDIVISION;				
	} else if (svcId =="GRD_ITEM"){		
		opts = "width=800,height=500";		
		oArg.arg_rtnCols = "ITEMID|ITEMNAME|ITEMVERSION|UOMDEFID|LOTCONTROL|MASTERDATACLASSID|SPEC|MAKER";	
		oArg.arg_searchStr = "SubAssembly";
		this.gfn_openPopup(popupId,"bas::BAS02100P4.xfdl",oArg,opts);
		return;
	} else {
		oArg.arg_paramCols = "ENTERPRISEID|LANGUAGETYPE|VALIDSTATE";
		oArg.arg_paramValues = this.gf_getEnterpriseId()+"|"+this.gf_getLanguageType()+"|Valid";
	}
	
	//공정 조회
	if(svcId =="GRD_OPERATION"){			
		oArg.arg_rtnCols = "PROCESSSEGMENTID|PROCESSSEGMENTNAME|SUBSEGMENTID";	
		oArg.arg_paramCols = "PLANTID|VALIDSTATE";
		oArg.arg_paramValues = this.gf_getSiteType()+"|Valid";
	}	
	
	//자재 조회
	if(svcId =="GRD_CONSUMABLE"){			
		opts = "width=800,height=500";		
		oArg.arg_rtnCols = "ITEMID|ITEMNAME|ITEMVERSION|UOMDEFID|LOTCONTROL|MASTERDATACLASSID|SPEC|MAKER";	
		this.gfn_openPopup(popupId,"bas::BAS02100P.xfdl",oArg,opts);
		return;
	}

	//검사 조회
	if(svcId =="GRD_INSPECTION"){			
		var processSegId 		= this.ds_operation.getColumn(this.ds_operation.rowposition, "PROCESSSEGMENTID");	
		oArg.arg_type 			= "C";
		oArg.arg_paramCols 		= "PROCESSSEGMENTID";
		oArg.arg_paramValues 	= processSegId;
		oArg.arg_rtnCols 		= "INSPITEMID|INSPITEMNAME|INSPITEMVERSION|SPECTRANSTYPE";	
	}	
	
	//치공구 조회
	if(svcId =="GRD_DURABLE"){			
		var operationId			= this.ds_operation.getColumn(this.ds_operation.rowposition, "OPERATIONID");
		opts = "width=1024,height=500";
		oArg.arg_rtnCols = "ITEMID|ITEMNAME|ITEMVERSION|DURABLEDEFID|DURABLEDEFNAME|DURABLEDEFVERSION|TOOLFORM|TOOLKIND|SUMMARY|MANUFACTURER|SCALEX|SCALEY|DESCRIPTION|DURABLECLASSID";					
		oArg.arg_type 			= "C";		
		oArg.arg_paramCols 		= "OPERATIONID";
		oArg.arg_paramValues 	= operationId;
		/*
		oArg.arg_rtnCols 		= "DURABLECLASSTYPE"
								+"|DURABLEDEFID"
								+"|DURABLEDEFNAME"
								+"|DURABLEDEFVERSION"
								+"|FILMUSELAYER1"
								+"|FILMUSELAYER2"
								+"|DURABLECLASSID"
								*/
	}	

	if(svcId =="ITEM_COPY"){
		opts = "width=800,height=205";		
		var dsObj = this.ds_productDef;
		var dsPosition = 0;		
		oArg.itemId = dsObj.getColumn(dsPosition,"PRODUCTDEFID");
		oArg.itemRev = dsObj.getColumn(dsPosition,"PRODUCTDEFVERSION");
		oArg.itemNm = dsObj.getColumn(dsPosition,"PRODUCTDEFNAME");
		
		this.gfn_openPopup(popupId,"bas::BAS02100P1.xfdl",oArg,opts);
		return;
	}
	
	if(svcId =="ITEM_WAREHOUSE"){
		opts = "width=600,height=310";		
		var dsObj = this.ds_productDef;
		var dsPosition = 0;		
		oArg.itemId = dsObj.getColumn(dsPosition,"PRODUCTDEFID");
		oArg.itemRev = dsObj.getColumn(dsPosition,"PRODUCTDEFVERSION");
		oArg.itemType = dsObj.getColumn(dsPosition,"PRODUCTDEFCLASSID");
		
		
		this.gfn_openPopup(popupId,"bas::BAS02100P2.xfdl",oArg,opts);
		return;
	}
	this.gfn_openPopup(popupId,"cmd::CMSA00100P.xfdl",oArg,opts);
}

//팝업 결과 리턴
this.fn_popupAfter = function(sPopupId, Variant)
{
	var rtn = this.fv_rtnValue;	
	if(this.nfn_isNull(rtn)) return;

	var processSegmentId	= this.ds_operation.getColumn(this.ds_operation.rowposition, "PROCESSSEGMENTID");
	var operationId			= this.ds_operation.getColumn(this.ds_operation.rowposition, "OPERATIONID");
	var subSegmentId		= this.ds_operation.getColumn(this.ds_operation.rowposition, "SUBSEGMENTID");	 //세부공정ID
		
	if(sPopupId == "SCH_ITEM")	//검색조건 : 품목 조회
	{
		this.searchDiv1.edt_item.set_value(rtn[0]);
		this.searchDiv1.edt_item_nm.set_value(rtn[1]);
		this.searchDiv1.edt_item_cd.set_value(rtn[2]);
	}	
	
	if(sPopupId == "GRD_ITEM")	//자재그리드 : 대체품목 조회
	{
		var nRow = this.ds_consumable.rowposition;		
		this.ds_consumable.setColumn(nRow, "ALTITEM", rtn[0]);				
		this.ds_consumable.setColumn(nRow, "ALTREVISION", rtn[2]);								
	}	
	
	if(sPopupId == "GRD_OPERATION")	//공정그리드 : 공정ID 조회
	{
		var nRow = this.ds_operation.rowposition;					
		this.ds_operation.setColumn(nRow, "PROCESSSEGMENTID", rtn[0]);				
		this.ds_operation.setColumn(nRow, "PROCESSSEGMENTNAME", rtn[1]);						
		this.ds_operation.setColumn(nRow, "SUBSEGMENTID", rtn[2]);		
		
		if(nRow==0){
			this.fn_setRtrSht();
		}
	}	

	
	if(sPopupId == "GRD_CONSUMABLE")	//자재 그리드 : 자재코드 조회
	{
		for(var i=0; i<rtn.length; i++){
			var colArray 		= rtn[i];			
			var itemId 			= colArray[0];
			var itemName 		= colArray[1];
			var itemRev 		= colArray[2];			
			var uom 			= colArray[3];
			var lot				= colArray[4];			
			var materialType 	= colArray[5]=="SubAssembly" ? "Product" : "Consumable";			
			var spec 			= colArray[6];
			var maker 			= colArray[7];
			
			var nRow = this.ds_consumable.rowposition;	
			var addRow = nRow;
			if(i!=0){
				var aRow = nRow + i;
				if(this.ds_consumable.getRowType(aRow) == 2 || this.ds_consumable.getRowType(aRow) == 4){
					addRow = aRow;
				} else {
					addRow = this.ds_consumable.addRow();			
				}
			} 
			
			this.ds_consumable.setColumn(addRow, "COMPONENTITEMID", itemId);	
			this.ds_consumable.setColumn(addRow, "COMPONENTITEMVERSION", itemRev);	
			this.ds_consumable.setColumn(addRow, "COMPONENTITEMNAME", itemName);	
			this.ds_consumable.setColumn(addRow, "COMPONENTUOM", uom);	
			this.ds_consumable.setColumn(addRow, "MATERIALTYPE", materialType);	
			this.ds_consumable.setColumn(addRow, "ISREQUIREDMATERIAL", "N");	
			this.ds_consumable.setColumn(addRow, "ISALTERABLE", "N");	
			this.ds_consumable.setColumn(addRow, "USERLAYER", "");	
			this.ds_consumable.setColumn(addRow, "MULTIPLE", "1");	
			
			//2021-07-30 반제품은 Push 고정
			if(materialType=="Product"){
				this.ds_consumable.setColumn(addRow, "WIPSUPPLYTYPE", "Push");	
			} else {
				this.ds_consumable.setColumn(addRow, "WIPSUPPLYTYPE", lot=="Y" ? "Push" : "OperationPull");	
			}
			
			this.ds_consumable.setColumn(addRow, "SPEC", spec);			
			this.ds_consumable.setColumn(addRow, "MAKER", maker);		
			
			var userSequence		= this.ds_operation.getColumn(this.ds_operation.rowposition, "USERSEQUENCE");	 //공정순서

			this.ds_consumable.setColumn(addRow, "PLANTID", this.gf_getSiteType());			
			this.ds_consumable.setColumn(addRow, "PROCESSSEGMENTID", processSegmentId);			
			this.ds_consumable.setColumn(addRow, "OPERATIONID", operationId);			
			this.ds_consumable.setColumn(addRow, "USERSEQUENCE", userSequence);	
			
			//공정의 세부공정ID가 RTR이고 자재코드가 5로 시작하면 RTR투입 Y처리
			// 2021-04-16 세부공정 RTR여부는 제외, 자재코드가 5로 시작되면 무조건 RTR Y처리 (임용희 차장)
			//if(subSegmentId=="RTR" && itemId.substring(0,1)=="5"){
			if(itemId.substring(0,1)=="5"){
				this.ds_consumable.setColumn(addRow, "ISREQUIREDMATERIAL","Y");	
			} else {
				this.ds_consumable.setColumn(addRow, "ISREQUIREDMATERIAL","");	
			}
			
		}
	}
	
	if(sPopupId == "GRD_INSPECTION")	//공정SPEC 그리드 : 검사항목 조회
	{
	
		for(var i=0; i<rtn.length; i++){
			var colArray 		= rtn[i];			
			var itemId 			= colArray[0];
			var itemName 		= colArray[1];
			var itemRev 		= colArray[2];			
			var specType		= colArray[3];
			
			var nRow = this.ds_operationSpec.rowposition;	
			var addRow = nRow;
			if(i!=0){
				var aRow = nRow + i;
				if(this.ds_operationSpec.getRowType(aRow) == 2 || this.ds_operationSpec.getRowType(aRow) == 4){
					addRow = aRow;
				} else {
					addRow = this.ds_operationSpec.addRow();			
				}
			} 
			var processSegId 		= this.ds_operation.getColumn(this.ds_operation.rowposition, "PROCESSSEGMENTID");	
			this.ds_operationSpec.setColumn(addRow, "INSPITEMID", itemId);	
			this.ds_operationSpec.setColumn(addRow, "INSPITEMNAME", itemName);	
			this.ds_operationSpec.setColumn(addRow, "INSPITEMVERSION", itemRev);	
			this.ds_operationSpec.setColumn(addRow, "PROCESSSEGMENTID", processSegId);	
			this.ds_operationSpec.setColumn(addRow, "SPECTRANSTYPE", specType);	
			this.ds_operationSpec.setColumn(addRow, "INSPECTIONDEFID", "OperationInspection-OperationInspection");	
			this.ds_operationSpec.setColumn(addRow, "INSPECTIONDEFVERSION", "*");	
			this.ds_operationSpec.setColumn(addRow, "SPECCLASSID", "OperationSpec");	
			this.ds_operationSpec.setColumn(addRow, "DEFAULTCHARTTYPE", "");	
			this.ds_operationSpec.setColumn(addRow, "RESOURCETYPE", "ProcessSegmentID");
			
		}
	}
	
	
	if(sPopupId == "GRD_DURABLE")	//치공구 그리드 : 치공구 조회
	{
		for(var i=0; i<rtn.length; i++){
			var colArray 		= rtn[i];		
			//var classType		= colArray[0];
			var itemId 			= colArray[0];
			var itemName 		= colArray[1];
			var itemRev 		= colArray[2];			
			var durableId		= colArray[3];			
			var durableNm		= colArray[4];			
			var durableRev		= colArray[5];			

			var nRow = this.ds_durable.rowposition;	
			var addRow = nRow;
			if(i!=0){
				var aRow = nRow + i;
				if(this.ds_durable.getRowType(aRow) == 2 || this.ds_durable.getRowType(aRow) == 4){
					addRow = aRow;
				} else {
					addRow = this.ds_durable.addRow();			
				}
			} 
			
			this.ds_durable.setColumn(addRow, "DURABLETYPE", 'Durable');	
			this.ds_durable.setColumn(addRow, "PRODUCTDEFID", itemId);	
			this.ds_durable.setColumn(addRow, "PRODUCTDEFNAME", itemName);	
			this.ds_durable.setColumn(addRow, "PRODUCTDEFVERSION", itemRev);	
			this.ds_durable.setColumn(addRow, "TOOLCODE", durableId);	
			this.ds_durable.setColumn(addRow, "TOOLNAME", durableNm);	
			this.ds_durable.setColumn(addRow, "TOOLVERSION", durableRev);	
			this.ds_durable.setColumn(addRow, "EQUIPMENTID", "*");	
			this.ds_durable.setColumn(addRow, "RESOURCECLASSID", "*");	
			
			this.ds_durable.setColumn(addRow, "VALIDSTATE", "Valid");	
			this.ds_durable.setColumn(addRow, "OPERATIONID", operationId);	
			this.ds_durable.setColumn(addRow, "PROCESSSEGMENTID", processSegmentId);	
			this.ds_durable.setColumn(addRow, "PROCESSSEGMENTVERSION", "*");	
			this.ds_durable.setColumn(addRow, "RESOURCECLASSID", "*");	
			
		}
	}
	
	if(sPopupId =="ITEM_COPY" ){
		
	}
}

/**************************************************************************
 * 7. 기타 함수(화면 로컬 정의) 
 **************************************************************************/
/*
 * 기능 : 최초 호출되는 초기화 함수
 */
this.fn_formInit = function ()
{ 
	this.g_init = true;
	this.searchDiv1.cbo_site.set_value(this.gf_getSiteType()); 	
	this.searchDiv1.cbo_validState.set_value("Valid"); 		
	this.searchDiv1.edt_item.set_value(""); 	
	this.searchDiv1.edt_item_cd.set_value(""); 	
	this.searchDiv1.edt_item_nm.set_value(""); 	
	this.div_work.form.tab_00.Tabpage4.set_tabbuttonwidth(0); //AOI 탭 안보이게
	this.div_work.form.tab_00.set_tabindex(0);
}

/*
 * 기능 : 탭1. 트리 조회
 */
this.fn_searchTreeList = function ()
{
	
	this.ds_tree.clearData();	
	this.ds_search.setColumn(0, "VALIDSTATE", this.tab_search.Tabpage1.form.cbo_validState.value);
	var sSvcID 			= "selectTreeList";
	var sController 	= "/bas02100/selectTreeList.do";
	var sInDatasets 	= "INPUT=ds_search";
	var sOutDatasets 	= "ds_tree=output";
	var sArgs 			= "";		
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);  
};

/* 
 * 제품 상세정보 조회 이벤트
 */
this.fn_selectProductDEFInfo = function (rowPosition)
{
	this.ds_operation.set_enableevent(false);
	var itemId 		= "";
	var itemRev		= "";
	var plantId		= "";
	var validState 	= this.searchDiv1.cbo_validState.value;
	
	if(rowPosition == -1){ //BOM이 존재하지 않으면 입력값을 Item으로 선택
		itemId 		= this.searchDiv1.edt_item.value;	
		itemRev		= this.searchDiv1.edt_item_cd.value;
		plantId		= this.gf_getSiteType();		
	} else {
		itemId 		= this.ds_tree.getColumn(rowPosition, "ASSEMBLYITEMID");	
		itemRev		= this.ds_tree.getColumn(rowPosition, "ASSEMBLYITEMVERSION");	
		plantId		= this.ds_tree.getColumn(rowPosition, "PLANTID");	
	}
	
	this.ds_checkLot.clearData();
	
	var sSvcID 			= "selectProductDEFInfo";
	var sController 	= "/bas02100/selectProductDEFInfo.do";	
	var sInDatasets   	= ""; 
	var sOutDatasets  	= "ds_productDef=output1 ds_operation=output2 ds_checkLot=output3 ds_spec=output4";	
	var sArgs 		  	= "";
		sArgs 			+= this.gfn_setParam("ITEMID"		, itemId);	
		sArgs 			+= this.gfn_setParam("ITEMVERSION"	, itemRev);	
		sArgs 			+= this.gfn_setParam("PLANTID"		, plantId);	
		sArgs 			+= this.gfn_setParam("VALIDSTATE"	, validState);			
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs, "fn_callBack", true, true);   
}

/*
 * 상세조회 : 조회
 */
this.fn_searchProductDetail = function (rowPosition)
{
	var itemId 			= this.ds_operation.getColumn(rowPosition, "MAINPRODUCTID");	
	var itemRev			= this.ds_operation.getColumn(rowPosition, "MAINPRODUCTVERSION");	
	var operationId		= this.ds_operation.getColumn(rowPosition, "OPERATIONID");	
	var processSegId 	= this.ds_operation.getColumn(rowPosition, "PROCESSSEGMENTID");	
	var plantId			= this.ds_operation.getColumn(rowPosition, "PLANTID");	
	var userSeq			= this.ds_operation.getColumn(rowPosition, "USERSEQUENCE");	
	
	this.ds_consumable.clearData();		
	this.ds_operationSpec.clearData();		
	this.ds_durable.clearData();			
	this.ds_aoiLayer.clearData();		
	
	var sSvcID 			= "selectProductDetail";
	var sController 	= "/bas02100/selectProductDetail.do";
	var sInDatasets 	= "";
	var sOutDatasets 	= "ds_consumable=output1 "
						+ "ds_operationSpec=output2 "
						+ "ds_durable=output3 "						
						+ "ds_aoiLayer=output4";
	var sArgs 			= "";		
		sArgs 			+= this.gfn_setParam("PLANTID"			, plantId);	
		sArgs 			+= this.gfn_setParam("ITEMID"			, itemId);	
		sArgs 			+= this.gfn_setParam("ITEMVERSION"		, itemRev);	
		sArgs 			+= this.gfn_setParam("OPERATIONID"		, operationId);	
		sArgs 			+= this.gfn_setParam("PROCESSSEGMENTID"	, processSegId);	
		sArgs 			+= this.gfn_setParam("USERSEQUENCE"		, userSeq);	
		sArgs 			+= this.gfn_setParam("ATTRIBUTECLASS"	, "");	
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);  
};

this.fn_comboInit = function ()
{
	/* Site 코드 조회 */
	this.basfn_setCustomQueryCmb(this.searchDiv1.cbo_site // Object
								, "selectSiteList,,Y,A" // OPTION
								, null);	  // 추가 파라미터											
	/* 공장 ID 조회용 DS */
	this.ds_factory.clearData();
	var sSvcID 			= "selectSiteList";
	var sController 	= "/basCommon/selectCustomQuery.do";	
	var sInDatasets   	= ""; 
	var sOutDatasets  	= "ds_factory=output";	
	var sArgs 		  	= "";
		sArgs 			+= this.gfn_setParam("SQL_ID", "selectSiteList");		
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs, "fn_callBack", true, true);   
	
	//품목단위:UOM
	var sSvcID 			= "selectUOM";
	var sController 	= "/basCommon/selectCustomQuery.do";	
	var sInDatasets   	= ""; 
	var sOutDatasets  	= "ds_uom=output";	
	var sArgs 		  	= "";
		sArgs 			+= this.gfn_setParam("SQL_ID", "selectUOMList");	
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs, "fn_callBack", true, true);    
	
	//권한 체크
	var sSvcID 			= "selectCheckManager";
	var sController 	= "/basCommon/selectCustomQuery.do";	
	var sInDatasets   	= ""; 
	var sOutDatasets  	= "ds_checkUser=output";	
	var sArgs 		  	= "";		
	sArgs 			+= this.gfn_setParam("SQL_ID", "selectCheckManager");		
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs, "fn_callBack", true, true);  
}

/*
 * Dataset 수정여부 체크 함수
 */
this.fn_checkDsUpdate = function(type)
{
	var bOk = true;
	if(type=="A"){
		if (  this.gfn_dsIsUpdated(this.ds_productDef)
		   || this.gfn_dsIsUpdated(this.ds_operation)
		   || this.gfn_dsIsUpdated(this.ds_consumable)
		   || this.gfn_dsIsUpdated(this.ds_operationSpec)
		   || this.gfn_dsIsUpdated(this.ds_durable)	   
		   || this.gfn_dsIsUpdated(this.ds_aoiLayer)
		   ) {	
			bOk = this.gfn_Message("WRITTENBEDELETE", null, "conf", "yesno");				
		}
	} else {
		if (  this.gfn_dsIsUpdated(this.ds_consumable)
		   || this.gfn_dsIsUpdated(this.ds_operationSpec)
		   || this.gfn_dsIsUpdated(this.ds_durable)	   
		   || this.gfn_dsIsUpdated(this.ds_aoiLayer)
		   ) {	
			bOk = this.gfn_Message("WRITTENBEDELETE", null, "conf", "yesno");				
		}
	}
	return bOk;
}

/*
 * 행추가 함수(상세 탭 공통)
 */
this.fn_addDetail = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var objId 				= obj.id.replace("btn_add","");		
	var dsObj 				= this.objects["ds_"+objId];		
	if(dsObj==null)return;		
	var processSegmentId	= this.ds_operation.getColumn(this.ds_operation.rowposition, "PROCESSSEGMENTID");
	var operationId			= this.ds_operation.getColumn(this.ds_operation.rowposition, "OPERATIONID");
	var operationRowType	= this.ds_operation.getRowType(this.ds_operation.rowposition);
	var subSegmentId		= this.ds_operation.getColumn(this.ds_operation.rowposition, "SUBSEGMENTID");	 //세부공정ID
	var userSequence		= this.ds_operation.getColumn(this.ds_operation.rowposition, "USERSEQUENCE");	 //공정순서
	
	//신규입력건은 입력불가
	if(operationRowType==2 || operationRowType==0){
		this.gfn_Message("NoSelectDataSaveAndProceed", "", "warning", "ok");
		return;
	}
	
	var nRow 				= dsObj.addRow();
	
	switch (objId){
		//자재
		case "consumable":
			dsObj.setColumn(nRow, "WIPSUPPLYTYPE","Push");
			dsObj.setColumn(nRow, "PLANTID",this.gf_getSiteType());
			dsObj.setColumn(nRow, "ISREQUIREDMATERIAL","N");
			dsObj.setColumn(nRow, "ISALTERABLE","N");
			dsObj.setColumn(nRow, "PROCESSSEGMENTID",processSegmentId);
			dsObj.setColumn(nRow, "OPERATIONID",operationId);
			dsObj.setColumn(nRow, "USERSEQUENCE",userSequence);
			
			//공정의 세부공정ID가 RTR이면 RTR투입 Y처리
			if(subSegmentId=="RTR"){
			//	dsObj.setColumn(nRow, "ISREQUIREDMATERIAL","Y");	
			}
		break;
		
		//공정Spec
		case "operationSpec":
			var infoObj = this.div_work.form.tab_00.Tabpage2.form.cbo_barcharinfo;			
			dsObj.setColumn(nRow, "PROCESSSEGMENTID",processSegmentId);
			dsObj.setColumn(nRow, "INSPECTIONDEFID","OperationInspection-OperationInspection");
			dsObj.setColumn(nRow, "INSPECTIONDEFVERSION","*");
			dsObj.setColumn(nRow, "SPECCLASSID","OperationSpec");
			dsObj.setColumn(nRow, "DEFAULTCHARTTYPE",infoObj.value);
			dsObj.setColumn(nRow, "RESOURCETYPE","ProcessSegmentID");			
		break;

		//치공구
		case "durable":			
			dsObj.setColumn(nRow, "PROCESSSEGMENTID",processSegmentId);
			dsObj.setColumn(nRow, "PROCESSSEGMENTVERSION","*");
			dsObj.setColumn(nRow, "OPERATIONID",operationId);
			dsObj.setColumn(nRow, "EQUIPMENTID","*");
			dsObj.setColumn(nRow, "RESOURCECLASSID","*");			
			dsObj.setColumn(nRow, "VALIDSTATE","Valid");		
			
		break;
		
		//AOI
		case "aoiLayer":						
			dsObj.setColumn(nRow, "PROCESSSEGMENTID",processSegmentId);
			dsObj.setColumn(nRow, "PROCESSSEGMENTVERSION","*");
			dsObj.setColumn(nRow, "OPERATIONID",operationId);
		break;
	}
	
};

/*
 * 행삭제 함수
 */
this.fn_delDetail = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var objId 				= obj.id.replace("btn_del","");		
	var dsObj 				= this.objects["ds_"+objId];		
	if(dsObj==null)return;			
	var rowposition			= dsObj.rowposition;
	
	if(rowposition < 0 ){
		this.gfn_Message("CHECKREMOVETOOLDATA", "", "warning", "ok");
		return;
	}

	if(!this.gfn_Message("IsDeleted", null, "conf", "yesno")){
		return;
	}		
	
	dsObj.deleteRow(rowposition);		
	

};

/* 
 * 공정Spec 그리드 콤보값 변경 이벤트
 */
this.fn_changeOperationSpec = function()
{
	var dsCount = this.ds_operationSpec.rowcount;
	var infoObj = this.div_work.form.tab_00.Tabpage2.form.cbo_barcharinfo;
	if(dsCount==0){				
		infoObj.set_value("XBARR");
		infoObj.set_readonly(false);
	} else {
		var nRow = this.ds_operationSpec.findRowExpr("DEFAULTCHARTTYPE != $0", 0, -1, [null]);
		var charType = "XBARR";
		
		if(nRow>=0){
			charType = this.ds_operationSpec.getColumn(nRow, "DEFAULTCHARTTYPE");
			infoObj.set_readonly(true);
		} else {
			infoObj.set_readonly(false);
		}		
		infoObj.set_value(charType);
	}
}

/* 
 *	첫번째 공정이 RTR인경우 Roll로 자동 바인딩 하는 함수
 */
this.fn_setRtrSht = function()
{
	var subSegmentId		= this.ds_operation.getColumn(0, "SUBSEGMENTID");	 	 //첫번째 행의 세부공정ID		
	var processSegmentName	= this.ds_operation.getColumn(0, "PROCESSSEGMENTNAME");	 //첫번째 행의 공정명
	
	//첫공정의 세부공정ID가 RTR이면 Roll 아니면 Sheet로 자동선택
	if(subSegmentId=="RTR"){
		this.ds_productDef.setColumn(0, "RTRSHT", "RTR");
	} else {
		this.ds_productDef.setColumn(0, "RTRSHT", "SHT");
	}
}

/*
 *	공정수순 채번 함수
 */
this.fn_genNumber = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if(!this.gfn_Message("generateUserSequence", null, "conf", "yesno")) return;				
	
	var rowCount = this.ds_operation.rowcount;
	for(var i=1; i <=rowCount; i++){
		var maxSeq 		= i * 10;
		this.ds_operation.setColumn(i-1, "USERSEQUENCE", maxSeq);
	}
};


/**************************************************************************
 * 8. 이벤트
 ***************************************************************************/
this.div_work_tab_onchanged = function(obj:nexacro.Tab,e:nexacro.TabIndexChangeEventInfo)
{
	if(e.postindex==0){
		this.tab_search.set_tabindex(0);
	} else {
		this.tab_search.set_tabindex(1);
		var addParam = "ALLVIEWS|PROCESSSEGMENTID|PROCESSSEGMENTNAME";
			/* 조회조건 조회 */
			this.basfn_setCustomQueryCmb(this.searchDiv2.cboSearchType // Object
								, "selectCustomCodeList,,Y,A" // OPTION
								, this.gfn_setParam("ADD_PARAM", addParam));	  // 추가 파라미터								
			this.searchDiv2.cboSearchType.set_value("ALLVIEWS");
	}
};

/*
 * BOM Tree Node Control
 */
this.ds_tree_canrowposchange = function(obj:nexacro.NormalDataset,e:nexacro.DSRowPosChangeEventInfo)
{
	if(e.newrow < 0 || e.newrow == e.oldrow) return;
	var classID = this.ds_tree.getColumn(e.newrow, "MASTERDATACLASSID");
	if(classID != "Product" && classID != "SubAssembly" )
	{
		return false;
	}
};

/*
 * 검색조건 : 품목코드 팝업 조회
 */
this.tab_search_Tabpage1_btnProductCode_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.fn_openPop("SCH_ITEM","P00105"); //품목 조회
};

/*
 * 이벤트 : 공정선택
 */
this.ds_operation_canrowposchange = function(obj:nexacro.NormalDataset,e:nexacro.DSRowPosChangeEventInfo)
{
	if(!this.fn_checkDsUpdate("B")){
		return false;
	}
};

/*
 * 공정 그리드 : 행추가
 */ 
this.fn_addOperation = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if(this.ds_productDef.rowcount< 1) return;
	var dsObj = this.ds_operation;
	if(dsObj == null) return;
	
	var rowPosition = this.ds_productDef.rowposition;
	var masterdataClassId = this.ds_productDef.getColumn(rowPosition, "PRODUCTDEFCLASSID");
	var itemId		= this.ds_productDef.getColumn(rowPosition, "PRODUCTDEFID");
	var itemVersion = this.ds_productDef.getColumn(rowPosition, "PRODUCTDEFVERSION");
	var maxSeq 		= this.nfn_nvl(dsObj.getMax("USERSEQUENCE"),0);
	var userSeq 	= this.nfn_nvl(dsObj.getColumn(dsObj.rowposition,"USERSEQUENCE"),0);	
	
	var userSequence= maxSeq + 10;
	var userSequence2= userSeq + 1;
	
	if(masterdataClassId=="SubAssembly" || masterdataClassId=="Product"){
		var row = dsObj.insertRow(dsObj.rowposition+1);				
		dsObj.setColumn(row,"PLANTID",this.gf_getSiteType());			
		dsObj.setColumn(row,"USERSEQUENCE",maxSeq==userSeq ? userSequence : userSequence2);	
		dsObj.setColumn(row,"PROCESSUOM","PCS");			
		dsObj.setColumn(row,"VALIDSTATE","Valid");		
		dsObj.setColumn(row,"PATHTYPE","StartEnd");		
		dsObj.setColumn(row,"OPERATIONSEQUENCE","1");		
		dsObj.setColumn(row,"PROCESSDEFTYPE","Main");		
		dsObj.setColumn(row,"VERSIONSTATE","Active");		
		
		//첫번째 Row의 자재는 무조건 Y
		if(row==0){
			dsObj.setColumn(row,"ISREQUIREDMATERIAL","Y");		
		}
	} else {
		this.gfn_Message("WrongRegistBom", "", "warning", "ok");
	}
};

/*
 * 공정 그리드 : 행삭제
 */ 
this.fn_deleteOperation = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var dsObj = this.ds_operation;
	if(dsObj == null) return;	
	var isChkCnt = dsObj.getColIndex("CHK");	
	var chkCnt = isChkCnt==-1 ? -1 : dsObj.getCaseCount("CHK=='1'");
	var rowCount = dsObj.rowcount;
	var bOk = true;
	var dsPosition = dsObj.rowposition;
	
	//단일행 삭제건
	if(chkCnt==-1){		
		if(dsPosition < 0) {
			this.gfn_Message("NoSelections", "", "warning", "ok");
			return;
		}
	}
		
	var wrkTp = dsObj.getRowType(dsObj.rowposition);
	
	//저장된 데이터만 체크
	if(wrkTp != Dataset.ROWTYPE_INSERT){		
		if(this.ds_checkLot.rowcount > 0){ //LOT에 존재 (삭제불가처리)	
			this.gfn_Message("CantDeleteLotRouting", "", "warning", "ok");
			return;
		} else {
			bOk = this.gfn_Message("DeleteLinkedItemBySegment", null, "conf", "yesno");				
			if(!bOk){return}	
		}
	}
	dsObj.deleteRow(dsPosition);			
};

/* 
 * 트리 선택노드 변경 이벤트
 */
this.ds_tree_onrowposchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSRowPosChangeEventInfo)
{	
	if(e.newrow<0) return;	
	if(e.oldrow != e.newrow){		
		this.fn_selectProductDEFInfo(e.newrow);	
	}	
};

/* 
 * 자재유형값에 따른 작업방식 수정가능여부 체크 함수
 */
this.fn_chkMaterialType = function (data)
{
	if(data == "GUSSETPLATE"
	 || data == "SHIELD"
	 || data == "GULE"
	 || data == "COVERLAY"
	 || data == "OTHER"){
		return "combo";
	 } else {
		return "none";
	 }
}

/* 
 * 자재유형값에 따른 작업방식 수정가능여부 체크 함수
 */
this.fn_chkFormulaId = function ()
{
	var rowPosition 	= this.ds_productDef.rowposition;
	var materialType 	= this.ds_productDef.getColumn(rowPosition, "PRODUCTDEFCLASSID");		
	var lookupType 		= "";
	if(materialType=="Product"){
		lookupType="BOMProducGroup";
	} else if(materialType=="SubAssembly"){
		lookupType="BOMSubAssemblyGroup";
	}
	
	//품목단위:UOM
	var sSvcID 			= "selectBom";
	var sController 	= "/basCommon/selectCustomQuery.do";	
	var sInDatasets   	= ""; 
	var sOutDatasets  	= "ds_bomList=output";	
	var sArgs 		  	= "";
		sArgs 			+= this.gfn_setParam("SQL_ID", "selectCodeList");	
		sArgs 			+= this.gfn_setParam("LOOKUP_TYPE", lookupType);	
		sArgs 			+= this.gfn_setParam("CMB_TYPE", "null");			
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs, "fn_callBack", true, true);    
}

/* 
 * 자재그리드 콤보값 변경 이벤트
 */
this.div_work_tab_00_Tabpage1_grd_consumable_oncloseup = function(obj:nexacro.Grid,e:nexacro.GridEditEventInfo)
{
	this.div_work.form.tab_00.Tabpage1.form.grd_consumable.updateToDataset();
};

/* 
 * 공정그리드 입력값 변경 이벤트
 */
this.ds_operation_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	if (e.newvalue == e.oldvalue) 
	{
		return;
	}
	
	//첫번째 행의 세부공정이 RTR일 경우 체크		
	if (e.columnid == "PROCESSSEGMENTID" && e.row == 0) 
	{	
		if (e.newvalue == null) 
		{
			return;
		} else {
			this.fn_setRtrSht();
		}
	}
	
	//2021-07-06 통테2차 결함리스트 #4  - 임용희 차장 요청
	//현재공 있는경우 미사용처리 불가처리	
	if(e.columnid=="VALIDSTATE"){
		if(e.newvalue=="Invalid"){
			this.ds_checkNowParam.clearData();
			this.ds_checkNow.clearData();
			this.ds_checkNowParam.addRow();
			this.ds_checkNowParam.setColumn(0, "ITEMID", this.ds_operation.getColumn(e.row, "MAINPRODUCTID"));
			this.ds_checkNowParam.setColumn(0, "ITEMVERSION", this.ds_operation.getColumn(e.row, "MAINPRODUCTVERSION"));
			this.ds_checkNowParam.setColumn(0, "PROCESSSEGMENTID", this.ds_operation.getColumn(e.row, "PROCESSSEGMENTID"));
			this.ds_checkNowParam.setColumn(0, "USERSEQUENCE", this.ds_operation.getColumn(e.row, "USERSEQUENCE"));
			
			var sSvcID 			= "selectCheckLot";
			var sController 	= "/bas02100/selectCheckLot.do";
			var sInDatasets 	= "INPUT=ds_checkNowParam";
			var sOutDatasets 	= "ds_checkNow=output";
			var sArgs 			= "";
			this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs, "fn_callBack", true, false);
			
			if(this.ds_checkNow.rowcount>0){					
				this.gfn_Message("CantInvalidProcess", "", "warning", "ok");								
				this.ds_operation.setColumn(e.row, "VALIDSTATE", "Valid");			
			}			
		}
	}	
};

/*
 * 소요계산식 변경시 초기화 함수
 */
this.fn_BOMInit  = function(row, bomFormularId)
{
	var rowPosition 	= this.ds_productDef.rowposition;
	var materialType 	= this.ds_productDef.getColumn(rowPosition, "PRODUCTDEFCLASSID");		
	
	var dsObj 			= this.ds_bom;
	var dsConsumable	= this.ds_consumable;
	var fRow 			= dsObj.findRow("ID", bomFormularId);	
	var defaultVar1		= dsObj.getColumn(fRow, "DEFAULTVAR1");
	var defaultVar2		= dsObj.getColumn(fRow, "DEFAULTVAR2");
	var defaultVar3		= dsObj.getColumn(fRow, "DEFAULTVAR3");
	var defaultVar4		= dsObj.getColumn(fRow, "DEFAULTVAR4");
	var defaultVar5		= dsObj.getColumn(fRow, "DEFAULTVAR5");
	var isEditable1		= dsObj.getColumn(fRow, "ISEDITABLE1");
	var isEditable2		= dsObj.getColumn(fRow, "ISEDITABLE2");
	var isEditable3		= dsObj.getColumn(fRow, "ISEDITABLE3");
	var isEditable4		= dsObj.getColumn(fRow, "ISEDITABLE4");
	var isEditable5		= dsObj.getColumn(fRow, "ISEDITABLE5");
	
	dsConsumable.setColumn(row, "ISEDITABLE1", isEditable1);
	dsConsumable.setColumn(row, "ISEDITABLE2", isEditable2);
	dsConsumable.setColumn(row, "ISEDITABLE3", isEditable3);
	dsConsumable.setColumn(row, "ISEDITABLE4", isEditable4);
	dsConsumable.setColumn(row, "ISEDITABLE5", isEditable5);
	
	dsConsumable.setColumn(row, "VARIABLE1", defaultVar1);
	dsConsumable.setColumn(row, "VARIABLE2", defaultVar2);
	dsConsumable.setColumn(row, "VARIABLE3", defaultVar3);
	dsConsumable.setColumn(row, "VARIABLE4", defaultVar4);
	dsConsumable.setColumn(row, "VARIABLE5", defaultVar5);
	
	//자동 계산
	this.fn_BOMcalculate(row, bomFormularId);	
}

/*
 * 제품 상세 조회후 BOM 기준값을 변경하는 함수 (AS-IS가 이 모양.....하아....그냥 그대로 만들자)
 */
this.fn_changeBOMValue = function()
{
	var rowPosition 	= this.ds_productDef.rowposition;
	var materialType 	= this.ds_productDef.getColumn(rowPosition, "PRODUCTDEFCLASSID");		
	var pnlSizeY		= this.nfn_nvl(this.ds_productDef.getColumn(rowPosition, "PNLSIZEYAXIS"),0);		
	var pcsPnl			= this.nfn_nvl(this.ds_productDef.getColumn(rowPosition, "PCSPNL"),0);	
	var val13_1			= this.nfn_nvl(this.ds_spec.getColumn(rowPosition, "VAL13_1"),0);		//금도금값1(C)
	var val13_2			= this.nfn_nvl(this.ds_spec.getColumn(rowPosition, "VAL13_2"),0);		//금도금값1(S)
	var val14_1			= this.nfn_nvl(this.ds_spec.getColumn(rowPosition, "VAL14_1"),0);		//금도금값2(C)
	var val14_2			= this.nfn_nvl(this.ds_spec.getColumn(rowPosition, "VAL14_2"),0);		//금도금값2(S)
	var val15_1			= this.nfn_nvl(this.ds_spec.getColumn(rowPosition, "VAL15_1"),0);		//금도금값3(C)
	var val15_2			= this.nfn_nvl(this.ds_spec.getColumn(rowPosition, "VAL15_2"),0);		//금도금값3(S)
	var auSize			= this.nfn_nvl(this.ds_spec.getColumn(rowPosition, "VAL3"),0);		//금도금두께
	var dsObj 			= this.ds_bom;	
	var fRow 			= -1;
	
	/*
	trace("val13_1== " + val13_1);
	trace("val13_2== " + val13_2);
	trace("val14_1== " + val14_1);
	trace("val14_2== " + val14_2);
	trace("val15_1== " + val15_1);
	trace("val15_2== " + val15_2);
	*/
	
	fRow = dsObj.findRow("ID", "BOM_P_0000001");
		dsObj.setColumn(fRow, "DEFAULTVAR1", pnlSizeY);
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
	fRow = dsObj.findRow("ID", "BOM_P_0000002");
		dsObj.setColumn(fRow, "DEFAULTVAR1", pnlSizeY);
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
	fRow = dsObj.findRow("ID", "BOM_P_0000003");
		dsObj.setColumn(fRow, "DEFAULTVAR1", pnlSizeY);
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
	fRow = dsObj.findRow("ID", "BOM_P_0000004");
		dsObj.setColumn(fRow, "DEFAULTVAR1", pnlSizeY);
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
	fRow = dsObj.findRow("ID", "BOM_P_0000006");
		dsObj.setColumn(fRow, "DEFAULTVAR1", pnlSizeY);
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
		
	fRow = dsObj.findRow("ID", "BOM_P_0000007");
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
	fRow = dsObj.findRow("ID", "BOM_P_0000009");
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
	fRow = dsObj.findRow("ID", "BOM_P_0000011");
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
	fRow = dsObj.findRow("ID", "BOM_P_0000012");
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
	fRow = dsObj.findRow("ID", "BOM_P_0000013");
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
	fRow = dsObj.findRow("ID", "BOM_P_0000014");
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
	fRow = dsObj.findRow("ID", "BOM_P_0000016");
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
	fRow = dsObj.findRow("ID", "BOM_P_0000017");
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
	fRow = dsObj.findRow("ID", "BOM_P_0000018");
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
		
	fRow = dsObj.findRow("ID", "BOM_P_0000019");
		dsObj.setColumn(fRow, "DEFAULTVAR1", (nexacro.toNumber(val13_1) + nexacro.toNumber(val13_2)));
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
		dsObj.setColumn(fRow, "DEFAULTVAR5", auSize);		
		
	fRow = dsObj.findRow("ID", "BOM_P_0000020");
		dsObj.setColumn(fRow, "DEFAULTVAR1", (nexacro.toNumber(val14_1) + nexacro.toNumber(val14_2)));
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
		dsObj.setColumn(fRow, "DEFAULTVAR5", auSize);		
		
	fRow = dsObj.findRow("ID", "BOM_P_0000021");
		dsObj.setColumn(fRow, "DEFAULTVAR1", (nexacro.toNumber(val15_1) + nexacro.toNumber(val15_2)));
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
		dsObj.setColumn(fRow, "DEFAULTVAR5", auSize);		
		
	fRow = dsObj.findRow("ID", "BOM_P_0000022");
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);
	fRow = dsObj.findRow("ID", "BOM_P_0000023");
		dsObj.setColumn(fRow, "DEFAULTVAR3", pcsPnl);

	fRow = dsObj.findRow("ID", "BOM_SA_0000001");
		dsObj.setColumn(fRow, "DEFAULTVAR1", pnlSizeY);
	fRow = dsObj.findRow("ID", "BOM_SA_0000002");
		dsObj.setColumn(fRow, "DEFAULTVAR1", pnlSizeY);
	fRow = dsObj.findRow("ID", "BOM_SA_0000004");
		dsObj.setColumn(fRow, "DEFAULTVAR1", pnlSizeY);
	fRow = dsObj.findRow("ID", "BOM_SA_0000008");
		dsObj.setColumn(fRow, "DEFAULTVAR1", pnlSizeY);
	fRow = dsObj.findRow("ID", "BOM_SA_0000009");
		dsObj.setColumn(fRow, "DEFAULTVAR1", pnlSizeY);
	fRow = dsObj.findRow("ID", "BOM_SA_0000020");
		dsObj.setColumn(fRow, "DEFAULTVAR1", pnlSizeY);				
}

//BOM 계산식 자동계산 함수
this.fn_BOMcalculate = function(row, bomFormularId)
{	
	var rowPosition 	= this.ds_productDef.rowposition;
	var materialType 	= this.ds_productDef.getColumn(rowPosition, "PRODUCTDEFCLASSID");		
	
	var dsObj 			= this.ds_bom;
	var dsConsumable	= this.ds_consumable;
	var fRow 			= dsObj.findRow("ID", bomFormularId);
	var formula 		= dsObj.getColumn(fRow, "FORMULA");
	var v1				= dsConsumable.getColumn(row, "VARIABLE1");
	var v2				= dsConsumable.getColumn(row, "VARIABLE2");
	var v3				= dsConsumable.getColumn(row, "VARIABLE3");
	var v4				= dsConsumable.getColumn(row, "VARIABLE4");
	var v5				= dsConsumable.getColumn(row, "VARIABLE5");	
	
	
	if(this.nfn_isNull(formula) || formula=="보류"){
		return;		
	} else {		
		formula = formula.replace("v1", nexacro.toNumber(v1,"0"));
		formula = formula.replace("v2", nexacro.toNumber(v2,"0"));
		formula = formula.replace("v3", nexacro.toNumber(v3,"0"));
		formula = formula.replace("v4", nexacro.toNumber(v4,"0"));
		formula = formula.replace("v5", nexacro.toNumber(v5,"0"));
		trace("---------------------------------------");
		trace(formula);
		var total = eval(formula);
		trace("---------------------------------------");		
		total = (new nexacro.Decimal((total*100000))) / 100000;		
		trace(total);		
		//total = nexacro.round(total, 5); //소수점 5째자리 반올림처리
		total = nexacro.floor(total, 5); //소수점 5째자리 2021-04-15 버림처리로 변경		
		dsConsumable.setColumn(row, "COMPONENTQTY", total);
	}
}

/* 
 * 공정그리드 공정ID 팝업조회
 */
this.div_work_grd_operation_onexpandup = function(obj:nexacro.Grid,e:nexacro.GridMouseEventInfo)
{
	if(e.row < 0) return;
	if (this.nfn_isEqualCol(obj, e.cell, "PROCESSSEGMENTID")) {
		this.fn_openPop("GRD_OPERATION","P00206"); //공정 조회
	}
};

/* 
 * 공정그리드 선택행 변경시 AOI/VRS 체크함수
 */
this.ds_operation_onrowposchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSRowPosChangeEventInfo)
{	
	var processSegmentName 	= this.nfn_nvl(this.ds_operation.getColumn(this.ds_operation.rowposition, "PROCESSSEGMENTNAME"),"").toUpperCase();
	var isSpec				= this.ds_operation.getColumn(this.ds_operation.rowposition, "ISREQUIREDOPERATIONSPEC");
	var isConsumable		= this.ds_operation.getColumn(this.ds_operation.rowposition, "ISREQUIREDMATERIAL");
	var isDurable	 		= this.ds_operation.getColumn(this.ds_operation.rowposition, "ISREQUIREDTOOL");
	
	if(processSegmentName.indexOf("AOI")>= 0 || processSegmentName.indexOf("VRS")>= 0){
		this.div_work.form.tab_00.Tabpage4.set_tabbuttonwidth(100);
		this.div_work.form.tab_00.set_tabindex(3);
	} else {
		this.div_work.form.tab_00.Tabpage4.set_tabbuttonwidth(0);
		//AOI탭인 경우 첫번째 탭으로
		if(isConsumable=="Y"){
			this.div_work.form.tab_00.set_tabindex(0);
		} else {
			if(isSpec=="Y"){
				this.div_work.form.tab_00.set_tabindex(1);
			} else {
				if(isDurable=="Y"){
					this.div_work.form.tab_00.set_tabindex(2);
				} else {
					this.div_work.form.tab_00.set_tabindex(0);
				}
			}
		}
		
		if(this.div_work.form.tab_00.tabindex == 3){
			this.div_work.form.tab_00.set_tabindex(0);
		}
	}
	if(e.newrow < 0 ) return;
	this.fn_searchProductDetail(e.newrow);	
};

/* 
 * 자재그리드 팝업 이벤트
 */
this.div_work_tab_00_Tabpage1_grd_consumable_onexpandup = function(obj:nexacro.Grid,e:nexacro.GridMouseEventInfo)
{
	if(e.row < 0) return;
	if (this.nfn_isEqualCol(obj, e.cell, "COMPONENTITEMID")) {
		this.fn_openPop("GRD_CONSUMABLE",""); //자재 조회		
	}
	if (this.nfn_isEqualCol(obj, e.cell, "ALTITEM")) {
		this.fn_openPop("GRD_ITEM",""); //대체품목 조회
	}
};

/* 
 * 공정SPEC 그리드 팝업 이벤트
 */
this.div_work_tab_00_Tabpage2_grd_operationSpec_onexpandup = function(obj:nexacro.Grid,e:nexacro.GridMouseEventInfo)
{
	if(e.row < 0) return;
	if (this.nfn_isEqualCol(obj, e.cell, "INSPITEMNAME")) {
		this.fn_openPop("GRD_INSPECTION","P00136"); //검사 조회
	}
};

/* 
 * 치공구 그리드 팝업 이벤트
 */
this.div_work_tab_00_Tabpage3_grd_durable_onexpandup = function(obj:nexacro.Grid,e:nexacro.GridMouseEventInfo)
{
	var operationId			= this.ds_operation.getColumn(this.ds_operation.rowposition, "OPERATIONID");
	var productDefId		= this.ds_productDef.getColumn(0, "PRODUCTDEFID");
	var productDefVersion	= this.ds_productDef.getColumn(0, "PRODUCTDEFVERSION");
	var productDefName		= this.ds_productDef.getColumn(0, "PRODUCTDEFNAME");
	var plantId				= this.searchDiv1.cbo_site.value;
	
	if(e.row < 0) return;
	
	/*
	if (this.nfn_isEqualCol(obj, e.cell, "PRODUCTDEFID")) {
		var popupId = "GRD_DURABLE";
		var oArg = {};
		oArg.toolCode 		= this.ds_durable.getColumn(e.row,"TOOLCODE");
		oArg.toolName 		= this.ds_durable.getColumn(e.row,"TOOLNAME");		
		oArg.ProdDefID 		= productDefId;
		oArg.ProdDefVer 	= productDefVersion;
		oArg.ProdDefName 	= productDefName;
		oArg.plantID 		= plantId;
		oArg.durableClass	= " ";
		oArg.operationID 	= operationId;
		oArg.ds_result 		= this.ds_resultDurable;	   
		this.gfn_openPopup(popupId,"bas::BAS02100P3.xfdl",oArg,"width=800,height=700");
	}*/
	this.fn_openPop("GRD_DURABLE","P00198"); //자재 조회		
	
};

/* 
 * 기본챠트유형 변경시 기본Chartset 전체 수정(그리드 전체수정)
 */
this.div_work_tab_00_Tabpage2_cbo_barcharinfo_onitemchanged = function(obj:nexacro.Combo,e:nexacro.ItemChangeEventInfo)
{
	for(var i=0; i<this.ds_operationSpec.rowcount;i++){
		this.ds_operationSpec.setColumn(i, "DEFAULTCHARTTYPE", e.postvalue);
	}	
};

//Routing 복사 함수
this.fn_copyProduct = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	/*
	var dsObj = this.ds_tree;
	if(dsObj.rowcount <= 0 ){
		this.gfn_Message("InputProudctInfo", "", "warning", "ok");
		return;
	}
	*/
	var dsObj = this.ds_productDef;
	var dsPosition = 0;		
	var itemId = dsObj.getColumn(dsPosition,"PRODUCTDEFID");
	var itemRev = dsObj.getColumn(dsPosition,"PRODUCTDEFVERSION");		
	
	if(this.nfn_isNull(itemId) || this.nfn_isNull(itemRev)){
		this.gfn_Message("InputProudctInfo", "", "warning", "ok");
		return;
	}		
	this.fn_openPop("ITEM_COPY","ITEM_COPY", null); //복사	
};

//완료창고 버튼 클릭 이벤트 함수
this.fn_warehouse = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var dsObj = this.ds_productDef;
	var dsPosition = 0;		
	var itemId = dsObj.getColumn(dsPosition,"PRODUCTDEFID");
	var itemRev = dsObj.getColumn(dsPosition,"PRODUCTDEFVERSION");		
	
	if(this.nfn_isNull(itemId) || this.nfn_isNull(itemRev)){
		this.gfn_Message("InputProudctInfo", "", "warning", "ok");
		return;
	}		
	this.fn_openPop("ITEM_WAREHOUSE","ITEM_WAREHOUSE", null); //완료창고 지정	
};

//자재 DS 값 변경 이벤트 함수
this.ds_consumable_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	//소요량 계산식 초기화
	if (e.columnid == "BOMFORMULAID" ){	
		this.fn_BOMInit(e.row, e.newvalue);		
	}
	
	//BOM 소요량 계산식 자동 계산로직
	if(   e.columnid == "VARIABLE1" 
	   || e.columnid == "VARIABLE2" 
	   || e.columnid == "VARIABLE3" 
	   || e.columnid == "VARIABLE4" 
	   || e.columnid == "VARIABLE5"
    ){	
		//자동 계산
		var formularId = obj.getColumn(e.row, "BOMFORMULAID");
		this.fn_BOMcalculate(e.row, formularId);		
	}
	
	//PSR이 아닌경우 인쇄면 값 초기화
	if (e.columnid == "MATERIALDETAILTYPE" ){	
		if(e.newvalue!="PSR"){
			obj.setColumn(e.row, "PSRPRINTTYPE", "");				
		}		
	}
};

//엑셀 업로드 버튼 클릭 함수
this.tab_work_Tabpage1_btn_xlUp_grd_basIdclass_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if(this.gfn_dsIsUpdated(this.ds_operation))
	{
		var btn = this.gfn_confirm("WRITTENBEDELETE", "information", ""); //"입력한 내용이 있으면 현재 작성중인 내용이 모두 삭제됩니다."		
		if(btn == false) return;
	}
	
	
	if(this.ds_checkLot.rowcount > 0){ //LOT에 존재 (삭제불가처리)	
		this.gfn_Message("CantDeleteLotRouting", "", "warning", "ok");
		return;
	} else {
		var bOK = this.gfn_Message("IsOkIntializeGrid", null, "conf", "yesno");//그리드를 초기화 하시겠습니까?
		if (!bOK) return;
		this.ds_operation.set_enableevent(false);
		for(var i=this.ds_operation.rowcount+1; i>=0; i--){			
			this.ds_operation.deleteRow(i);
		}
	}	
	
	this.Mode = "Excel";	
	this.ds_operationExcel.clearData();	
	this.gfn_import_excel("ds_operationExcel", "fn_excel_success", "fn_excel_fail", "B1", "B2");
};


/*
 *	엑셀 업로드 실패 시 
 */
this.fn_excel_fail = function ()
{
	this.gfn_Message("FAILEXCELIMPORT", null, "warning", "ok");//this.gfn_Message("IMCMM0033", null, "warning", "ok");
	this.ds_operation.set_enableevent(true);
};

/*
 *	엑셀 업로드 이후...
 */
this.fn_excel_success = function ()
{	
	this.ds_operation.set_enableevent(false);
	var dsObj = this.ds_operation;
	var dsObjExcel = this.ds_operationExcel;	
	
	if(dsObjExcel.rowcount > 0 ){
		this.fn_makeExcelData();
	} else {
		this.gfn_Message("NOTEXISTSEXCELIMPORTDATA", "", "warning", "ok");
	}	
};
 
 //업로드된 엑셀데이터를 가지고 코드값 조회 함수
 this.fn_makeExcelData = function()
 {
 	var sSvcID 			= "uploadRoutingExcel";
 	var sController 	= "/bas02100/uploadRoutingExcel.do";	
 	var sInDatasets 	= "INPUT=ds_operationExcel";
 	var sOutDatasets  	= "ds_operationExcelOut=output";	
 	var sArgs 		  	= "";
 	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs, "fn_callBackExcelData", true, true);  
 }
 
 this.fn_callBackExcelData = function (trId, errCD, errMsg)
 {
 	if (errCD < 0) 
 	{	
 		this.gfn_Message("ProcessingError", trId + errMsg, "error", "ok");			
 	} else { 				
		for(var i=0; i<this.ds_operationExcelOut.rowcount; i++){
			var addRow = this.ds_operation.addRow();			
			this.ds_operation.copyRow(addRow,this.ds_operationExcelOut,i);
		}
		this.fn_setRtrSht();	
 	}	
	this.ds_operation.set_enableevent(true);
 }

this.tab_search_Tabpage1_edt_item_onkeydown = function(obj:nexacro.Edit,e:nexacro.KeyEventInfo)
{
	if(e.keycode==13){	
		this.ds_search.setColumn(0,"PRODUCTDEFID",obj.value);
		this.tab_search_Tabpage1_btnProductCode_onclick();
	}
};


//BOM Tree 노트 선택 이벤트
this.div_work_treeRouting_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if(e.row<0) return;		
	var classID = this.ds_tree.getColumn(e.row, "MASTERDATACLASSID");
	if(classID != "Product" && classID != "SubAssembly" )
	{
		return false;
	}
	
	this.fn_selectProductDEFInfo(e.row);		
};

this.ds_operation_cancolumnchange = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	
};

this.div_work_grd_operation_oncloseup = function(obj:nexacro.Grid,e:nexacro.GridEditEventInfo)
{
	this.div_work.form.grd_operation.updateToDataset();
};


this.ds_operationSpec_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	var specType 	= obj.getColumn(e.row, "SPECTRANSTYPE");
	var lsl 		= nexacro.toNumber(this.nfn_nvl(obj.getColumn(e.row, "LSL"), "0"));
	var sl 			= nexacro.toNumber(this.nfn_nvl(obj.getColumn(e.row, "SL"), "0"));
	var usl 		= nexacro.toNumber(this.nfn_nvl(obj.getColumn(e.row, "USL"), "0"));
	var thickness 	= nexacro.toNumber(this.nfn_nvl(obj.getColumn(e.row, "COPPERTHICKNESS"), "0"));
	
	if(specType=="IMPEDANCE"){ 	//임피던스 회로폭
		var ousl = usl==0 ? nexacro.round(sl * 1.1, 2) : usl;
		var olsl = lsl==0 ? nexacro.round(sl * 0.9, 2) : lsl;
		if(e.columnid=="SL"){		
			obj.setColumn(e.row, "OSL", sl);			
			obj.setColumn(e.row, "OUSL", ousl);
			obj.setColumn(e.row, "OLSL", olsl);
		} else if(e.columnid=="USL"){
			obj.setColumn(e.row, "OUSL", ousl);
		} else if(e.columnid=="LSL"){
			obj.setColumn(e.row, "OLSL", olsl);
		}
	} else if(specType=="COPPERIZE"){	//동도금두께
		var ousl = nexacro.round(((thickness * 36) + usl + 3), 2);
		var olsl = nexacro.round(((thickness * 36) + lsl - 3), 2);					
		if(e.columnid=="SL" || e.columnid=="COPPERTHICKNESS"){									
			obj.setColumn(e.row, "OUSL", ousl);
			obj.setColumn(e.row, "OLSL", olsl);
			obj.setColumn(e.row, "OSL", nexacro.floor((((thickness * 36) + usl + 3) + ((thickness * 36) + lsl - 3)) / 2), 5);			
		} else if(e.columnid=="USL"){
			obj.setColumn(e.row, "OUSL", ousl);
		} else if(e.columnid=="LSL"){
			obj.setColumn(e.row, "OLSL", olsl);
		}
	} else if(specType=="CO2HOLL"){	//홀사이즈
		var ousl = nexacro.round(((sl + 30) * 1.2) * 1000, 2);
		var olsl = nexacro.round(((sl + 30) * 0.8) * 1000, 2);
		var osl	 = nexacro.round(((sl + 30)      ) * 1000, 2);
		
		if(e.columnid=="SL"){					
			obj.setColumn(e.row, "OUSL", ousl);
			obj.setColumn(e.row, "OLSL", olsl);
			obj.setColumn(e.row, "OSL",  osl);
		} else if(e.columnid=="USL"){
			obj.setColumn(e.row, "OUSL", ousl);
		} else if(e.columnid=="LSL"){
			obj.setColumn(e.row, "OLSL", olsl);
		}
	} else { //나머지
		if(e.columnid=="SL"){	
			obj.setColumn(e.row, "OSL", sl);			
		}		
		if(e.columnid=="USL"){	
			obj.setColumn(e.row, "OUSL", usl);
		}
		if(e.columnid=="LSL"){	
			obj.setColumn(e.row, "OLSL", lsl);
		}
	}
};


this.fn_InspType = function (data)
{
	var editType = "none";
	
	if(!this.nfn_isNull(this.ds_checkUser.getColumn(0, "USER_ID"))){ //권한이 없으면 사양Spec 수정 불가처리		
		if(data == "COPPERIZE"){ //동도금두께인경우만 수정 가능
			editType = "normal";
		}
	}
	
	return editType;
}]]></Script>
    <Bind>
      <BindItem id="item0" compid="tab_search.Tabpage1.form.cbo_site" propid="value" datasetid="ds_search" columnid="PLANTID"/>
      <BindItem id="item1" compid="tab_search.Tabpage1.form.edt_item_cd" propid="value" datasetid="ds_search" columnid="PRODUCTDEFVERSION"/>
      <BindItem id="item2" compid="tab_search.Tabpage1.form.edt_item_nm" propid="value" datasetid="ds_search" columnid="PRODUCTDEFNM"/>
      <BindItem id="item3" compid="tab_search.Tabpage1.form.edt_item" propid="value" datasetid="ds_search" columnid="PRODUCTDEFID"/>
      <BindItem id="item4" compid="div_work.form.Div01.form.edt_customerName" propid="value" datasetid="ds_productDef" columnid="CUSTOMERNAME"/>
      <BindItem id="item5" compid="div_work.form.Div01.form.edt_itemId" propid="value" datasetid="ds_productDef" columnid="PRODUCTDEFID"/>
      <BindItem id="item6" compid="div_work.form.Div01.form.edt_itemRev" propid="value" datasetid="ds_productDef" columnid="PRODUCTDEFVERSION"/>
      <BindItem id="item7" compid="div_work.form.Div01.form.edt_itemName" propid="value" datasetid="ds_productDef" columnid="PRODUCTDEFNAME"/>
      <BindItem id="item8" compid="div_work.form.Div01.form.edt_jobType" propid="value" datasetid="ds_productDef" columnid="JOBTYPENAME"/>
      <BindItem id="item9" compid="div_work.form.Div01.form.edt_productType" propid="value" datasetid="ds_productDef" columnid="PRODUCTIONTYPENAME"/>
      <BindItem id="item16" compid="div_work.form.Div01.form.edt_remark" propid="value" datasetid="ds_productDef" columnid="REMARK"/>
      <BindItem id="item10" compid="div_work.form.Div01.form.cbo_rtr" propid="value" datasetid="ds_productDef" columnid="RTRSHT"/>
      <BindItem id="item15" compid="div_work.form.Div01.form.edt_pcsmm" propid="value" datasetid="ds_productDef" columnid="PCSMM"/>
      <BindItem id="item14" compid="div_work.form.Div01.form.edt_pcspnl" propid="value" datasetid="ds_productDef" columnid="PCSPNL"/>
      <BindItem id="item11" compid="div_work.form.Div01.form.edt_pnlX" propid="value" datasetid="ds_productDef" columnid="PNLSIZEXAXIS"/>
      <BindItem id="item12" compid="div_work.form.Div01.form.edt_pnlY" propid="value" datasetid="ds_productDef" columnid="PNLSIZEYAXIS"/>
    </Bind>
  </Form>
</FDL>

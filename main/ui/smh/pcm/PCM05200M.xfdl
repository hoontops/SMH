<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="PCM05200M" width="1258" height="747" titletext="일자별 실적재공" onload="fn_init">
    <Layouts>
      <Layout height="747" width="1258">
        <Tab id="tab_search" taborder="0" tabindex="0" left="0" top="47" width="290" cssclass="tab_search" bottom="0">
          <Tabpages>
            <Tabpage id="tab_page" text="Tabpage1">
              <Layouts>
                <Layout>
                  <Combo id="cbo_PRODUCTDIVISION" taborder="9" width="165" height="20" left="108" index="0" text="선택" codecolumn="C,ProductDivision2,ALL,Y,Y" top="235"/>
                  <Combo id="cbo_PRODUCTIONTYPE" taborder="10" text="전체조회" left="108" top="cbo_PRODUCTDIVISION:5" height="20" codecolumn="C,ProductionType,ALL,Y,Y" index="0" value="" width="165"/>
                  <Combo id="cbo_WORKTYPE" taborder="11" left="108" top="cbo_PRODUCTIONTYPE:5" width="165" height="20" codecolumn="C,LotWorkType,ALL,Y,Y"/>
                  <Combo id="cbo_INNERREVISIONTOTAL" taborder="12" width="165" height="20" left="108" index="0" codecolumn="C,InnerrevisionTotal,,Y,Y" top="cbo_WORKTYPE:5" onitemchanged="fn_innerRevisionTotalChange">
                    <Dataset id="innerdataset">
                      <ColumnInfo>
                        <Column id="CODECOLUMN" size="256"/>
                        <Column id="DATACOLUMN" size="256"/>
                      </ColumnInfo>
                      <Rows>
                        <Row>
                          <Col id="CODECOLUMN"/>
                          <Col id="DATACOLUMN">전체</Col>
                        </Row>
                      </Rows>
                    </Dataset>
                  </Combo>
                  <Static id="Static12_00_00_00_01_00_00" taborder="19" text="h20" width="45" top="cbo_INNERREVISIONTOTAL:0" visible="false" height="20" cssclass="guideTip" right="91"/>
                  <Button id="btn_clear" taborder="14" top="Static12_00_00_00_01_00_00:0" width="102" height="36" cssclass="btn_SA_reset" left="171" text="초기화" tooltiptext="Toolbar_Initialization" onclick="fn_searchClear"/>
                  <Button id="btn_search" taborder="13" top="Static12_00_00_00_01_00_00:0" width="146" height="36" cssclass="btn_SA_search" left="15" text="검색" tooltiptext="Toolbar_Search" onclick="fn_search" hotkey="F2"/>
                  <Static id="Static12_00_00_00" taborder="15" text="w&#13;&#10;15" width="15" top="70" visible="false" height="97" cssclass="guideTip" right="0"/>
                  <Static id="Static12_00_00_00_00" taborder="16" text="w&#13;&#10;15" width="15" top="80" visible="false" height="97" cssclass="guideTip" left="0"/>
                  <Static id="Static12_00_00_00_01" taborder="17" text="h10" width="45" top="0" visible="false" height="10" cssclass="guideTip" right="91"/>
                  <Static id="Static12_00_00_00_01_00" taborder="18" text="h5" width="45" top="30" visible="false" height="5" cssclass="guideTip" right="91"/>
                  <Static id="Static12_00_00_00_00_00" taborder="20" text="w&#13;&#10;10" width="10" top="Static12_00_00_00_01_00_00:6" visible="false" height="27" cssclass="guideTip" left="161"/>
                  <Static id="sta_PLANTID" taborder="21" text="Site" left="0" top="10" width="103" height="20" cssclass="sta_WF_label" tooltiptext="PLANT"/>
                  <Combo id="cbo_PLANTID" taborder="0" text="CCT" left="108" top="10" height="20" index="1" value="" width="165" codecolumn="C,SiteType,ALL,Y,Y" enable="true" readonly="false"/>
                  <Static id="sta_SearchPeriod" taborder="26" text="조회기간" left="0" top="35" width="103" height="20" cssclass="sta_WF_label" tooltiptext="C6A85700415446D89213292978260263"/>
                  <Calendar id="cal_STARTDT" taborder="1" left="108" top="35" width="165" height="20" innerdataset="" onchanged="fn_changeCustom" dateformat="yyyy-MM-dd"/>
                  <Combo id="cbo_PERIODTYPE" taborder="27" text="IFC" left="15" top="60" height="20" index="1" value="" width="88" codecolumn="C,searchPeriodType,,Y,Y" onitemchanged="tab_search_tab_page_cbo_PERIODTYPE_onitemchanged"/>
                  <Calendar id="cal_ENDDT" taborder="2" left="108" top="60" width="165" height="20" innerdataset="" onchanged="fn_changeCustom" dateformat="yyyy-MM-dd"/>
                  <Static id="sta_PRODUCTDEFID" taborder="22" text="품목코드" left="0" top="85" width="103" height="20" cssclass="sta_WF_label" tooltiptext="ITEMCODE"/>
                  <Edit id="edt_PRODUCTDEFID" taborder="3" left="108" top="85" height="20" right="37"/>
                  <Button id="btn_PRODUCTDEFID" taborder="23" width="22" height="20" cssclass="btn_WF_finder" top="85" right="15" onclick="tab_search_tab_page_btn_PRODUCTDEFID_onclick"/>
                  <Static id="sta_PRODUCTDEFVERSION" taborder="24" text="Rev." left="0" top="sta_PRODUCTDEFID:5" width="103" height="20" cssclass="sta_WF_label" tooltiptext="INNERREVISION"/>
                  <Combo id="cbo_PRODUCTDEFVERSION" taborder="4" text="전체조회" left="108" top="edt_PRODUCTDEFID:5" height="20" codecolumn="PRODUCTDEFVERSIONCODE" datacolumn="PRODUCTDEFVERSIONNAME" index="0" value="" width="165" innerdataset="ds_cbo_ProdVersion"/>
                  <Static id="sta_PRODUCTDEFNAME" taborder="25" text="품목명" left="0" top="sta_PRODUCTDEFVERSION:5" width="103" height="20" cssclass="sta_WF_label" tooltiptext="ITEMID"/>
                  <Edit id="edt_PRODUCTDEFNAME" taborder="5" left="108" top="cbo_PRODUCTDEFVERSION:5" height="20" right="15"/>
                  <Static id="sta_AREAID" taborder="28" text="작업장" left="0" top="sta_PRODUCTDEFNAME:5" width="103" height="20" cssclass="sta_WF_label" tooltiptext="AREA"/>
                  <Edit id="edt_AREAID" taborder="6" left="108" top="edt_PRODUCTDEFNAME:5" height="20" right="37"/>
                  <Button id="btn_AREAID" taborder="29" width="22" height="20" cssclass="btn_WF_finder" top="edt_PRODUCTDEFNAME:5" right="15" onclick="tab_search_tab_page_btn_AREAID_onclick" text=""/>
                  <Static id="sta_INNERREVISIONTOTAL" text="Rev.별 집계여부" width="103" height="20" left="0" top="310" cssclass="sta_WF_label" taborder="30" tooltiptext="INNERREVISIONTOTAL"/>
                  <Static id="sta_MIDDLEPROCESSSEGMENT" taborder="31" text="중공정" left="0" top="sta_AREAID:5" width="103" height="20" cssclass="sta_WF_label" tooltiptext="MIDDLEPROCESSSEGMENT"/>
                  <Combo id="cbo_MIDDLEPROCESSSEGMENT" taborder="7" text="전체조회" left="108" top="edt_AREAID:5" height="20" index="0" value="" width="165" innerdataset="ds_middleprocessSegment" codecolumn="PROCESSSEGMENTCLASSID" datacolumn="PROCESSSEGMENTCLASSNAME"/>
                  <Button id="btn_PROCSEGMENT" taborder="32" width="22" height="20" cssclass="btn_WF_finder" top="cbo_MIDDLEPROCESSSEGMENT:5" right="15" onclick="tab_search_tab_page_btn_PROCSEGMENT_onclick"/>
                  <Edit id="edt_PROCSEGMENT" taborder="8" left="108" top="cbo_MIDDLEPROCESSSEGMENT:5" height="20" right="37"/>
                  <Static id="sta_PROCSEGMENT" taborder="33" text="공정" left="0" top="sta_MIDDLEPROCESSSEGMENT:5" width="103" height="20" cssclass="sta_WF_label" tooltiptext="PROCESSCHANGETYPE"/>
                  <Static id="sta_PRODUCTDIVISION" text="제품구분" width="103" height="20" left="0" top="sta_PROCSEGMENT:5" cssclass="sta_WF_label" taborder="34" tooltiptext="THEPRODUCTTYPE"/>
                  <Static id="sta_PRODUCTIONTYPE" taborder="35" text="생산구분" left="0" top="sta_PRODUCTDIVISION:5" width="103" height="20" cssclass="sta_WF_label" tooltiptext="PRODUCTIONTYPE"/>
                  <Static id="sta_WORKTYPE" taborder="36" text="작업구분" left="0" top="285" width="103" height="20" cssclass="sta_WF_label" tooltiptext="WORKTYPE"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="sta_searchTitle" taborder="1" text="검색조건" left="0" top="47" width="143" height="34" cssclass="sta_WF_subTitle" usedecorate="true" tooltiptext="SEARCH_CONDITION_GROUP"/>
        <Div id="div_work" taborder="2" text="div_00" left="300" top="47" right="0" bottom="0">
          <Layouts>
            <Layout>
              <Tab id="tab_Main" taborder="0" tabindex="0" left="0" top="0" right="0" bottom="0" cssclass="tab_master" onchanged="InnerrevisionTotalChange" positionstep="0">
                <Tabpages>
                  <Tabpage id="Tabpage2" text="공정" tooltiptext="PROCESSCHANGETYPE">
                    <Layouts>
                      <Layout>
                        <Static id="staTitle" taborder="0" text="미투입 자재 소요" left="0" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" width="110" tooltiptext="NOTINPUTMATERIALREQUIREMENT"/>
                        <Static id="sta_cnt_ds_stockbyprocess" taborder="1" text="Count : &lt;fc v=&quot;#f31d24&quot;&gt;0&lt;/fc&gt;" left="staTitle:10" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" width="140"/>
                        <Button id="btn_xlDn_grd_stockbyprocess" taborder="2" top="6" width="29" height="24" cssclass="btn_WF_grdExcelDown" tooltiptext="GridExport" right="0" initvalueid="x"/>
                        <Grid id="grd_stockbyprocess" taborder="3" left="0" top="34" autoenter="select" right="0" bottom="0" binddataset="ds_stockbyprocess" onsummaryclick="div_work_tab_Main_Tabpage2_grd_stockbyprocess_onsummaryclick" oncelldblclick="div_work_tab_Main_Tabpage2_grd_stockbyprocess_oncelldblclick">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="48" band="left"/>
                                <Column size="200" band="left"/>
                                <Column size="160" band="left"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24" band="head"/>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                                <Row size="24" band="summ"/>
                              </Rows>
                              <Band id="head">
                                <Cell rowspan="2"/>
                                <Cell col="1" rowspan="2" colspan="2" suppressalign="first"/>
                                <Cell row="2" text="No"/>
                                <Cell row="2" col="1" text="공정명" tooltiptext="PROCESSSEGMENTNAME" suppressalign="first"/>
                                <Cell row="2" col="2" text="작업장" tooltiptext="WORKAREA"/>
                              </Band>
                              <Band id="body">
                                <Cell expr="expr:currow+1"/>
                                <Cell col="1" text="bind:PROCESSSEGMENTNAME" calendardateformat="ddd" displaytype="normal" cssclass="expr:WEEK == '1' ?  'cell_bg_green' : ''" textAlign="left" suppress="0" suppressalign="middle"/>
                                <Cell col="2" text="bind:AREANAME" calendardateformat="ddd" displaytype="normal" cssclass="expr:WEEK == '1' ?  'cell_bg_green' : ''" textAlign="left" suppress="0" suppressalign="middle"/>
                              </Band>
                              <Band id="summary">
                                <Cell/>
                                <Cell col="1" text="합계"/>
                                <Cell col="2"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="Tabpage3" text="품목" tooltiptext="PRODUCTIONDEFINITION">
                    <Layouts>
                      <Layout>
                        <Static id="staTitle" taborder="0" text="품목별 재공실적" left="0" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" width="130" tooltiptext="RESULTANDSTOCKBYPRODUCT"/>
                        <Static id="sta_cnt_ds_stockbyProduct" taborder="1" text="Count : &lt;fc v=&quot;#f31d24&quot;&gt;0&lt;/fc&gt;" left="staTitle:-10" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" width="140"/>
                        <Button id="btn_xlDn_grd_stockbyProduct" taborder="2" top="6" width="29" height="24" cssclass="btn_WF_grdExcelDown" tooltiptext="GridExport" right="0" initvalueid="x"/>
                        <Grid id="grd_stockbyProduct" taborder="3" left="0" top="34" autoenter="select" right="0" bottom="0" binddataset="ds_stockbyProduct" oncelldblclick="div_work_tab_Main_Tabpage3_grd_stockbyProduct_oncelldblclick">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="48" band="left"/>
                                <Column size="130" band="left"/>
                                <Column size="80" band="left"/>
                                <Column size="240" band="left"/>
                                <Column size="70" band="left"/>
                                <Column size="170" band="left"/>
                                <Column size="150" band="left"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24" band="head"/>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                                <Row size="24" band="summ"/>
                              </Rows>
                              <Band id="head">
                                <Cell rowspan="2"/>
                                <Cell col="1" rowspan="2" colspan="6"/>
                                <Cell row="2" text="No"/>
                                <Cell row="2" col="1" tooltiptext="ITEMCODE" text="품목코드"/>
                                <Cell row="2" col="2" text="Rev." tooltiptext="INNERREVISION"/>
                                <Cell row="2" col="3" tooltiptext="ITEMNAME" text="품목명"/>
                                <Cell row="2" col="4" text="공정수순" tooltiptext="USERSEQUENCE"/>
                                <Cell row="2" col="5" text="공정명" tooltiptext="PROCESSSEGMENTNAME"/>
                                <Cell row="2" col="6" text="작업장" tooltiptext="WORKAREA"/>
                              </Band>
                              <Band id="body">
                                <Cell expr="expr:currow+1"/>
                                <Cell col="1" text="bind:PRODUCTDEFID" textAlign="left" cssclass="expr:WEEK == '1' ?  'cell_bg_green' : ''"/>
                                <Cell col="2" text="bind:PRODUCTDEFVERSION" textAlign="left" cssclass="expr:WEEK == '1' ?  'cell_bg_green' : ''"/>
                                <Cell col="3" text="bind:PRODUCTDEFNAME" textAlign="left" cssclass="expr:WEEK == '1' ?  'cell_bg_green' : ''"/>
                                <Cell col="4" text="bind:USERSEQUENCE"/>
                                <Cell col="5" text="bind:PROCESSSEGMENTNAME" textAlign="left" cssclass="expr:WEEK == '1' ?  'cell_bg_green' : ''"/>
                                <Cell col="6" text="bind:AREANAME" textAlign="left" cssclass="expr:WEEK == '1' ?  'cell_bg_green' : ''"/>
                              </Band>
                              <Band id="summary">
                                <Cell/>
                                <Cell col="1"/>
                                <Cell col="2"/>
                                <Cell col="3" text="합계" tooltiptext="TOTALAMOUNT"/>
                                <Cell col="4"/>
                                <Cell col="5"/>
                                <Cell col="6"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="Tabpage1" text="LOT">
                    <Layouts>
                      <Layout>
                        <Static id="sta_00" taborder="0" text="LOT별 실적현황" left="0" top="0" height="34" cssclass="sta_WF_subTitle" right="0" tooltiptext="WORKRESULTBYLOT"/>
                        <Grid id="grd_workResultBylotList" taborder="1" left="0" top="34" bottom="0" autoenter="select" right="0" binddataset="ds_workResultBylotList">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="60"/>
                                <Column size="60"/>
                                <Column size="120"/>
                                <Column size="60"/>
                                <Column size="180"/>
                                <Column size="200"/>
                                <Column size="150"/>
                                <Column size="150"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="60"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="100"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                                <Row size="26" band="summ"/>
                              </Rows>
                              <Band id="head">
                                <Cell rowspan="2" text="생산구분" tooltiptext="PRODUCTIONTYPE"/>
                                <Cell col="1" rowspan="2" text="Site ID" tooltiptext="PLANTID"/>
                                <Cell col="2" rowspan="2" text="품목코드" tooltiptext="ITEMCODE"/>
                                <Cell col="3" rowspan="2" text="Rev." tooltiptext="INNERREVISION"/>
                                <Cell col="4" rowspan="2" text="품목명" tooltiptext="ITEMID"/>
                                <Cell col="5" rowspan="2" text="Lot No." tooltiptext="LOTID"/>
                                <Cell col="6" rowspan="2" text="공정명" tooltiptext="PROCESSSEGMENTNAME"/>
                                <Cell col="7" rowspan="2" text="작업장" tooltiptext="WORKAREA"/>
                                <Cell col="8" rowspan="2" text="Roll/Sheet" tooltiptext="RTRSHT_WORDWRAP"/>
                                <Cell col="9" rowspan="2" text="작업구분" tooltiptext="WORKTYPE"/>
                                <Cell col="10" rowspan="2" text="자원" tooltiptext="RESOURCE"/>
                                <Cell col="11" colspan="3" text="실적" cssclass="cell_headMaster" tooltiptext="OSPCLOSEACTUALAINFO"/>
                                <Cell col="14" colspan="3" text="현재공" tooltiptext="CURRENTWIP"/>
                                <Cell col="17" colspan="3" text="투입" tooltiptext="INPUT"/>
                                <Cell col="20" rowspan="2" text="대공정" tooltiptext="TOPPROCESSSEGMENTCLASS"/>
                                <Cell col="21" rowspan="2" text="중공정" tooltiptext="MIDDLEPROCESSSEGMENT"/>
                                <Cell row="1" col="11" text="PCS" tooltiptext="OSPDAY21PCS"/>
                                <Cell row="1" col="12" text="PNL" tooltiptext="OSPDAY01PNL"/>
                                <Cell row="1" col="13" text="MM" tooltiptext="OSPDAY09MM"/>
                                <Cell row="1" col="14" text="PCS" tooltiptext="OSPDAY21PCS"/>
                                <Cell row="1" col="15" text="PNL" tooltiptext="OSPDAY01PNL"/>
                                <Cell row="1" col="16" text="MM" tooltiptext="OSPDAY09MM"/>
                                <Cell row="1" col="17" text="PCS" tooltiptext="OSPDAY21PCS"/>
                                <Cell row="1" col="18" text="PNL" tooltiptext="OSPDAY01PNL"/>
                                <Cell row="1" col="19" text="MM" tooltiptext="OSPDAY09MM"/>
                              </Band>
                              <Band id="body">
                                <Cell text="bind:LOTTYPE"/>
                                <Cell col="1" text="bind:PLANTID"/>
                                <Cell col="2" text="bind:PRODUCTDEFID" textAlign="left"/>
                                <Cell col="3" text="bind:PRODUCTDEFVERSION" textAlign="left"/>
                                <Cell col="4" text="bind:PRODUCTDEFNAME" textAlign="left"/>
                                <Cell col="5" text="bind:LOTID" textAlign="center"/>
                                <Cell col="6" text="bind:PROCESSSEGMENTNAME" textAlign="left"/>
                                <Cell col="7" text="bind:AREANAME" textAlign="left"/>
                                <Cell col="8" text="bind:RTRSHT"/>
                                <Cell col="9" text="bind:WORKTYPE" combocodecol="C,LotWorkType,,Y,N" displaytype="combotext"/>
                                <Cell col="10" text="bind:EQUIPMENT" textAlign="right" displaytype="number"/>
                                <Cell col="11" text="bind:SENDPCSQTY" textAlign="right" displaytype="number"/>
                                <Cell col="12" text="bind:SENDPANELQTY" textAlign="right" displaytype="number"/>
                                <Cell col="13" text="bind:SENDMMQTY" textAlign="right" displaytype="number"/>
                                <Cell col="14" text="bind:WIPQTY" textAlign="right" displaytype="number"/>
                                <Cell col="15" text="bind:WIPPANELQTY" textAlign="right" displaytype="number"/>
                                <Cell col="16" text="bind:WIPMMQTY" textAlign="right" displaytype="number"/>
                                <Cell col="17" text="bind:INPUTPCSQTY" textAlign="right" displaytype="number"/>
                                <Cell col="18" text="bind:INPUTPANELQTY" textAlign="right" displaytype="number"/>
                                <Cell col="19" text="bind:INPUTMMQTY" textAlign="right" displaytype="number"/>
                                <Cell col="20" text="bind:LARGEPROCESSSEGMENT" textAlign="left"/>
                                <Cell col="21" text="bind:MIDDLEPROCESSSEGMENT" textAlign="left"/>
                              </Band>
                              <Band id="summary">
                                <Cell/>
                                <Cell col="1"/>
                                <Cell col="2"/>
                                <Cell col="3"/>
                                <Cell col="4"/>
                                <Cell col="5" text="합계"/>
                                <Cell col="6"/>
                                <Cell col="7"/>
                                <Cell col="8"/>
                                <Cell col="9"/>
                                <Cell col="10"/>
                                <Cell col="11" text="0" displaytype="number" expr="dataset.getSum(&quot;SENDPCSQTY&quot;)"/>
                                <Cell col="12" text="0" displaytype="number" expr="dataset.getSum(&quot;SENDPANELQTY&quot;)"/>
                                <Cell col="13" text="0" displaytype="number" expr="dataset.getSum(&quot;SENDMMQTY&quot;)"/>
                                <Cell col="14" text="0" displaytype="number" expr="dataset.getSum(&quot;WIPQTY&quot;)"/>
                                <Cell col="15" displaytype="number" text="0" expr="dataset.getSum(&quot;WIPPANELQTY&quot;)"/>
                                <Cell col="16" text="0" displaytype="number" expr="dataset.getSum(&quot;WIPMMQTY&quot;)"/>
                                <Cell col="17" displaytype="number" text="0" expr="dataset.getSum(&quot;INPUTPCSQTY&quot;)"/>
                                <Cell col="18" text="0" displaytype="number" expr="dataset.getSum(&quot;INPUTPANELQTY&quot;)"/>
                                <Cell col="19" displaytype="number" text="0" expr="dataset.getSum(&quot;INPUTMMQTY&quot;)"/>
                                <Cell col="20"/>
                                <Cell col="21"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Static id="sta_cnt_ds_workResultBylotList" taborder="2" text="Count : &lt;fc v=&quot;#f31d24&quot;&gt;0&lt;/fc&gt;" left="112" top="2" height="30" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" width="140"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                </Tabpages>
              </Tab>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_header" taborder="3" left="0" top="0" height="47" right="0" formscrolltype="both">
          <Layouts>
            <Layout>
              <Static id="Static01" taborder="6" left="0" top="0" cssclass="sta_WF_titleBG" right="0" bottom="0" text=""/>
              <Button id="btn_reset" taborder="0" top="16" width="26" height="24" cssclass="btn_com_reset" right="0" tooltiptext="Toolbar_Initialization" text="" initvalueid="x"/>
              <Button id="btn_help" taborder="1" top="16" width="26" height="24" cssclass="btn_com_help" right="btn_reset:0" tooltiptext="MANUAL" initvalueid="x"/>
              <Static id="sta_title" taborder="3" text="화면명" left="30" top="16" width="150" height="24" cssclass="sta_WF_title" fittocontents="width" expr="nexacro.getApplication().gds_menu.lookup(&quot;PGM_ID&quot;,comp.parent.parent.parent.name,&quot;MENU_NM&quot;)"/>
              <Button id="btn_favorite" taborder="2" left="sta_title:0" top="16" width="24" height="24" cssclass="btn_WF_favorite"/>
              <Button id="btn_searchOpen" taborder="4" left="0" top="16" width="30" height="24" cssclass="btn_WF_searchOpen" onclick="nfn_searchOpen_onclick"/>
              <Static id="Static16" taborder="5" left="47" top="0" width="60" height="20" cssclass="guideTip" visible="false" text="h20"/>
            </Layout>
          </Layouts>
        </Div>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_stockbyprocess">
        <ColumnInfo>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="AREAID" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTNAME" type="STRING" size="256"/>
          <Column id="AREANAME" type="STRING" size="256"/>
          <Column id="RSLT_PCS_20210303" type="STRING" size="256"/>
          <Column id="RSLT_PNL20210303" type="STRING" size="256"/>
          <Column id="STOCK_PCS20210303" type="STRING" size="256"/>
          <Column id="STOCK_PNL20210303" type="STRING" size="256"/>
          <Column id="RSLT_PCS_20210304" type="STRING" size="256"/>
          <Column id="RSLT_PNL20210304" type="STRING" size="256"/>
          <Column id="STOCK_PCS20210304" type="STRING" size="256"/>
          <Column id="STOCK_PNL20210304" type="STRING" size="256"/>
          <Column id="TOTAL_RSLT_PCS" type="STRING" size="256"/>
          <Column id="TOTAL_RSLT_PNL" type="STRING" size="256"/>
          <Column id="TOTAL_STOCK_PCS" type="STRING" size="256"/>
          <Column id="TOTAL_STOCK_PNL" type="STRING" size="256"/>
          <Column id="TOTAL_RSLT_PCS_AVG" type="STRING" size="256"/>
          <Column id="TOTAL_RSLT_PNL_AVG" type="STRING" size="256"/>
          <Column id="TOTAL_STOCK_PCS_AVG" type="STRING" size="256"/>
          <Column id="TOTAL_STOCK_PNL_AVG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search">
        <ColumnInfo>
          <Column id="PLANTID" type="STRING" size="256"/>
          <Column id="PERIODTYPE" type="STRING" size="256"/>
          <Column id="PERIOD_PERIODFR" type="STRING" size="256"/>
          <Column id="PERIOD_PERIODTO" type="STRING" size="256"/>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNAME" type="STRING" size="256"/>
          <Column id="AREAID" type="STRING" size="256"/>
          <Column id="AREANAME" type="STRING" size="256"/>
          <Column id="MIDDLEPROCESSSEGMENT" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTCLASSTYPE" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTNAME" type="STRING" size="256"/>
          <Column id="PRODUCTDIVISION" type="STRING" size="256"/>
          <Column id="PRODUCTIONTYPE" type="STRING" size="256"/>
          <Column id="INNERREVISIONTOTAL" type="STRING" size="256"/>
          <Column id="TYPE" type="STRING" size="256"/>
          <Column id="WORKTYPE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_cbo_ProdVersion" firefirstcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PRODUCTDEFVERSIONCODE" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSIONNAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_requirementTotal">
        <ColumnInfo>
          <Column id="KEYCOLUMN" type="STRING" size="256"/>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNAME" type="STRING" size="256"/>
          <Column id="CONSUMABLEDEFID" type="STRING" size="256"/>
          <Column id="CONSUMABLEDEFVERSION" type="STRING" size="256"/>
          <Column id="CONSUMABLEDEFNAME" type="STRING" size="256"/>
          <Column id="NOTINPUTPCSQTY" type="STRING" size="256"/>
          <Column id="NOTINPUTPNLQTY" type="STRING" size="256"/>
          <Column id="MATERIALREQUIREMENTQTY" type="STRING" size="256"/>
          <Column id="CONSUMABLEDEFIDDETAIL" type="STRING" size="256"/>
          <Column id="CONSUMABLEDEFVERSIONDETAIL" type="STRING" size="256"/>
          <Column id="CONSUMABLEDEFNAMEDETAIL" type="STRING" size="256"/>
          <Column id="QTY" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_stockbyProduct">
        <ColumnInfo>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNAME" type="STRING" size="256"/>
          <Column id="USERSEQUENCE" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTNAME" type="STRING" size="256"/>
          <Column id="AREANAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_middleprocessSegment">
        <ColumnInfo>
          <Column id="PROCESSSEGMENTCLASSID" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTCLASSNAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_headgrdList">
        <ColumnInfo>
          <Column id="COLUMNS" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_workResultBylotList">
        <ColumnInfo>
          <Column id="LOTTYPE" type="STRING" size="256"/>
          <Column id="PLANTID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNAME" type="STRING" size="256"/>
          <Column id="LOTID" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTNAME" type="STRING" size="256"/>
          <Column id="AREANAME" type="STRING" size="256"/>
          <Column id="RTRSHT" type="STRING" size="256"/>
          <Column id="WORKTYPE" type="STRING" size="256"/>
          <Column id="EQUIPMENT" type="STRING" size="256"/>
          <Column id="SENDPCSQTY" type="STRING" size="256"/>
          <Column id="SENDPANELQTY" type="STRING" size="256"/>
          <Column id="SENDMMQTY" type="STRING" size="256"/>
          <Column id="WIPQTY" type="STRING" size="256"/>
          <Column id="WIPPANELQTY" type="STRING" size="256"/>
          <Column id="WIPMMQTY" type="STRING" size="256"/>
          <Column id="INPUTPCSQTY" type="STRING" size="256"/>
          <Column id="INPUTPANELQTY" type="STRING" size="256"/>
          <Column id="INPUTMMQTY" type="STRING" size="256"/>
          <Column id="LARGEPROCESSSEGMENT" type="STRING" size="256"/>
          <Column id="MIDDLEPROCESSSEGMENT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.1"><![CDATA[/***************************************************************************************
 * 시스템명 	: IFC MES시스템
 * 업무명 		: 일자별 실적재공 현황
 * 파일명 		: PCM05200M.xfdl
 * 작성자 		: 박대호
 * 작성일 		: 2021.04.19
 * 설  명		: 일자별 실적재공 조회
 *---------------------------------------------------------------------------------------
 * 변경일		변경자		변경내역
 *---------------------------------------------------------------------------------------
 * 2021.04.19	박대호   	최초작성
 *---------------------------------------------------------------------------------------
 ****************************************************************************************/

/**************************************************************************
 * 1. 필수 include
 ***************************************************************************/
include "lib::lib_bas.xjs";	//기준관리 공통 라이브러리 include
include "pcm::pcmCommon.xjs"; //pcm 에서 사용하는 공통
/**************************************************************************
 * 2. FORM 변수 선언 영역
 ***************************************************************************/

/**************************************************************************
 * 3. FORM LOAD
 ***************************************************************************/
this.fn_init = function (obj:Form, e:nexacro.LoadEventInfo)
{   
	// 초기화 (공통)
	this.nfn_formInit(obj);	
	
	// 검색조건 공통 콤보 설정
	this.fn_initCombo();
	this.fn_initDatePicker();
	this.InnerrevisionTotalChange();
	
	this.tab_search.tab_page.form.btn_edt_AREAID.addEventHandler("onclick", this.btn_Clear, this);
	this.tab_search.tab_page.form.btn_edt_PROCSEGMENT.addEventHandler("onclick", this.btn_Clear, this);
	
};
this.btn_Clear = function(obj:nexacro.Button, e:nexacro.ClickEventInfo)
{
	switch(obj.name) {
	case "btn_AREAID":
		this.ds_search.setColumn(0,"AREAID", "");
		break;
	case "btn_PROCSEGMENT":	
		this.ds_search.setColumn(0,"PROCESSSEGMENTID", "");
		break;
	default:
	    break;
	}
};

/**************************************************************************
 * 4. 공통버튼영역 (함수 삭제금지!!!!)
 ***************************************************************************/
/*
 * 기능 : 검색(메인 -  고객정보 그리드)
 */
this.fn_search = function (obj:Button, e:nexacro.ClickEventInfo)
{ 
 	var strDate = this.tab_search.tab_page.form.cal_STARTDT.value;	
 	strDate = this.fn_GetOneMonthAfter(strDate);
 	var endDate = this.tab_search.tab_page.form.cal_ENDDT.value;

	var shearchDate = this.fn_DiffDate(strDate, endDate);
 	if(shearchDate > 0)
 	{
 		// 조회기간의 날짜 범위는 {0}일 이내로 제한 됩니다.
		this.gfn_Message("DateLimit", "90", "info");
		return false;
 	}
	
	switch(this.div_work.form.tab_Main.tabindex) {
	case 0 : this.GetstockbyprocessList();
		break;
	case 1 : this.GetstockbyProductList();
		break;
	case 2 : this.GetWorkResultBylotList();
		break;
	}	
	
};

/*
 * 기능 : 저장
 */
this.fn_save = function (obj:Button, e:nexacro.ClickEventInfo)
{  
	
};

/*
 * 기능 : 검색 초기화
 */
this.fn_searchClear = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.fn_initDatePicker();
	this.fn_initCombo();
	this.ds_search.setColumn(0,"PLANTID",this.gf_getSiteType());
	this.InnerrevisionTotalChange();
};

/*
 * 기능 : 신규
 */
this.fn_new = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
  
};


/*
 * 기능 : 삭제
 */
this.fn_delete = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
   
};
/*
 * 기능 : 도움말  => 공통 처리
 */
this.fn_help = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{

};

/*
 * 기능 : 출력
 */
this.fn_print = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
   
};
/**************************************************************************
 * 5. TRANSACTION, CALLBACK 영역
 ***************************************************************************/
this.fn_callBack = function (trId, errCD, errMsg)
{
	if (errCD < 0) 
	{
		this.gfn_Message("ProcessingError", trId + errMsg, "error", "ok");	
	} 
	trace('fn_callBack trId ?' + trId);
	switch(trId) 
	{
		case "selectEcmLookupValuesVList2ds_CSiteTypeALL" :
		{
			this.ds_search.setColumn(0,"PLANTID",this.gf_getSiteType());			
			break;
		}
		case "selectEcmLookupValuesVList2ds_CInnerrevisionTotal" :
		{
			this.fn_middleprocessSegmentCombo();//중공정 콤보조회
			break;
		}
		case "selectProcessSegmentClassByType" :
		{
			this.ds_middleprocessSegment.insertRow(0);
			this.ds_middleprocessSegment.setColumn(0,"PROCESSSEGMENTCLASSID", "");
			this.ds_middleprocessSegment.setColumn(0,"PROCESSSEGMENTCLASSNAME", "전체조회");
			this.ds_search.setColumn(0, "MIDDLEPROCESSSEGMENT", "");
			break;
		}
		case "selectStockbyprocessList" ://공정
		{
			if(this.ds_headgrdList.rowcount > 0)
			{
				this.fn_createStockbyprocessPivotgrdList();
			}
			break;
		}
		case "selectStockbyProductList" ://품목
		{			
			if(this.ds_headgrdList.rowcount > 0)
			{
				this.fn_createStockbyProductPivotgrdList();
			}
			this.fn_innerRevisionTotalChange();
			break;
		}		
		default:
		{
		}
		break;
	}
	
};




/**************************************************************************
 * 6. 팝업 호출/콜백
 **************************************************************************/
this.fn_popupAfter = function(sPopupId, Variant)
{  
	var rtn = this.fv_rtnValue;	
	if (this.nfn_isNull(rtn)) 
	{
		return;
	};
	
	switch (sPopupId)
	{
		case "POPUP_PRODUCTDEFID" :
		{//PRODUCTDEFID|PRODUCTDEFVERSION|PRODUCTDEFNAME			
		this.setProduct_ProdVersion(rtn, this.ds_cbo_ProdVersion, this.ds_search, "B");
		this.ds_search.setColumn(0,"PRODUCTDEFID",rtn[0]);		
		this.ds_search.setColumn(0,"PRODUCTDEFNAME",rtn[2]);
		this.ds_search.setColumn(0,"PRODUCTDEFVERSION",rtn[1]);
		}
		break;	
		case "POPUP_AREAID" :
		{
			rtn = this.gfn_split(rtn, ",");
			if (rtn.length == 2)
			{
				this.tab_search.tab_page.form.edt_AREAID.set_value(rtn[1]);
				this.ds_search.setColumn( 0, "AREAID",          rtn[0] );
			}
			else
			{
				var value = [];
				var dsval = [];
				for (var i = 0; i < rtn.length; i++)
				{
					if ((i % 2) == 0)
					{
						dsval.push(rtn[i]);
					}
					else
					{
						value.push(rtn[i]);
					}
				}
				
				this.tab_search.tab_page.form.edt_AREAID.set_value(value.join(","));
				this.ds_search.setColumn( 0, "AREAID",          dsval.join(",") );
			}
		}
		break;
		case "POPUP_PROCSEGMENT" :
		{
			this.tab_search.tab_page.form.edt_PROCSEGMENT.set_value( rtn[1]);
			this.ds_search.setColumn( 0, "PROCESSSEGMENTID",         rtn[0]);
		}
		break;
	};
};

 /*
 * 기능(공통팝업) : 조회
 */
this.fn_openPop = function(svcId, popId, pArg)
{
	
}

/**************************************************************************
 * 7. 기타 함수(화면 로컬 정의) 
 **************************************************************************/
/*
 * 기능 : 조회 조건 Load
 */
 this.fn_initDatePicker = function ()
{
	this.basfn_getPeriodData("ds_periodType");
 	this.ds_search.setColumn(0,"PERIOD_PERIODFR",this.ds_periodType.getColumn(0,"THISMONTH_S"));
 	this.ds_search.setColumn(0,"PERIOD_PERIODTO",this.ds_periodType.getColumn(0,"THISMONTH_E"));
	this.ds_search.setColumn(0,"PERIODTYPE","THISMONTH");

};
/*
 * 기능 : 검색일자 바인딩 함수
 */
this.fn_setDate = function (periodType)
{
	this.ds_search.setColumn(0,"PERIOD_PERIODFR",this.ds_periodType.getColumn(0,periodType+"_S"));
	this.ds_search.setColumn(0,"PERIOD_PERIODTO",this.ds_periodType.getColumn(0,periodType+"_E"));
};

this.fn_initCombo = function ()
{	
	this.ds_cbo_ProdVersion.deleteAll();
	this.AddAll(this.ds_cbo_ProdVersion,"PRODUCTDEFVERSIONCODE","PRODUCTDEFVERSIONNAME");	
	this.ds_search.setColumn(0, "PRODUCTDEFVERSION", "");
	this.ds_search.setColumn(0, "PRODUCTDEFID", "");	
	this.ds_search.setColumn(0,"PLANTID",this.gf_getSiteType());
	
	
}

/*
 * 기능 : 중공정 콤보 조회
 */
this.fn_middleprocessSegmentCombo = function ()
{
	this.ds_middleprocessSegment.clearData();
	this.ds_search.setColumn(0,"PROCESSSEGMENTCLASSTYPE", "MiddleProcessSegmentClass");	
	
	var sSvcID 			= "selectProcessSegmentClassByType";
	var sController 	= "/pcm05200/selectProcessSegmentClassByType.do";
	var sInDatasets 	= "INPUT=ds_search";
	var sOutDatasets 	= "ds_middleprocessSegment=output";
	var sArgs 			= "";
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
}
/*
 * 기능 : 공정탭 조회
 */
this.GetstockbyprocessList = function ()
{
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.set_formats(this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.formats);
	this.ds_stockbyprocess.clearData();
	this.ds_headgrdList.clearData();
	
	var sSvcID 			= "selectStockbyprocessList";
	var sController 	= "/pcm05200/selectStockbyprocessList.do";
	var sInDatasets 	= "INPUT=ds_search";
	var sOutDatasets 	= "ds_headgrdList=output1 ds_stockbyprocess=output2";
	var sArgs 			= "";
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
}
/*
 * 기능 : 품목탭 조회
 */
this.GetstockbyProductList = function ()
{
	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.set_formats(this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.formats);
	this.ds_stockbyProduct.clearData();
	this.ds_headgrdList.clearData();
	
	var sSvcID 			= "selectStockbyProductList";
	var sController 	= "/pcm05200/selectStockbyProductList.do";
	var sInDatasets 	= "INPUT=ds_search";
	var sOutDatasets 	= "ds_headgrdList=output1 ds_stockbyProduct=output2";
	var sArgs 			= "";
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
}
/*
 *	LOT 탭 조회 
 */
this.GetWorkResultBylotList = function ()
{
	this.ds_workResultBylotList.clearData();	
	this.ds_search.setColumn(0,"TYPE", "BYLOT");
trace("ds_search-->"+this.ds_search.saveXML());	
	var sSvcID 			= "selectWorkResultBylotList";
	var sController 	= "/pcm06100/selectWorkResultBylotList.do";
	var sInDatasets 	= "INPUT=ds_search";
	var sOutDatasets 	= "ds_workResultBylotList=output";
	var sArgs 			= "";
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
};
/*
 * 기능 : Rev.별 집계여부 변경
 */
this.InnerrevisionTotalChange = function ()
{
	switch(this.div_work.form.tab_Main.tabindex) 
	{
		case 0 : case 2 :
		{
			this.tab_search.tab_page.form.sta_INNERREVISIONTOTAL.set_visible(false);
			this.tab_search.tab_page.form.cbo_INNERREVISIONTOTAL.set_visible(false);
			this.tab_search.tab_page.form.btn_search.set_top("cbo_WORKTYPE:20");
			this.tab_search.tab_page.form.btn_clear.set_top("cbo_WORKTYPE:20");
			
			break;
		}		
		case 1 : 
		{
			this.tab_search.tab_page.form.sta_INNERREVISIONTOTAL.set_visible(true);
			this.tab_search.tab_page.form.cbo_INNERREVISIONTOTAL.set_visible(true);
			this.tab_search.tab_page.form.btn_search.set_top("cbo_INNERREVISIONTOTAL:20");
			this.tab_search.tab_page.form.btn_clear.set_top("cbo_INNERREVISIONTOTAL:20");
			break;
		}
	}	
}
/******************************************************************************************
 * 기능 : 3달후 날짜 구하는 함수.
 * 인자 : strDate : yyyyMMdd형태의 날짜 ( 예 : "20121122" )
 * 리턴 : 성공 = yyyyMMdd형태의 해당날짜를 리턴. ( 예 : "20121130" )
           실패 = ""
 * 예문 :
 *****************************************************************************************/
this.fn_GetOneMonthAfter = function (strDate)
{
    if (strDate)
    {
		var date = new Date(strDate.substr(0,4), strDate.substr(4,2), strDate.substr(6,2));        
        var d = (new Date(date)).addMonth(2);
    } 
	else
    {
        var d = (new Date).addMonth(2);
    }

    var s = (new Date(d)).getFullYear()
           + (((new Date(d)).getMonth() + 1) + "").padLeft(2, '0')
           + (((new Date(d)).getDate()) + "").padLeft(2, '0');
    return (s);
}
/*******************************************************************************
 ★ 설명
     2개의 날짜간의 일수 계산
 ★ parameter
    1. sStartDate : yyyyMMdd형태의 From 일자 ( 예 : "20121122" )
    2. sEndDate   : yyyyMMdd형태의 To 일자 ( 예 : "20121202" )
 ★ return
    - 성공 = 숫자 형태의 차이일수  ( 예 : 10 )
             단, sEndDate < sStartDate이면 음수가 return된다.
    - 실패 = NaN
 ******************************************************************************/

this.fn_DiffDate  = function(sStartDate, sEndDate)
{
    var vFromDate = new Date(parseInt(sEndDate.substring(0,4),  10), parseInt(sEndDate.substring(4,6)-1,  10), parseInt(sEndDate.substring(6,8), 10));
    var vToDate = new Date(parseInt(sStartDate.substring(0,4),  10), parseInt(sStartDate.substring(4,6)-1,  10), parseInt(sStartDate.substring(6,8), 10));
    
    return parseInt((vFromDate - vToDate)/(1000*60*60*24));
}

/*
 * 기능 : 공정 피벗테이블 생성
 */
 this.fn_createStockbyprocessPivotgrdList = function ()
{
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.set_enableredraw(false);
	var lastTopCount = 0;//헤더 상단 마지막 셀카운트
	var lastMidCount = 0;//헤더 중단 마지막 셀카운트
	var lastbotCount = 0;//헤더 하단 마지막 셀카운트
	//컬럼추가
	for(var c = 0; c < this.ds_headgrdList.rowcount ; c++)
	{	
	
		var colIdx1 = 0;
		var colIdx2 = 0;
		var colIdx3 = 0;
		var colIdx4 = 0;
		
		colIdx1 = this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.appendContentsCol("body");		
		colIdx2 = this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.appendContentsCol("body");		
		colIdx3 = this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.appendContentsCol("body");		
		colIdx4 = this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.appendContentsCol("body");
		var calCount = this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.getCellCount("head");
		//헤더명
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", c * 4 + 2, "text", this.ds_headgrdList.getColumn(c, "COLUMNS"));
		lastTopCount = c * 4 + 2;
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", c * 4 + 2 + (4 * (c + 1)), "text", "실적");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", c * 4 + 4 + (4 * (c + 1)), "text", "재공");
		lastMidCount = c * 4 + 4 + (4 * (c + 1));
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", c * 4 + 5 + (4 * (c + 1)) + (4 * (c + 1)), "text", "PCS");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", c * 4 + 6 + (4 * (c + 1)) + (4 * (c + 1)), "text", "PNL");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", c * 4 + 7 + (4 * (c + 1)) + (4 * (c + 1)), "text", "PCS");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", c * 4 + 8 + (4 * (c + 1)) + (4 * (c + 1)), "text", "PNL");		
		lastbotCount = c * 4 + 8 + (4 * (c + 1)) + (4 * (c + 1));
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setFormatColProperty(colIdx1 , "size", 80);
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setFormatColProperty(colIdx2 , "size", 80);
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setFormatColProperty(colIdx3 , "size", 80);
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setFormatColProperty(colIdx4 , "size", 80);
		
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx1 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx2 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx3 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx4 , "textAlign", "right");
		
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx1 , "displaytype", "mask");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx2 , "displaytype", "mask");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx3 , "displaytype", "mask");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx4 , "displaytype", "mask");
		
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx1 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx2 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx3 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx4 , "maskeditformat", "#,##0");
		
 		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx1 , "text", "bind:" + "RSLT_PCS_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-",""));
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx2 , "text", "bind:" + "RSLT_PNL_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-",""));
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx3 , "text", "bind:" + "STOCK_PCS_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-",""));
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx4 , "text", "bind:" + "STOCK_PNL_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-",""));
		
		//summary
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx1, "displaytype", "mask"); 
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx2, "displaytype", "mask"); 
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx3, "displaytype", "mask"); 
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx4, "displaytype", "mask"); 
		
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx1 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx2 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx3 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx4 , "maskeditformat", "#,##0");
		
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx1 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx2 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx3 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx4 , "textAlign", "right");
		
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx1 , "expr", "dataset.getSum(\"RSLT_PCS_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-","") + "\")");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx2 , "expr", "dataset.getSum(\"RSLT_PNL_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-","") + "\")");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx3 , "expr", "dataset.getSum(\"STOCK_PCS_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-","") + "\")");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx4 , "expr", "dataset.getSum(\"STOCK_PNL_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-","") + "\")");
		
		
	}
	
	var colIdx1 = 0;
	var colIdx2 = 0;
	var colIdx3 = 0;
	var colIdx4 = 0;
	var colIdx5 = 0;
	var colIdx6 = 0;
	//총계, 평균
	colIdx1 = this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.appendContentsCol("body");
	colIdx2 = this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.appendContentsCol("body");
	colIdx3 = this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.appendContentsCol("body");
	colIdx4 = this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.appendContentsCol("body");
	colIdx5 = this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.appendContentsCol("body");
	colIdx6 = this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.appendContentsCol("body");
	
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", lastTopCount + 4, "text", "총계");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", lastTopCount + 6, "text", "평균");
	
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", lastMidCount + 8, "text", "실적");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", lastMidCount + 10, "text", "실적");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", lastMidCount + 12, "text", "재공");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", lastbotCount + 13, "text", "PCS");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", lastbotCount + 14, "text", "PNL");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", lastbotCount + 15, "text", "PCS");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", lastbotCount + 16, "text", "PNL");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", lastbotCount + 17, "text", "PCS");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("head", lastbotCount + 18, "text", "PNL");
	
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setFormatColProperty(colIdx1 , "size", 80);
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setFormatColProperty(colIdx2 , "size", 80);
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setFormatColProperty(colIdx3 , "size", 80);
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setFormatColProperty(colIdx4 , "size", 80);
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setFormatColProperty(colIdx5 , "size", 80);
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setFormatColProperty(colIdx6 , "size", 80);
	
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx1 , "displaytype", "mask");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx2 , "displaytype", "mask");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx3 , "displaytype", "mask");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx4 , "displaytype", "mask");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx5 , "displaytype", "mask");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx6 , "displaytype", "mask");
		
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx1 , "textAlign", "right");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx2 , "textAlign", "right");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx3 , "textAlign", "right");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx4 , "textAlign", "right");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx5 , "textAlign", "right");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx6 , "textAlign", "right");
		
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx1 , "maskeditformat", "#,##0");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx2 , "maskeditformat", "#,##0");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx3 , "maskeditformat", "#,##0");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx4 , "maskeditformat", "#,##0");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx5 , "maskeditformat", "#,##0");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx6 , "maskeditformat", "#,##0");
	
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx1 , "text", "bind:TOTAL_RSLT_PCS");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx2 , "text", "bind:TOTAL_RSLT_PNL");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx3 , "text", "bind:TOTAL_RSLT_PCS_AVG");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx4 , "text", "bind:TOTAL_RSLT_PNL_AVG");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx5 , "text", "bind:TOTAL_STOCK_PCS_AVG");
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("body", colIdx6 , "text", "bind:TOTAL_STOCK_PNL_AVG");
	
	//summary
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx1, "displaytype", "mask"); 
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx2, "displaytype", "mask"); 
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx3, "displaytype", "mask"); 
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx4, "displaytype", "mask"); 
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx5, "displaytype", "mask"); 
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx6, "displaytype", "mask"); 
		
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx1 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx2 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx3 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx4 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx5 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx6 , "maskeditformat", "#,##0");
		
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx1 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx2 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx3 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx4 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx5 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx6 , "textAlign", "right");
		
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx1 , "expr", "dataset.getSum(\"TOTAL_RSLT_PCS\")");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx2 , "expr", "dataset.getSum(\"TOTAL_RSLT_PNL\")");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx3 , "expr", "dataset.getSum(\"TOTAL_RSLT_PCS_AVG\")");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx4 , "expr", "dataset.getSum(\"TOTAL_RSLT_PNL_AVG\")");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx5 , "expr", "dataset.getSum(\"TOTAL_STOCK_PCS_AVG\")");
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.setCellProperty("summary", colIdx6 , "expr", "dataset.getSum(\"TOTAL_STOCK_PNL_AVG\")");
		
		
	var midCellCount = lastMidCount + 12;	
	//헤더 중단 머지
	for(var c = 0; c < this.ds_headgrdList.rowcount * 2 + 3 ; c++)
	{
		var nStartCol = (colIdx6- 2 * c) - 1;
		var nEndCol = colIdx6- 2 * c;
		var nFirstCell = midCellCount - 2 * c;
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.mergeContentsCell("head", 1, nStartCol, 1, nEndCol, nFirstCell, false);
	}
	
	//헤더 상단 총계 머지
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.mergeContentsCell("head", 0, colIdx6 - 3, 0, colIdx6, colIdx6 - 4, false);
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.mergeContentsCell("head", 0, colIdx6 - 5, 0, colIdx6- 4 , colIdx6 - 6, false);	
	//헤더 상단 머지
	for(var c = 0; c < this.ds_headgrdList.rowcount ; c++)
	{
		var nStartCol = (lastTopCount - 4 * c) + 1;
		var nEndCol = (lastTopCount - 4 * c) + 4;
		var nFirstCell = lastTopCount - 4 * c;		
		this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.mergeContentsCell("head", 0, nStartCol, 0, nEndCol, nFirstCell, false);
		
	}
	this.div_work.form.tab_Main.Tabpage2.form.grd_stockbyprocess.set_enableredraw(true);
}
/*
 * 기능 : 공정 피벗테이블 생성
 */
 this.fn_createStockbyProductPivotgrdList = function ()
{
	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.set_enableredraw(false);
	var lastTopCount = 0;//헤더 상단 마지막 셀카운트
	var lastMidCount = 0;//헤더 중단 마지막 셀카운트
	var lastbotCount = 0;//헤더 하단 마지막 셀카운트
	//컬럼추가
	for(var c = 0; c < this.ds_headgrdList.rowcount ; c++)
	{	
	
		var colIdx1 = 0;
		var colIdx2 = 0;
		var colIdx3 = 0;
		var colIdx4 = 0;
		
		colIdx1 = this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.appendContentsCol("body");		
		colIdx2 = this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.appendContentsCol("body");		
		colIdx3 = this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.appendContentsCol("body");		
		colIdx4 = this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.appendContentsCol("body");
		var calCount = this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.getCellCount("head");
		//헤더명
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", c * 4 + 2, "text", this.ds_headgrdList.getColumn(c, "COLUMNS"));
		//4칸씩 고정증가(c * 4) + 고정셀부터 셀수(+ 2)
		lastTopCount = c * 4 + 2;
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", c * 4 + 2 + (4 * (c + 1)), "text", "실적");
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", c * 4 + 4 + (4 * (c + 1)), "text", "재공");
		//4칸씩 고정증가(c * 4) + 고정셀부터 셀수(+ 4) + 중간칸으로 가기위한 셀고정증가(+ (4 * (c + 1)))
		lastMidCount = c * 4 + 4 + (4 * (c + 1));
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", c * 4 + 9 + (4 * (c + 1)) + (4 * (c + 1)), "text", "PCS");
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", c * 4 + 10 + (4 * (c + 1)) + (4 * (c + 1)), "text", "PNL");
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", c * 4 + 11 + (4 * (c + 1)) + (4 * (c + 1)), "text", "PCS");
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", c * 4 + 12 + (4 * (c + 1)) + (4 * (c + 1)), "text", "PNL");		
		//4칸씩 고정증가(c * 4) + 고정셀부터 셀수(+ 12) + 맨아래칸으로 가기위한 셀고정증가((4 * (c + 1)) + (4 * (c + 1)))
		lastbotCount = c * 4 + 12 + (4 * (c + 1)) + (4 * (c + 1));
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setFormatColProperty(colIdx1 , "size", 80);
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setFormatColProperty(colIdx2 , "size", 80);
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setFormatColProperty(colIdx3 , "size", 80);
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setFormatColProperty(colIdx4 , "size", 80);
		
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx1 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx2 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx3 , "textAlign", "right");
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx4 , "textAlign", "right");
		
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx1 , "displaytype", "mask");
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx2 , "displaytype", "mask");
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx3 , "displaytype", "mask");
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx4 , "displaytype", "mask");
		
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx1 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx2 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx3 , "maskeditformat", "#,##0");
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx4 , "maskeditformat", "#,##0");
		
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx1 , "text", "bind:" + "RSLT_PCS_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-",""));
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx2 , "text", "bind:" + "RSLT_PNL_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-",""));
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx3 , "text", "bind:" + "STOCK_PCS_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-",""));
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx4 , "text", "bind:" + "STOCK_PNL_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-",""));
		
		//summary
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx1, "displaytype", "mask"); 
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx2, "displaytype", "mask"); 
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx3, "displaytype", "mask"); 
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx4, "displaytype", "mask"); 
 		
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx1 , "maskeditformat", "#,##0");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx2 , "maskeditformat", "#,##0");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx3 , "maskeditformat", "#,##0");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx4 , "maskeditformat", "#,##0");
 		
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx1 , "textAlign", "right");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx2 , "textAlign", "right");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx3 , "textAlign", "right");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx4 , "textAlign", "right");
 		
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx1 , "expr", "dataset.getSum(\"RSLT_PCS_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-","") + "\")");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx2 , "expr", "dataset.getSum(\"RSLT_PNL_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-","") + "\")");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx3 , "expr", "dataset.getSum(\"STOCK_PCS_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-","") + "\")");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx4 , "expr", "dataset.getSum(\"STOCK_PNL_" + nexacro.replaceAll(this.ds_headgrdList.getColumn(c, "COLUMNS"),"-","") + "\")");
		
		
	}
	
 	var colIdx1 = 0;
 	var colIdx2 = 0;
 	var colIdx3 = 0;
 	var colIdx4 = 0;
 	var colIdx5 = 0;
 	var colIdx6 = 0;
 	//총계, 평균
 	colIdx1 = this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.appendContentsCol("body");
 	colIdx2 = this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.appendContentsCol("body");
 	colIdx3 = this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.appendContentsCol("body");
 	colIdx4 = this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.appendContentsCol("body");
 	colIdx5 = this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.appendContentsCol("body");
 	colIdx6 = this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.appendContentsCol("body");
 	
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", lastTopCount + 4, "text", "총계");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", lastTopCount + 6, "text", "평균");
 	
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", lastMidCount + 8, "text", "실적");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", lastMidCount + 10, "text", "실적");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", lastMidCount + 12, "text", "재공");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", lastbotCount + 13, "text", "PCS");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", lastbotCount + 14, "text", "PNL");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", lastbotCount + 15, "text", "PCS");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", lastbotCount + 16, "text", "PNL");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", lastbotCount + 17, "text", "PCS");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("head", lastbotCount + 18, "text", "PNL");
 	
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setFormatColProperty(colIdx1 , "size", 80);
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setFormatColProperty(colIdx2 , "size", 80);
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setFormatColProperty(colIdx3 , "size", 80);
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setFormatColProperty(colIdx4 , "size", 80);
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setFormatColProperty(colIdx5 , "size", 80);
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setFormatColProperty(colIdx6 , "size", 80);
 	
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx1 , "displaytype", "mask");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx2 , "displaytype", "mask");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx3 , "displaytype", "mask");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx4 , "displaytype", "mask");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx5 , "displaytype", "mask");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx6 , "displaytype", "mask");
 		
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx1 , "textAlign", "right");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx2 , "textAlign", "right");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx3 , "textAlign", "right");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx4 , "textAlign", "right");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx5 , "textAlign", "right");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx6 , "textAlign", "right");
 		
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx1 , "maskeditformat", "#,##0");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx2 , "maskeditformat", "#,##0");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx3 , "maskeditformat", "#,##0");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx4 , "maskeditformat", "#,##0");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx5 , "maskeditformat", "#,##0");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx6 , "maskeditformat", "#,##0");
 	
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx1 , "text", "bind:TOTAL_RSLT_PCS");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx2 , "text", "bind:TOTAL_RSLT_PNL");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx3 , "text", "bind:TOTAL_RSLT_PCS_AVG");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx4 , "text", "bind:TOTAL_RSLT_PNL_AVG");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx5 , "text", "bind:TOTAL_STOCK_PCS_AVG");
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("body", colIdx6 , "text", "bind:TOTAL_STOCK_PNL_AVG");
 	
 	//summary
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx1, "displaytype", "mask"); 
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx2, "displaytype", "mask"); 
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx3, "displaytype", "mask"); 
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx4, "displaytype", "mask"); 
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx5, "displaytype", "mask"); 
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx6, "displaytype", "mask"); 
 		
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx1 , "maskeditformat", "#,##0");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx2 , "maskeditformat", "#,##0");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx3 , "maskeditformat", "#,##0");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx4 , "maskeditformat", "#,##0");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx5 , "maskeditformat", "#,##0");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx6 , "maskeditformat", "#,##0");
 		
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx1 , "textAlign", "right");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx2 , "textAlign", "right");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx3 , "textAlign", "right");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx4 , "textAlign", "right");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx5 , "textAlign", "right");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx6 , "textAlign", "right");
 		
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx1 , "expr", "dataset.getSum(\"TOTAL_RSLT_PCS\")");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx2 , "expr", "dataset.getSum(\"TOTAL_RSLT_PNL\")");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx3 , "expr", "dataset.getSum(\"TOTAL_RSLT_PCS_AVG\")");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx4 , "expr", "dataset.getSum(\"TOTAL_RSLT_PNL_AVG\")");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx5 , "expr", "dataset.getSum(\"TOTAL_STOCK_PCS_AVG\")");
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setCellProperty("summary", colIdx6 , "expr", "dataset.getSum(\"TOTAL_STOCK_PNL_AVG\")");
 		
 		
 	var midCellCount = lastMidCount + 12;	
 	//헤더 중단 머지
 	for(var c = 0; c < this.ds_headgrdList.rowcount * 2 + 3 ; c++)
 	{
 		var nStartCol = (colIdx6- 2 * c) - 1;
 		var nEndCol = colIdx6- 2 * c;
 		var nFirstCell = midCellCount - 2 * c;
 		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.mergeContentsCell("head", 1, nStartCol, 1, nEndCol, nFirstCell, false);
 	}
 	
 	//헤더 상단 총계 머지	124	122	118
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.mergeContentsCell("head", 0, colIdx6 - 3, 0, colIdx6, colIdx6 - 8, false);		
 	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.mergeContentsCell("head", 0, colIdx6 - 5, 0, colIdx6- 4 , colIdx6 - 10, false);	
	
 	//헤더 상단 머지
   	for(var c = 0; c < this.ds_headgrdList.rowcount ; c++)
   	{
   		var nStartCol = (lastTopCount - 4 * c) + 5;
   		var nEndCol = (lastTopCount - 4 * c) + 8;
   		var nFirstCell = lastTopCount - 4 * c;		
   		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.mergeContentsCell("head", 0, nStartCol, 0, nEndCol, nFirstCell, false);
   		
   	}
	this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.set_enableredraw(true);
}
/*
 * 기능 : Rev.별 집계여부 변경시
 */
this.fn_innerRevisionTotalChange = function ()
{
	if(this.tab_search.tab_page.form.cbo_INNERREVISIONTOTAL.value == "Y")
	{
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setFormatColProperty(2, "size", 80);
	}
	else
	{
		this.div_work.form.tab_Main.Tabpage3.form.grd_stockbyProduct.setFormatColProperty(2, "size", 0);	
	}
}

/**************************************************************************
 * 8. 이벤트
 ***************************************************************************/
/*
 *	기능 : 검색일자 변경시 검색구분을 [사용자지정]으로 변경
 */
this.fn_changeCustom = function(obj:nexacro.Calendar,e:nexacro.ChangeEventInfo)
{
	this.tab_search.tab_page.form.cbo_PERIODTYPE.set_value("CUSTOM");	
};
/*
 *	기능 : 기간콤보박스 변경시 
 */
this.tab_search_tab_page_cbo_PERIODTYPE_onitemchanged = function(obj:nexacro.Combo,e:nexacro.ItemChangeEventInfo)
{
	if(e.postvalue != "CUSTOM")this.fn_setDate(e.postvalue);
};
/*
 *	기능 : 품목코드 검색 버튼 클릭 시
 */
this.tab_search_tab_page_btn_PRODUCTDEFID_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var oArg = {};

	if (this.tab_search.tab_page.form.edt_PRODUCTDEFID.value != "")
	{
		oArg.arg_type        = "BA"; 
	}
	else
	{
		oArg.arg_type        = "B"; 
	}
	oArg.arg_popupCd     = "P00160";
	oArg.arg_popupNm     = "품목 선택";
	oArg.arg_rtnCols     = "PRODUCTDEFID|PRODUCTDEFVERSION|PRODUCTDEFNAME";
	oArg.arg_paramCols   = "P_POPTYPE";
	oArg.arg_paramValues = "PRODUCTDEFINITION";
	oArg.arg_searchStr   = "P_PRODUCTDEFNAME=" + this.tab_search.tab_page.form.edt_PRODUCTDEFID.value;
	this.gfn_openPopup( "POPUP_PRODUCTDEFID", "cmd::CMSA00100P.xfdl", oArg, "width=800,height=800");
};

/*
 *	기능 : 장겁장 검색 버튼 클릭 시
 */
this.tab_search_tab_page_btn_AREAID_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var oArg = {};
	if (this.tab_search.tab_page.form.edt_AREAID.value != "")
	{
		oArg.arg_type        = "CA"; 
	}
	else
	{
		oArg.arg_type        = "C"; 
	}
	oArg.arg_popupCd     = "P00157";
	oArg.arg_popupNm     = "작업장 선택";
	oArg.arg_rtnCols     = "AREAID|AREANAME";
	oArg.arg_paramCols   = "P_POPTYPE|P_LANGUAGETYPE|P_USER|P_PLANTID";
	oArg.arg_paramValues = "AREALISTBYAUTHORITY|" + this.gf_getLanguageType() + "|" + this.gf_getUserAcnt() + "|"+ this.ds_search.getColumn( 0, "PLANTID" );
	oArg.arg_searchStr   = "P_DICTIONARY=" + this.tab_search.tab_page.form.edt_AREAID.value;
	this.gfn_openPopup( "POPUP_AREAID", "cmd::CMSA00100P.xfdl", oArg, "width=800,height=800");
};
/*
 *	기능 : 공정 검색 버튼 클릭 시
 */
this.tab_search_tab_page_btn_PROCSEGMENT_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var oArg = {};
	if (this.tab_search.tab_page.form.edt_PROCSEGMENT.value != "")
	{
		oArg.arg_type        = "BA"; 
	}
	else
	{
		oArg.arg_type        = "B"; 
	}
	oArg.arg_popupCd     = "P00213";
	oArg.arg_popupNm     = "공정 선택";
	oArg.arg_rtnCols     = "PROCESSSEGMENTID|PROCESSSEGMENTNAME";
	oArg.arg_paramCols   = "P_POPTYPE|P_LANGUAGETYPE";
	oArg.arg_paramValues = "PROCESSSEGMENT|" + this.gf_getLanguageType();
	oArg.arg_searchStr   = "P_PROCESSSEGMENT=" + this.tab_search.tab_page.form.edt_PROCSEGMENT.value;
	this.gfn_openPopup( "POPUP_PROCSEGMENT", "cmd::CMSA00100P.xfdl", oArg, "width=800,height=800");
};
/*
 *	기능 : 공정 그리드 더블 클릭 시
 */
this.div_work_tab_Main_Tabpage2_grd_stockbyprocess_oncelldblclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if(this.ds_stockbyprocess.getRowCount() > 0)
	{		
		//조회할 공정 설정
		this.ds_search.setColumn(0,"PROCESSSEGMENTID", this.ds_stockbyprocess.getColumn(e.row, "PROCESSSEGMENTID"));
		this.ds_search.setColumn(0,"PROCESSSEGMENTNAME", this.ds_stockbyprocess.getColumn(e.row, "PROCESSSEGMENTNAME"));
		//LOT탭 조회
		this.GetWorkResultBylotList();
		//탭이동
		this.div_work.form.tab_Main.set_tabindex(2);		
	}
};
/*
 *	기능 : 품목 그리드 더블 클릭 시
 */
this.div_work_tab_Main_Tabpage3_grd_stockbyProduct_oncelldblclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if(this.ds_stockbyProduct.getRowCount() > 0)
	{
		//조회할 품목 설정
		this.ds_search.setColumn(0,"PRODUCTDEFID", this.ds_stockbyProduct.getColumn(e.row, "PRODUCTDEFID"));
		this.ds_search.setColumn(0,"PRODUCTDEFVERSION", this.ds_stockbyProduct.getColumn(e.row, "PRODUCTDEFVERSION"));		
		this.ds_search.setColumn(0,"PRODUCTDEFNAME", this.ds_stockbyProduct.getColumn(e.row, "PRODUCTDEFNAME"));
		//LOT탭 조회	
		this.GetWorkResultBylotList();
		//탭이동
		this.div_work.form.tab_Main.set_tabindex(2);				
	}
};
]]></Script>
    <Bind>
      <BindItem id="item0" compid="tab_search.tab_page.form.cbo_PLANTID" propid="value" datasetid="ds_search" columnid="PLANTID"/>
      <BindItem id="item13" compid="tab_search.tab_page.form.cal_STARTDT" propid="value" datasetid="ds_search" columnid="PERIOD_PERIODFR"/>
      <BindItem id="item14" compid="tab_search.tab_page.form.cbo_PERIODTYPE" propid="value" datasetid="ds_search" columnid="PERIODTYPE"/>
      <BindItem id="item15" compid="tab_search.tab_page.form.cal_ENDDT" propid="value" datasetid="ds_search" columnid="PERIOD_PERIODTO"/>
      <BindItem id="item1" compid="tab_search.tab_page.form.edt_PRODUCTDEFID" propid="value" datasetid="ds_search" columnid="PRODUCTDEFID"/>
      <BindItem id="item2" compid="tab_search.tab_page.form.cbo_PRODUCTDEFVERSION" propid="value" datasetid="ds_search" columnid="PRODUCTDEFVERSION"/>
      <BindItem id="item3" compid="tab_search.tab_page.form.edt_PRODUCTDEFNAME" propid="value" datasetid="ds_search" columnid="PRODUCTDEFNAME"/>
      <BindItem id="item4" compid="tab_search.tab_page.form.edt_AREAID" propid="value" datasetid="ds_search" columnid="AREANAME"/>
      <BindItem id="item6" compid="tab_search.tab_page.form.cbo_MIDDLEPROCESSSEGMENT" propid="value" datasetid="ds_search" columnid="MIDDLEPROCESSSEGMENT"/>
      <BindItem id="item5" compid="tab_search.tab_page.form.edt_PROCSEGMENT" propid="value" datasetid="ds_search" columnid="PROCESSSEGMENTNAME"/>
      <BindItem id="item7" compid="tab_search.tab_page.form.cbo_PRODUCTDIVISION" propid="value" datasetid="ds_search" columnid="PRODUCTDIVISION"/>
      <BindItem id="item8" compid="tab_search.tab_page.form.cbo_INNERREVISIONTOTAL" propid="value" datasetid="ds_search" columnid="INNERREVISIONTOTAL"/>
      <BindItem id="item9" compid="tab_search.tab_page.form.cbo_PRODUCTIONTYPE" propid="value" datasetid="ds_search" columnid="PRODUCTIONTYPE"/>
      <BindItem id="item10" compid="tab_search.tab_page.form.cbo_WORKTYPE" propid="value" datasetid="ds_search" columnid="WORKTYPE"/>
    </Bind>
  </Form>
</FDL>

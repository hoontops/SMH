<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="PCM04500M" width="1278" height="757" titletext="LOT분할" onload="fn_init">
    <Layouts>
      <Layout height="757" mobileorientation="landscape" width="1278">
        <Tab id="tab_search" taborder="0" tabindex="0" left="2" top="64" cssclass="tab_search" bottom="0" width="285">
          <Tabpages>
            <Tabpage id="Tabpage1" text="Tabpage1">
              <Layouts>
                <Layout>
                  <Static id="label00" taborder="5" text="Site" left="0" top="10" width="103" height="20" cssclass="sta_WF_label" tooltiptext="SITE"/>
                  <Combo id="cbo_plantid" taborder="0" text="IFC" left="108" top="10" height="20" index="1" value="" width="165" codecolumn="C,SiteType,,Y,Y"/>
                  <Static id="label02" taborder="6" text="작업장" left="0" top="112" width="103" height="20" cssclass="sta_WF_label" tooltiptext="AREANAME"/>
                  <Edit id="edt_AREANAME" taborder="1" left="108" top="112" height="20" right="37"/>
                  <Button id="btn_AREANAME" taborder="2" width="22" height="20" cssclass="btn_WF_finder" top="111" right="15" onclick="tab_search_Tabpage1_btn_AREANAME_onclick"/>
                  <Button id="btn_clear" taborder="4" top="295" width="107" height="36" cssclass="btn_SA_reset" left="171" text="초기화" tooltiptext="초기화" onclick="fn_searchClear"/>
                  <Button id="btn_search" taborder="3" top="295" width="146" height="36" cssclass="btn_SA_search" left="15" text="검색" tooltiptext="검색" onclick="fn_search"/>
                  <Static id="Static12_00_00_00" taborder="7" text="w&#13;&#10;15" width="15" top="30" visible="false" height="387" cssclass="guideTip" right="0"/>
                  <Static id="Static12_00_00_00_00" taborder="8" text="w&#13;&#10;15" width="15" top="40" visible="false" height="387" cssclass="guideTip" left="0"/>
                  <Static id="Static12_00_00_00_01" taborder="9" text="h10" width="45" top="0" visible="false" height="10" cssclass="guideTip" right="91"/>
                  <Static id="Static12_00_00_00_01_00" taborder="10" text="h5" width="45" top="30" visible="false" height="5" cssclass="guideTip" right="91"/>
                  <Edit id="edt_AREANAME_id" taborder="11" left="108" top="385" height="20" right="37" visible="false"/>
                  <Static id="Static12_00_00_00_01_00_00" taborder="12" text="h5" width="45" top="56" visible="false" height="5" cssclass="guideTip" right="91"/>
                  <Static id="Static12_00_00_00_01_00_00_00" taborder="13" text="h5" width="45" top="82" visible="false" height="5" cssclass="guideTip" right="91"/>
                  <Edit id="edt_PRODUCTDEFID" taborder="14" left="108" top="62" height="20" right="37"/>
                  <Button id="btn_PRODUCTDEFID" taborder="15" width="22" height="20" cssclass="btn_WF_finder" top="62" right="15" onclick="tab_search_Tabpage1_btn_PRODUCTDEFID_onclick"/>
                  <Static id="label02_00" taborder="16" text="품목코드" left="0" top="62" width="103" height="20" cssclass="sta_WF_label" tooltiptext="ITEMCODE"/>
                  <Static id="label02_00_00" taborder="17" text="품목명" left="0" top="87" width="103" height="20" cssclass="sta_WF_label" tooltiptext="ITEMNAME"/>
                  <Edit id="edt_PRODUCTDEFID_nm" taborder="18" left="108" top="87" height="20" right="20" enable="true"/>
                  <Combo id="cbo_ISLOCKING" taborder="19" text="IFC" left="108" top="188" height="20" index="1" value="" width="165" codecolumn="C,YesNo,ALL,Y,Y" onitemchanged="tab_search_Tabpage1_cbo_ISLOCKING_onitemchanged"/>
                  <Static id="label00_01_00" taborder="20" text="Locking 여부" left="0" top="188" width="103" height="20" cssclass="sta_WF_label" tooltiptext="ISLOCKING"/>
                  <Static id="label02_01" taborder="21" text="Lot No." left="0" top="36" width="103" height="20" cssclass="sta_WF_label" tooltiptext="LOTID"/>
                  <Edit id="edt_LOTID" taborder="22" left="108" top="36" height="20" right="37"/>
                  <Button id="btn_LOTID" taborder="23" width="22" height="20" cssclass="btn_WF_finder" top="36" right="15" onclick="tab_search_Tabpage1_btn_LOTID_onclick"/>
                  <Static id="label00_01_00_00" taborder="24" text="양산구분" left="0" top="137" width="103" height="20" cssclass="sta_WF_label" tooltiptext="LOTPRODUCTTYPE"/>
                  <Combo id="cbo_LOTPRODUCTTYPESTATUS" taborder="25" text="IFC" left="108" top="137" height="20" index="1" value="" width="165" codecolumn="C,ProductionType,ALL,Y,Y"/>
                  <Static id="label00_01_00_01" taborder="26" text="자사/외주구분" left="0" top="163" width="103" height="20" cssclass="sta_WF_label" tooltiptext="48DE73F771EB464BBB67974147C9F0B6"/>
                  <Combo id="cbo_OWNTYPE" taborder="27" text="IFC" left="108" top="163" height="20" index="1" value="" width="165" codecolumn="C,OwnType,ALL,Y,Y"/>
                  <Combo id="cbo_ISHOLD" taborder="28" text="IFC" left="108" top="214" height="20" index="1" value="" width="165" codecolumn="C,YesNo,ALL,Y,Y"/>
                  <Static id="label00_01_00_02" taborder="29" text="보류 여부" left="0" top="214" width="103" height="20" cssclass="sta_WF_label" tooltiptext="ISHOLD"/>
                  <Static id="sta_productdeftype" text="제품구분" width="103" height="20" left="0" top="241" cssclass="sta_WF_label" taborder="30"/>
                  <Combo id="cbo_productdeftype" taborder="31" width="165" height="20" left="108" index="0" text="선택" codecolumn="C,ProductDivision2,ALL,Y,Y" top="241"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="sta_searchTitle" taborder="1" text="검색조건" left="9" top="56" width="206" height="34" cssclass="sta_WF_subTitle" fittocontents="width" usedecorate="true"/>
        <Div id="div_header" taborder="2" text="div_00" left="0" top="0" height="47" right="0" formscrolltype="both">
          <Layouts>
            <Layout>
              <Static id="Static01" taborder="6" left="0" top="0" cssclass="sta_WF_titleBG" right="0" bottom="0"/>
              <Button id="btn_reset" taborder="0" top="16" width="31" height="24" cssclass="btn_com_reset" right="2" tooltiptext="Toolbar_Initialization" text="" initvalueid="x"/>
              <Button id="btn_help" taborder="1" top="16" width="26" height="24" cssclass="btn_com_help" right="34" tooltiptext="MANUAL" initvalueid="x"/>
              <Button id="btn_searchOpen" taborder="2" left="10" top="16" width="30" height="24" cssclass="btn_WF_searchOpen" onclick="nfn_searchOpen_onclick"/>
              <Static id="Static16" taborder="3" left="47" top="0" width="60" height="20" cssclass="guideTip" visible="false" text="h20"/>
              <Static id="sta_title" taborder="5" text="업무화면명(자동)" left="40" top="16" width="145" height="24" cssclass="sta_WF_title" fittocontents="width" expr="nexacro.getApplication().gds_menu.lookup(&quot;PGM_ID&quot;,comp.parent.parent.parent.name,&quot;MENU_NM&quot;)"/>
              <Button id="btn_favorite" taborder="4" left="sta_title:2" top="16" width="24" height="24" cssclass="btn_WF_favorite"/>
              <Button id="btn_save" taborder="7" top="16" width="31" height="24" cssclass="btn_com_save" right="61" tooltiptext="Toolbar_Save" initvalueid="x" onclick="fn_save"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_work" taborder="3" text="div_00" left="290" top="47" bottom="0" right="0">
          <Layouts>
            <Layout>
              <Static id="sta_subTitle" taborder="0" text="LOT 분할" left="5" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" fittocontents="width" width="108" tooltiptext="LOTSPLIT"/>
              <Static id="sta_cnt_ds_wip" taborder="1" left="sta_subTitle:20" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" right="761" padding="5px 0px 0px"/>
              <Static id="sta_subTitle00" taborder="2" text="UOM" left="5" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" fittocontents="width" width="48" tooltiptext="UOM" bottom="173"/>
              <Button id="btn_xlDn_grd_wip" taborder="3" top="13" width="29" height="24" cssclass="btn_WF_grdExcelDown" tooltiptext="GridExport" right="5" initvalueid="x"/>
              <Button id="btn_xlDn_grd_splitLot" taborder="4" width="29" height="24" cssclass="btn_WF_grdExcelDown" tooltiptext="GridExport" right="0" initvalueid="x" bottom="171"/>
              <Grid id="grd_splitLot" taborder="5" left="0" right="0" binddataset="ds_splitLot" autoenter="select" bottom="0" onselectchanged="div_work_grd_basApproval_onselectchanged" height="170" oncellclick="div_work_grd_splitLot_oncellclick">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="97"/>
                      <Column size="44"/>
                      <Column size="249"/>
                      <Column size="57"/>
                      <Column size="49"/>
                      <Column size="63"/>
                      <Column size="117"/>
                      <Column size="84"/>
                      <Column size="66"/>
                      <Column size="80"/>
                      <Column size="192"/>
                      <Column size="191"/>
                      <Column size="191"/>
                    </Columns>
                    <Rows>
                      <Row size="24" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="품목코드"/>
                      <Cell col="1" text="Rev"/>
                      <Cell col="2" text="품목명"/>
                      <Cell col="3" text="단위"/>
                      <Cell col="4" text="수량"/>
                      <Cell col="5" text="수량(PNL)"/>
                      <Cell col="6" text="분할사유"/>
                      <Cell col="7" text="재작업 라우팅"/>
                      <Cell col="8" text="라우팅ID"/>
                      <Cell col="9" text="공정ID"/>
                      <Cell col="10" text="공정명"/>
                      <Cell col="11" text="자원명"/>
                      <Cell col="12" text="반환자원명"/>
                    </Band>
                    <Band id="body">
                      <Cell text="bind:PRODUCTDEFID" textAlign="left"/>
                      <Cell col="1" text="bind:PRODUCTDEFVERSION" textAlign="left"/>
                      <Cell col="2" text="bind:PRODUCTDEFNAME" textAlign="left"/>
                      <Cell col="3" text="bind:UNIT" textAlign="left"/>
                      <Cell col="4" text="bind:QTY" displaytype="number" textAlign="right"/>
                      <Cell col="5" text="bind:PANELQTY" displaytype="number" textAlign="right"/>
                      <Cell col="6" text="bind:REASONCODEID" textAlign="left" displaytype="combotext" edittype="combo" combodataset="ds_reason" combocodecol="REASONCODEID" combodatacol="REASONCODENAME"/>
                      <Cell col="7" text="재작업라우팅" textAlign="left" displaytype="buttoncontrol" edittype="none"/>
                      <Cell col="8" text="bind:PROCESSDEFID" textAlign="left"/>
                      <Cell col="9" text="bind:PROCESSSEGMENTID" textAlign="left"/>
                      <Cell col="10" text="bind:PROCESSSEGMENTNAME" textAlign="left"/>
                      <Cell col="11" text="bind:RESOURCENAME" textAlign="left"/>
                      <Cell col="12" text="bind:RETURNRESOURCENAME"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Grid id="grd_pcmLot" taborder="6" left="0" height="139" right="0" bottom="211" binddataset="ds_pcmLot" border="1px solid gray" autofittype="col" scrollbartype="none">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="77"/>
                      <Column size="135"/>
                      <Column size="78"/>
                      <Column size="84"/>
                      <Column size="75"/>
                      <Column size="66"/>
                      <Column size="80"/>
                      <Column size="111"/>
                      <Column size="64"/>
                      <Column size="88"/>
                    </Columns>
                    <Rows>
                      <Row size="23"/>
                      <Row size="23"/>
                      <Row size="23"/>
                      <Row size="23"/>
                      <Row size="23"/>
                      <Row size="23"/>
                    </Rows>
                    <Band id="body">
                      <Cell text="Lot No." border="1px solid gray" background="#c3e6fd" textAlign="left"/>
                      <Cell col="1" text="bind:LOTID" border="1px solid gray" background="#ffffff" textAlign="left" font="normal 11px/normal &quot;Dotum,돋움,Arial&quot;"/>
                      <Cell col="2" text="from공정수순" border="1px solid gray" background="#c3e6fd" textAlign="left"/>
                      <Cell col="3" text="bind:PROCESSPATHID" border="1px solid gray" background="#ffffff" textAlign="left" font="normal 11px/normal &quot;Dotum,돋움,Arial&quot;"/>
                      <Cell col="4" text="이전공정명" border="1px solid gray" background="#c3e6fd" textAlign="left"/>
                      <Cell col="5" text="bind:PREVPROCESSSEGMENTNAME" border="1px solid gray" background="#ffffff" textAlign="left"/>
                      <Cell col="6" text="공정ID" border="1px solid gray" background="#c3e6fd" textAlign="left"/>
                      <Cell col="7" text="bind:PROCESSSEGMENTID" border="1px solid gray" background="#ffffff" textAlign="left"/>
                      <Cell col="8" text="공정명" border="1px solid gray" background="#c3e6fd" textAlign="left"/>
                      <Cell col="9" text="bind:PROCESSSEGMENTNAME" border="1px solid gray" background="#ffffff" textAlign="left" font="normal 10px/normal &quot;Dotum,돋움,Arial&quot;"/>
                      <Cell row="1" border="1px solid gray" background="#c3e6fd" text="공정 Rev." textAlign="left"/>
                      <Cell row="1" col="1" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:PROCESSSEGMENTVERSION"/>
                      <Cell row="1" col="2" border="1px solid gray" background="#c3e6fd" textAlign="left" text="후공정"/>
                      <Cell row="1" col="3" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:NEXTPROCESSSEGMENTNAME"/>
                      <Cell row="1" col="4" border="1px solid gray" background="#c3e6fd" textAlign="left" text="공정수순"/>
                      <Cell row="1" col="5" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:USERSEQUENCE"/>
                      <Cell row="1" col="6" border="1px solid gray" background="#c3e6fd" textAlign="left" text="품목코드"/>
                      <Cell row="1" col="7" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:PRODUCTDEFID"/>
                      <Cell row="1" col="8" border="1px solid gray" background="#c3e6fd" textAlign="left" text="Rev"/>
                      <Cell row="1" col="9" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:PROCESSSEGMENTVERSION"/>
                      <Cell row="2" border="1px solid gray" background="#c3e6fd" textAlign="left" text="품목명"/>
                      <Cell row="2" col="1" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:PRODUCTDEFNAME" font="normal 11px/normal &quot;Dotum,돋움,Arial&quot;"/>
                      <Cell row="2" col="2" border="1px solid gray" background="#c3e6fd" textAlign="left" text="제품Type"/>
                      <Cell row="2" col="3" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:PRODUCTTYPE"/>
                      <Cell row="2" col="4" border="1px solid gray" background="#c3e6fd" textAlign="left" text="투입일자"/>
                      <Cell row="2" col="5" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:INPUTDATE"/>
                      <Cell row="2" col="6" border="1px solid gray" background="#c3e6fd" textAlign="left" text="S/O번호"/>
                      <Cell row="2" col="7" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:PRODUCTIONORDERID"/>
                      <Cell row="2" col="8" border="1px solid gray" background="#c3e6fd" textAlign="left" text="납기일"/>
                      <Cell row="2" col="9" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:DUEDATE"/>
                      <Cell row="3" border="1px solid gray" background="#c3e6fd" textAlign="left" text="품목유형구분"/>
                      <Cell row="3" col="1" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:PRODUCTTYPE"/>
                      <Cell row="3" col="2" border="1px solid gray" background="#c3e6fd" textAlign="left" text="생산구분"/>
                      <Cell row="3" col="3" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:PRODUCTIONTYPE"/>
                      <Cell row="3" col="4" border="1px solid gray" background="#c3e6fd" textAlign="left" text="Locking 여부"/>
                      <Cell row="3" col="5" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:ISLOCKING"/>
                      <Cell row="3" col="6" border="1px solid gray" background="#c3e6fd" textAlign="left" text="작업장"/>
                      <Cell row="3" col="7" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:AREANAME"/>
                      <Cell row="3" col="8" border="1px solid gray" background="#c3e6fd" textAlign="left" text="고객명"/>
                      <Cell row="3" col="9" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:CUSTOMERNAME"/>
                      <Cell row="4" border="1px solid gray" background="#c3e6fd" textAlign="left" text="단위"/>
                      <Cell row="4" col="1" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:UNIT"/>
                      <Cell row="4" col="2" border="1px solid gray" background="#c3e6fd" textAlign="left" text="DEFECTUNIT"/>
                      <Cell row="4" col="3" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:DEFECTUNIT"/>
                      <Cell row="4" col="4" border="1px solid gray" background="#c3e6fd" textAlign="left" text="수량(PNL)"/>
                      <Cell row="4" col="5" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:PNLQTY"/>
                      <Cell row="4" col="6" border="1px solid gray" background="#c3e6fd" textAlign="left" text="PANELPERQTY"/>
                      <Cell row="4" col="7" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:PANELPERQTY"/>
                      <Cell row="4" col="8" border="1px solid gray" background="#c3e6fd" textAlign="left" text="수량(PCS)"/>
                      <Cell row="4" col="9" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:PCSQTY"/>
                      <Cell row="5" border="1px solid gray" background="#c3e6fd" textAlign="left" text="MM"/>
                      <Cell row="5" col="1" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:MM" font="normal 12px/normal &quot;Dotum,돋움,Arial&quot;"/>
                      <Cell row="5" col="2" border="1px solid gray" background="#c3e6fd" textAlign="left" text="PCS/PNL"/>
                      <Cell row="5" col="3" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:PCSPNL"/>
                      <Cell row="5" col="4" border="1px solid gray" background="#c3e6fd" textAlign="left" text="공정구분"/>
                      <Cell row="5" col="5" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:PROCESSSEGMENTTYPE"/>
                      <Cell row="5" col="6" border="1px solid gray" background="#c3e6fd" textAlign="left" text="작업단위"/>
                      <Cell row="5" col="7" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:STEPTYPE" font="normal 11px/normal &quot;Dotum,돋움,Arial&quot;"/>
                      <Cell row="5" col="8" border="1px solid gray" background="#c3e6fd" textAlign="left" text="UOM"/>
                      <Cell row="5" col="9" border="1px solid gray" background="#ffffff" textAlign="left" text="bind:UOM"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Combo id="cbo_UOM" taborder="7" text="IFC" left="78" height="20" index="1" value="" width="165" codecolumn="UOMDEFID" innerdataset="ds_uom" datacolumn="UOMDEFNAME" bottom="179" onitemchanged="div_work_cbo_UOM_onitemchanged"/>
              <Grid id="grd_wip" taborder="8" left="0" top="37" right="0" binddataset="ds_wip" autoenter="select" bottom="356" oncelldblclick="div_work_grd_wip_oncelldblclick">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="59"/>
                      <Column size="66"/>
                      <Column size="110"/>
                      <Column size="46"/>
                      <Column size="260"/>
                      <Column size="80"/>
                      <Column size="141"/>
                      <Column size="47"/>
                      <Column size="128"/>
                      <Column size="66"/>
                      <Column size="215"/>
                      <Column size="47"/>
                      <Column size="68"/>
                      <Column size="54"/>
                      <Column size="96"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="124"/>
                      <Column size="96"/>
                      <Column size="68"/>
                    </Columns>
                    <Rows>
                      <Row size="24" band="head"/>
                      <Row size="24" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell colspan="15" text="재공현황"/>
                      <Cell col="15" colspan="2" text="재공계"/>
                      <Cell col="17" colspan="2" text="인수대기"/>
                      <Cell col="19" colspan="2" text="인수"/>
                      <Cell col="21" colspan="2" text="작업시작"/>
                      <Cell col="23" colspan="2" text="작업완료"/>
                      <Cell col="25" colspan="4" text="재공현황"/>
                      <Cell row="1" text="재작업구분"/>
                      <Cell row="1" col="1" text="양산구분"/>
                      <Cell row="1" col="2" text="품목코드"/>
                      <Cell row="1" col="3" text="Rev"/>
                      <Cell row="1" col="4" text="품목명"/>
                      <Cell row="1" col="5" text="공정수순"/>
                      <Cell row="1" col="6" text="공정명"/>
                      <Cell row="1" col="7" text="Site ID"/>
                      <Cell row="1" col="8" text="작업장"/>
                      <Cell row="1" col="9" text="Roll/Sheet"/>
                      <Cell row="1" col="10" text="Lot No."/>
                      <Cell row="1" col="11" text="단위"/>
                      <Cell row="1" col="12" text="Locking여부"/>
                      <Cell row="1" col="13" text="보류여부"/>
                      <Cell row="1" col="14" text="상태"/>
                      <Cell row="1" col="15" text="수량"/>
                      <Cell row="1" col="16" text="수량(PNL)"/>
                      <Cell row="1" col="17" text="PCS"/>
                      <Cell row="1" col="18" text="PNL"/>
                      <Cell row="1" col="19" text="PCS"/>
                      <Cell row="1" col="20" text="PNL"/>
                      <Cell row="1" col="21" text="PCS"/>
                      <Cell row="1" col="22" text="PNL"/>
                      <Cell row="1" col="23" text="PCS"/>
                      <Cell row="1" col="24" text="PNL"/>
                      <Cell row="1" col="25" text="리드타임"/>
                      <Cell row="1" col="26" text="LOT 투입일"/>
                      <Cell row="1" col="27" text="납기일자"/>
                      <Cell row="1" col="28" text="잔여일수"/>
                    </Band>
                    <Band id="body">
                      <Cell text="bind:PROCESSCLASSID_R"/>
                      <Cell col="1" text="bind:LOTTYPE"/>
                      <Cell col="2" text="bind:PRODUCTDEFID" textAlign="left"/>
                      <Cell col="3" text="bind:PRODUCTDEFVERSION" textAlign="left"/>
                      <Cell col="4" text="bind:PRODUCTDEFNAME" textAlign="left"/>
                      <Cell col="5" text="bind:USERSEQUENCE" textAlign="left"/>
                      <Cell col="6" text="bind:PROCESSSEGMENTNAME" textAlign="left"/>
                      <Cell col="7" text="bind:PLANTID" textAlign="left"/>
                      <Cell col="8" text="bind:AREANAME" textAlign="left"/>
                      <Cell col="9" text="bind:RTRSHT" textAlign="left"/>
                      <Cell col="10" text="bind:LOTID" textAlign="left"/>
                      <Cell col="11" text="bind:UNIT" textAlign="left"/>
                      <Cell col="12" text="bind:ISLOCKING"/>
                      <Cell col="13" text="bind:ISHOLD"/>
                      <Cell col="14" text="bind:STATE" textAlign="left" combocodecol="C,WipProcessState,,Y,N" displaytype="normal"/>
                      <Cell col="15" text="bind:PCSQTY" textAlign="right"/>
                      <Cell col="16" text="bind:PANELQTY" textAlign="right"/>
                      <Cell col="17" text="bind:RECEIVEPCSQTY" textAlign="right"/>
                      <Cell col="18" text="bind:RECEIVEPANELQTY" textAlign="right"/>
                      <Cell col="19" text="bind:SENDPCSQTY" textAlign="right"/>
                      <Cell col="20" text="bind:SENDPANELQTY" textAlign="right"/>
                      <Cell col="21" text="bind:WORKSTARTPCSQTY" textAlign="right"/>
                      <Cell col="22" text="bind:WORKSTARTPANELQTY" textAlign="right"/>
                      <Cell col="23" text="bind:WORKENDPCSQTY" textAlign="right"/>
                      <Cell col="24" text="bind:WORKENDPANELQTY" textAlign="right"/>
                      <Cell col="25" text="bind:LEADTIME" textAlign="right"/>
                      <Cell col="26" text="bind:LOTINPUTDATE" displaytype="date"/>
                      <Cell col="27" text="bind:DELIVERYDATE" displaytype="date"/>
                      <Cell col="28" text="bind:LEFTDATE" textAlign="right"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Button id="btn_addRow" taborder="9" width="26" height="24" cssclass="btn_WF_grdAdd" tooltiptext="GridAdd" right="55" initvalueid="x" bottom="171" onclick="div_work_btn_addRow_ds_splitLot_onclick"/>
              <Button id="btn_delRow_ds_splitLot" taborder="10" width="26" height="24" cssclass="btn_WF_grdDel" tooltiptext="GridDelete" right="29" initvalueid="x" bottom="171"/>
            </Layout>
          </Layouts>
        </Div>
      </Layout>
    </Layouts>
    <Script type="xscript5.1"><![CDATA[/***************************************************************************************
 * 시스템명 	: IFC MES시스템
 * 업무명 		: LOT 분할
 * 파일명 		: PCM04500.xfdl
 * 작성자 		: 진성하
 * 작성일 		: 2021.01.11
 *
 * 설  명		: LOT 분할 기능 제공
 *---------------------------------------------------------------------------------------
 * 변경일		변경자		변경내역
 *---------------------------------------------------------------------------------------
 * 2021.01.11	진성하   	최초작성
 *---------------------------------------------------------------------------------------
 ****************************************************************************************/

/**************************************************************************
 * 1. 필수 include
 ***************************************************************************/
// include "lib::comLib.xjs";
// include "cuslib::nbdfComLib.xjs";

/**************************************************************************
 * 2. FORM 변수 선언 영역
 ***************************************************************************/
this.fv_currDate;

/**************************************************************************
 * 3. FORM LOAD
 ***************************************************************************/
this.fn_init = function (obj:Form, e:nexacro.LoadEventInfo)
{
	this.nfn_formInit(obj);
	//this.div_page.set_visible(true);

	// paging
	//this.fn_paging_onload(obj);
	// paging end
	
	//alert(this.nfn_getCurrentSystemTime(0,10));
	this.tab_search.Tabpage1.form.cbo_plantid.set_value(this.gf_getSiteType());
	this.tab_search.Tabpage1.form.cbo_LOTPRODUCTTYPESTATUS.set_value("Production");
	
	this.ds_search.clearData();
	this.ds_search.addRow();
	this.ds_search.setColumn(0, "UOMCLASSID", "Segment");

	var sSvcID = "getUomDefinitionList";
	var sController = "/pcm04500/selectGetUomDefinitionList.do";
	var sInDatasets = "INPUT=ds_search";
	var sOutDatasets = "ds_uom=output";
	var sArgs = "";
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);	

	this.ds_search.clearData();
	this.ds_search.addRow();
	this.ds_search.setColumn(0, "REASONCODECLASSID", "LotSplit");

	var sSvcID = "selectGetReasonCodeList";
	var sController = "/pcm04500/selectGetReasonCodeList.do";
	var sInDatasets = "INPUT=ds_search";
	var sOutDatasets = "ds_reason=output";
	var sArgs = "";
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);	
};

/**************************************************************************
 * 4. 공통버튼영역 (함수 삭제금지!!!!)
 ***************************************************************************/
/*
 * 기능 : 검색
 */

/**************************************************************************
 * 4. 공통버튼영역 (함수 삭제금지!!!!)
 ***************************************************************************/
/*
 * 기능 : 검색
 */
this.fn_search = function (obj:Button, e:nexacro.ClickEventInfo)
{
	var component = this.tab_search.Tabpage1;
	var strColIdList = "cbo_plantid,cbo_PRODUCTDEFTYPE";
	var strColNmList = "SITE,PRODUCTDEFTYPE";
	var rtn = this.nfn_MandatoryCheck(component, strColIdList, strColNmList);
	if (rtn == false) return;
	
	this.ds_wip.clearData();
	this.ds_pcmLot.clearData();
	this.ds_splitLot.clearData();
	this.ds_pcmLot.addRow();
	this.ds_search.clearData();
	this.ds_search.addRow();
	this.ds_search.setColumn(0, "PLANTID", this.tab_search.Tabpage1.form.cbo_plantid.value);
	this.ds_search.setColumn(0, "LOTID", this.tab_search.Tabpage1.form.edt_LOTID.value);
	this.ds_search.setColumn(0, "PRODUCTDEFID", this.tab_search.Tabpage1.form.edt_PRODUCTDEFID.value);
	this.ds_search.setColumn(0, "AREAID", this.tab_search.Tabpage1.form.edt_AREANAME_id.value);
	this.ds_search.setColumn(0, "LOTPRODUCTTYPESTATUS", this.tab_search.Tabpage1.form.cbo_LOTPRODUCTTYPESTATUS.value);
	this.ds_search.setColumn(0, "OWNTYPE", this.tab_search.Tabpage1.form.cbo_OWNTYPE.value);
	this.ds_search.setColumn(0, "ISHOLD", this.tab_search.Tabpage1.form.cbo_ISHOLD.value);
	this.ds_search.setColumn(0, "ISLOCKING", this.tab_search.Tabpage1.form.cbo_ISLOCKING.value);
	this.ds_search.setColumn(0, "PROCESSSTATE", "WaitForReceive,WaitForSend,Wait");
	this.ds_search.setColumn(0, "PRODUCTDEFNAME", this.tab_search.Tabpage1.form.edt_PRODUCTDEFID_nm.value);
	this.ds_search.setColumn(0, "PRODUCTDEFTYPE", this.tab_search.Tabpage1.form.cbo_productdeftype.value);

	var sSvcID = "selectWIPList";
	var sController = "/pcm04500/selectWIPList.do";
	var sInDatasets = "INPUT=ds_search";
	var sOutDatasets = "ds_wip=output";
	var sArgs = "";
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
};

/*
 * 기능 : 검색 초기화
 */
this.fn_searchClear = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.tab_search_Tabpage1_cbo_period_onitemchanged();
};

/*
 * 기능 : 신규
 */
this.fn_new = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
};

/*
 * 기능 : 저장(승인)
 */
this.fn_save = function (obj:Button, e:nexacro.ClickEventInfo)
{
	if (!this.gfn_dsIsUpdated(this.ds_splitLot) ) 
	{
		this.gfn_Message("NoSaveData", null, "info", "ok");
		return;
	}
/*
	if(this.gfn_isNull(this.div_work.form.cbo_UOM.value)){
		this.gfn_Message("SelectUOM", null, "info", "ok");
		return;
	}
*/
	for(var i=0; i<this.ds_splitLot.rowcount; i++){
		if(this.nfn_nvl(this.ds_splitLot.getColumn(i,"QTY"),0)==0 && this.nfn_nvl(this.ds_splitLot.getColumn(i,"PANELQTY"),0)==0){
			this.gfn_Message("NotSplitQty", null, "info", "ok");
			return;
		}
	}
	var component = this.div_work.form.grd_splitLot;
	var strColIdList = "REASONCODEID";
	var rtn = this.nfn_MandatoryCheckGrid(component, strColIdList);
	if (rtn == false) return;

	// 분할수량 체크 :: 모 LOT 기준 자LOT의 총 수량 체크
	var lotQty = 0;
	var lotPnlQty = 0;
	var totalQty = 0;
	var totalPnlQty = 0;

	//lotQty = decimal.Parse(grdLotInfo.GetFieldValue("PCSQTY").ToString());
	lotQty = this.ds_pcmLot.getColumn(0,"PCSQTY");
	lotPnlQty = this.ds_pcmLot.getColumn(0,"PNLQTY");
	totalQty = this.ds_splitLot.getSum("QTY");
	totalPnlQty = this.ds_splitLot.getSum("PANELQTY");
	
	if (lotQty <= totalQty)
	{
		// 분할 수량 
		this.gfn_Message("SplitQtyLessThanParentQty", null, "info", "ok");	//throw MessageException.Create("SplitQtyLessThanParentQty");
		return;
	}

	// 재작업 ROUTING인 경우 재작업 ROUTING 선택 및 작업장 설정 여부 체크
	if(this.ds_splitLot.findRow("REASONCODEID","SplitRework") >= 0)
	{
		// PROCESSDEFID
		if (this.ds_splitLot.getCaseCount("PROCESSDEFID=='' && REASONCODEID=='SplitRework'") > 0)
		{
			// 라우팅 정보를 찾을수 없습니다.({0})
			this.gfn_Message("checkProcessDef", null, "info", "ok");	//throw MessageException.Create("checkProcessDef"); 
			return;
		}

		//if (targetList.AsEnumerable().Count(r => string.IsNullOrWhiteSpace(r.Field<string>("RESOURCEID")) && r.Field<string>("REASONCODEID").Equals("SplitRework")) > 0)
		if (this.ds_splitLot.getCaseCount("RESOURCEID=='' && REASONCODEID=='SplitRework'") > 0)
		{
			// 선택된 자원이 없습니다.
			this.gfn_Message("NoResourceSelected", null, "info", "ok");	//throw MessageException.Create("NoResourceSelected");
			return;
		}
	}
	
	// -------------------------
	// 저장
	// ':U' 는 갱신된 내용만을 입력 데이터세트로 보내며, ':A' 는 모든 정보를 보냅니다.
	// ':N' 은 현재 Delete를 제외한 데이터를 Normal 상태로 보냅니다. 지정하지 않는 데이터세트는 Normal로 동작합니다
	// -------------------------
	var sSvcID = "saveLotSplit";
	var sController = "/pcm04500/saveLotSplit.do";
	var sInDatasets = "INPUT=ds_splitLot:U";
	var sOutDatasets = "ds_splitLotRtn=output";

	var sArgs = "";
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
};

/*
 * 기능 : 삭제
 */
this.fn_delelete = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
};
/*
 * 기능 : 도움말  => 공통 처리
 */
this.fn_help = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
};

/*
 * 기능 : 출력
 */
this.fn_print = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
// 	var languageType 	= this.gf_getLanguageType(); 
// 	var title 			= this.nfn_nvl(this.nfn_getDictionarynameUpper("LOTCARDPRINT"),"LOT Card 출력");
// 	var LotID           = this.tab_search.Tabpage1.form.edt_LOTID.value;
// 	
// 	var oArg = {
// 		sRptPath   : "/pcm/",
// 		sRptName   : "PCM00600R.mrd",
// 		strField   :   "[" + LotID
// 					+ "][" + languageType
// 					+ "][" + this.nfn_nvl(this.nfn_getDictionarynameUpper("NORMAL"),"정상")
// 					+ "][]",
// 		bModalless : false
// 	};
// 			
// 	var sOption = "titletext="+title+",modeless=false";
// 	this.gfn_reportPopup("reportViewer", "common::com_report.xfdl", oArg, sOption);
///////////////////////////////////////////////////////////////////////////////////////

	var lot = [];
	var wok = [];
	var languageType 	= this.gf_getLanguageType(); 
	var title 			= this.nfn_nvl(this.nfn_getDictionarynameUpper("LOTCARDPRINT"),"LOT Card 출력");

// 	lot.push(this.ds_pcmLot.getColumn( 0, "LOTID" ) );
// 	wok.push( this.ds_pcmLot.getColumn(0, "LOTID" ) + "| " );		
	for (var i = 0; i < this.ds_splitLotRtn.rowcount; i++)
	{		
		lot.push(this.ds_splitLotRtn.getColumn( i, "LOTID" ) );
		wok.push( this.ds_splitLotRtn.getColumn( i, "LOTID" ) + "| " );		
	}
	
	var oArg = {
		sRptPath   : "/pcm/",
		sRptName   : "PCM00600R.mrd",
		strField   :   "[" + lot
					+ "][" + languageType
					+ "][" + wok
					+ "][" + lot
					+ "]",
		bModalless : false
	};
			
	var sOption = "titletext="+title+",modeless=false";
	this.gfn_reportPopup("reportViewer", "common::com_report.xfdl", oArg, sOption);
};

/*
 * 기능 : work영역 초기화  => 공통처리
 */
this.fn_reset = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
};

/**************************************************************************
 * 5. TRANSACTION, CALLBACK 영역
 ***************************************************************************/
this.fn_callBack = function (trId, errCD, errMsg)
{
	if (errCD < 0) 
	{
		this.gfn_Message(errMsg, "error", "ok");
	}
	else 
	{
		if (trId == "saveLotSplit") 
		{
			this.gfn_Message("ProcessingSuccess", null, "info", "ok");
trace("this.ds_splitLotRtn.saveXML()=============>"+this.ds_splitLotRtn.saveXML());
			this.fn_print();
			this.fn_search();
		}
		else if (trId == "selectLotInfoBylotID") 
		{
			if(this.ds_pcmLot.rowcount==0){
				this.gfn_Message("NoSelectData", null, "info", "ok");
				return;
			}
			if(this.ds_pcmLot.getColumn(0,"ISLOCKING")=="Y"){
				this.gfn_Message("LotIsLocking", null, "info", "ok");
			}
		}
	}
}


/**************************************************************************
 * 6. 팝업 호출/콜백
 **************************************************************************/
this.fn_popupAfter = function(sPopupId, Variant)
{
	var rtn = this.fv_rtnValue;	
	if(this.nfn_isNull(rtn)) return;
	
	if(sPopupId == "PRODUCTDEFID")
	{
		var str="";
		var str_id="";
		for(var i=0; i<rtn.length; i++){
			var colArray = rtn[i];
			trace(colArray);
			var str0 = (i==0) ? "" : "," ;
			str_id = str_id + str0 + colArray[0];
			str = str + str0 + colArray[1];
		}
		this.tab_search.Tabpage1.form.edt_PRODUCTDEFID.set_value(str_id);
		//this.tab_search.Tabpage1.form.edt_PRODUCTDEFID_nm.set_value(str);
		this.tab_search.Tabpage1.form.cbo_PRODUCTDEFVERSION.set_index(0);

	}

	if(sPopupId == "LOTID")
	{
		var str="";
		var str_id="";
		
		for(var i=0; i<rtn.length; i++){
			var colArray = rtn[i];
			trace(colArray);
			var str0 = (i==0) ? "" : "," ;
			str_id = str_id + str0 + colArray[0];
		}
		this.tab_search.Tabpage1.form.edt_LOTID.set_value(str_id);
	}

	if(sPopupId == "AREANAME")
	{
		var str="";
		var str_id="";
		
		for(var i=0; i<rtn.length; i++){
			var colArray = rtn[i];
			trace(colArray);
			var str0 = (i==0) ? "" : "," ;
			str_id = str_id + str0 + colArray[0];
			str = str + str0 + colArray[1];
		}
		this.tab_search.Tabpage1.form.edt_AREANAME.set_value(str);
		this.tab_search.Tabpage1.form.edt_AREANAME_id.set_value(str_id);
	}
	if(sPopupId == "GetReworkRouting")
	{
	trace("rtn-->"+rtn);
		var nRow = this.ds_splitLot.rowposition;
		this.ds_splitLot.setColumn(nRow,"PROCESSDEFID",rtn[0]);		
		this.ds_splitLot.setColumn(nRow,"PROCESSDEFVER",rtn[1]);		
		this.ds_splitLot.setColumn(nRow,"PROCESSSEGMENTID",rtn[2]);		
		this.ds_splitLot.setColumn(nRow,"PROCESSSEGMENTNAME",rtn[3]);		
		this.ds_splitLot.setColumn(nRow,"PROCESSPATHID",rtn[4]);		
		this.ds_splitLot.setColumn(nRow,"PATHSEQUENCE",rtn[5]);		
		this.ds_splitLot.setColumn(nRow,"RETURNPROCESSSEGMENTID",rtn[6]);		
		this.ds_splitLot.setColumn(nRow,"RETURNPATHSEQUENCE",rtn[7]);		
		this.ds_splitLot.setColumn(nRow,"REWORKTYPE",rtn[8]);		
		this.ds_splitLot.setColumn(nRow,"RESOURCEID",rtn[9]);		
		this.ds_splitLot.setColumn(nRow,"RESOURCENAME",rtn[10]);		
		this.ds_splitLot.setColumn(nRow,"RETURNRESOURCEID",rtn[11]);		
		this.ds_splitLot.setColumn(nRow,"RETURNRESOURCENAME",rtn[12]);	
		if(rtn[8]=="REWORK"){
			this.ds_splitLot.setColumn(nRow,"RETURNPROCESSPATHID",rtn[13]);	
		}else{
			this.ds_splitLot.setColumn(nRow,"RETURNPROCESSPATHID",rtn[13]);	
		}
		this.ds_splitLot.setColumn(nRow,"RESOURCETYPE","RESOURCE");	
	}


}
/**************************************************************************
 * 7. 기타 함수(화면 로컬 정의) 
 **************************************************************************/

/**************************************************************************
 * 8. 이벤트
 ***************************************************************************/
this.tab_search_Tabpage1_btn_LOTID_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var popupId = "LOTID";
	var oArg = {};
	oArg.arg_type = "CA";
	oArg.arg_popupCd     = "P00159";
	oArg.arg_popupNm     = "Lot No 조회";
	oArg.arg_rtnCols     = "LOTID";
	oArg.arg_paramCols   = "P_POPTYPE|P_LANGUAGETYPE";
	oArg.arg_paramValues = "LOTID|" + this.gf_getLanguageType();
	oArg.arg_searchStr   = "P_LOTID=" + this.tab_search.Tabpage1.form.edt_LOTID.value;
	this.gfn_openPopup(popupId,"cmd::CMSA00100P.xfdl",oArg,"");		
};

this.tab_search_Tabpage1_btn_PRODUCTDEFID_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var popupId = "PRODUCTDEFID";
	var oArg = {};
	oArg.arg_type = "CA";
	oArg.arg_popupCd     = "P00160";
	oArg.arg_popupNm     = "품목 선택";
	oArg.arg_rtnCols     = "PRODUCTDEFID|PRODUCTDEFNAME|PRODUCTDEFVERSION";
	oArg.arg_paramCols   = "P_POPTYPE";
	oArg.arg_paramValues = "PRODUCTDEFINITION";
	oArg.arg_searchStr   = "P_PRODUCTDEFNAME=" + this.tab_search.Tabpage1.form.edt_PRODUCTDEFID.value;
	this.gfn_openPopup(popupId,"cmd::CMSA00100P.xfdl",oArg,"");		
	
};

this.tab_search_Tabpage1_btn_AREANAME_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var popupId = "AREANAME";
	var oArg = {};
	oArg.arg_type = "CA";
	oArg.arg_popupCd     = "P00157";
	oArg.arg_popupNm     = "작업장 선택";
	oArg.arg_rtnCols     = "AREAID|AREANAME";
	oArg.arg_paramCols   = "P_POPTYPE|P_LANGUAGETYPE|P_USER|P_PLANTID";
	oArg.arg_paramValues = "AREALISTBYAUTHORITY|" + this.gf_getLanguageType() + "|" + this.gf_getUserId() + "|"+ this.gf_getSiteType();
	oArg.arg_searchStr   = "P_DICTIONARY=" + this.tab_search.Tabpage1.form.edt_AREANAME.value;
	this.gfn_openPopup(popupId,"cmd::CMSA00100P.xfdl",oArg,"");		
		
};

this.div_work_grd_wip_oncelldblclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if(this.ds_wip.getColumn(e.row,"REWORKDIVISION")=="Rework"){
		this.gfn_Message("LotSplitCheckRework", null, "info", "ok");
		return;
	}
	this.div_work.form.cbo_UOM.set_value("");
	this.ds_pcmLot.clearData();
	this.ds_splitLot.clearData();
	this.ds_search.clearData();
	this.ds_search.addRow();
	this.ds_search.setColumn(0, "LOTID", this.ds_wip.getColumn(e.row,"LOTID"));

	var sSvcID = "selectLotInfoBylotID";
	var sController = "/pcm04500/selectLotInfoBylotID.do";
	var sInDatasets = "INPUT=ds_search";
	var sOutDatasets = "ds_pcmLot=output";
	var sArgs = "";
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);		
};

this.div_work_cbo_UOM_onitemchanged = function(obj:nexacro.Combo,e:nexacro.ItemChangeEventInfo)
{
	if(e.postvalue=="PNL"){
		this.div_work.form.grd_splitLot.setCellProperty("Body",4,"edittype","none");
		this.div_work.form.grd_splitLot.setCellProperty("Body",5,"edittype","normal");
	}else if(e.postvalue=="PCS"){
		this.div_work.form.grd_splitLot.setCellProperty("Body",4,"edittype","normal");
		this.div_work.form.grd_splitLot.setCellProperty("Body",5,"edittype","none");
	}
};

this.div_work_btn_addRow_ds_splitLot_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if(this.gfn_isNull(this.div_work.form.cbo_UOM.value)){
		this.gfn_Message("SelectItem", "UOM", "info", "ok");
		return;
	}
	var nRow = this.ds_splitLot.addRow();
	this.ds_splitLot.setColumn(nRow,"PRODUCTDEFID",this.ds_pcmLot.getColumn(this.ds_pcmLot.rowposition,"PRODUCTDEFID"));
	this.ds_splitLot.setColumn(nRow,"PRODUCTDEFVERSION",this.ds_pcmLot.getColumn(this.ds_pcmLot.rowposition,"PRODUCTDEFVERSION"));
	this.ds_splitLot.setColumn(nRow,"PRODUCTDEFNAME",this.ds_pcmLot.getColumn(this.ds_pcmLot.rowposition,"PRODUCTDEFNAME"));
	this.ds_splitLot.setColumn(nRow,"UNIT",this.div_work.form.cbo_UOM.value);
	this.ds_splitLot.setColumn(nRow,"LOTID",this.ds_pcmLot.getColumn(this.ds_pcmLot.rowposition,"LOTID"));
};

this.div_work_grd_splitLot_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	//if(!this.nfn_isEqualCol(obj,e.col,"REWORKROUTING")) return;
	if(this.ds_splitLot.getColumn(e.row,"REASONCODEID")!="SplitRework") return;
	if(e.col == 7){
		var popupId = "GetReworkRouting";
		var oArg = {};
		oArg.ProductDefID = this.ds_pcmLot.getColumn(0,"PRODUCTDEFID");
		oArg.ProductDefVersion     = this.ds_pcmLot.getColumn(0,"PRODUCTDEFVERSION");
		oArg.ProductName     = this.ds_pcmLot.getColumn(0,"PRODUCTDEFNAME");
		oArg.PathSequence     = this.ds_pcmLot.getColumn(0,"USERSEQUENCE");
		oArg.ProcessSegmentId     = this.ds_pcmLot.getColumn(0,"PROCESSSEGMENTID");
		oArg.LotId   = this.ds_pcmLot.getColumn(0,"LOTID");
		this.gfn_openPopup(popupId,"pcm::PCM04501P.xfdl",oArg,"");	
	}
};


this.ds_splitLot_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	obj.set_enableevent(false);
	if(e.columnid=="QTY"){
		var lotQty = this.ds_pcmLot.getColumn(0,"PCSQTY");
		var qty = e.newvalue;
		var totalPnlQty = this.ds_splitLot.getSum("QTY");

		if (lotQty <= totalPnlQty)
		{
			this.ds_splitLot.setColumn(e.row, "QTY", "");
			this.ds_splitLot.setColumn(e.row, "PANELQTY", "");

			// 분할 수량 
			this.gfn_Message("SplitQtyLessThanParentQty", null, "info", "ok");
			return;
		}
		var panelPerQty = this.ds_pcmLot.getColumn(0,"PANELPERQTY");
		var pnlQty = 0;
		if (panelPerQty > 0)
		{
			pnlQty = nexacro.ceil(qty / panelPerQty);
		}
		this.ds_splitLot.setColumn(e.row, "PANELQTY", pnlQty);	
	}else if(e.columnid=="PANELQTY"){
		var lotQty = this.ds_pcmLot.getColumn(0,"PNLQTY");
		var pnlqty = e.newvalue;
		var totalPnlQty = this.ds_splitLot.getSum("PANELQTY");

		if (lotQty <= totalPnlQty)
		{
			this.ds_splitLot.setColumn(e.row, "QTY", "");
			this.ds_splitLot.setColumn(e.row, "PANELQTY", "");

			// 분할 수량 
			this.gfn_Message("SplitQtyLessThanParentQty", null, "info", "ok");
			return;
		}
		var panelPerQty = this.ds_pcmLot.getColumn(0,"PANELPERQTY");
		var qty = pnlqty * panelPerQty;
		this.ds_splitLot.setColumn(e.row, "QTY", qty);

	}else if(e.columnid=="REASONCODEID"){
		if (e.newvalue=="SplitRework")
		{
			//GetReworkRouting();
			this.div_work.form.grd_splitLot.setCellProperty("body",7,"edittype","button");
			
			var popupId = "GetReworkRouting";
			var oArg = {};
			oArg.ProductDefID = this.ds_pcmLot.getColumn(0,"PRODUCTDEFID");
			oArg.ProductDefVersion     = this.ds_pcmLot.getColumn(0,"PRODUCTDEFVERSION");
			oArg.PathSequence     = this.ds_pcmLot.getColumn(0,"USERSEQUENCE");
			oArg.ProcessSegmentId     = this.ds_pcmLot.getColumn(0,"PROCESSSEGMENTID");
			oArg.LotId   = this.ds_pcmLot.getColumn(0,"LOTID");
			this.gfn_openPopup(popupId,"pcm::PCM04501P.xfdl",oArg,"");	
			
		}
		else
		{
			this.div_work.form.grd_splitLot.setCellProperty("body",7,"edittype","none");
			this.ds_splitLot.setColumn(e.row, "PROCESSDEFID", "");
			this.ds_splitLot.setColumn(e.row, "PROCESSDEFVER", "");
			this.ds_splitLot.setColumn(e.row, "PROCESSSEGMENTID", "");
			this.ds_splitLot.setColumn(e.row, "PROCESSSEGMENTNAME", "");
			this.ds_splitLot.setColumn(e.row, "PROCESSPATHID", "");
			this.ds_splitLot.setColumn(e.row, "REWORKTYPE", "");
			this.ds_splitLot.setColumn(e.row, "RESOURCEID", "");
			this.ds_splitLot.setColumn(e.row, "RESOURCENAME", "");
			this.ds_splitLot.setColumn(e.row, "RETURNRESOURCEID", "");
			this.ds_splitLot.setColumn(e.row, "RETURNRESOURCENAME", "");
			this.ds_splitLot.setColumn(e.row, "RETURNPROCESSPATHID", "");
		}	
	}	
	obj.set_enableevent(true);

};
]]></Script>
    <Objects>
      <Dataset id="ds_search">
        <ColumnInfo>
          <Column id="PLANTID" type="STRING" size="256"/>
          <Column id="LOTID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="AREAID" type="STRING" size="256"/>
          <Column id="LOTPRODUCTTYPESTATUS" type="STRING" size="256"/>
          <Column id="PRODUCTDEFTYPE" type="STRING" size="256"/>
          <Column id="OWNTYPE" type="STRING" size="256"/>
          <Column id="PARENTREASONCODECLASSID" type="STRING" size="256"/>
          <Column id="REASONCODECLASSID" type="STRING" size="256"/>
          <Column id="ISHOLD" type="STRING" size="256"/>
          <Column id="ISLOCKING" type="STRING" size="256"/>
          <Column id="PROCESSSTATE" type="STRING" size="256"/>
          <Column id="UOMCLASSID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_wip">
        <ColumnInfo>
          <Column id="LOTID" type="STRING" size="256"/>
          <Column id="LOTTYPE" type="STRING" size="256"/>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNAME" type="STRING" size="256"/>
          <Column id="PROCESSDEFID" type="STRING" size="256"/>
          <Column id="PROCESSDEFVERSION" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTNAME" type="STRING" size="256"/>
          <Column id="USERSEQUENCE" type="STRING" size="256"/>
          <Column id="PLANTID" type="STRING" size="256"/>
          <Column id="AREAID" type="STRING" size="256"/>
          <Column id="AREANAME" type="STRING" size="256"/>
          <Column id="RTRSHT" type="STRING" size="256"/>
          <Column id="ISLOCKING" type="STRING" size="256"/>
          <Column id="ISHOLD" type="STRING" size="256"/>
          <Column id="PROCESSSTATE" type="STRING" size="256"/>
          <Column id="STATE" type="STRING" size="256"/>
          <Column id="UNIT" type="STRING" size="256"/>
          <Column id="QTY" type="STRING" size="256"/>
          <Column id="PANELQTY" type="STRING" size="256"/>
          <Column id="PANELPERQTY" type="STRING" size="256"/>
          <Column id="DELIVERYDATE" type="STRING" size="256"/>
          <Column id="LOTINPUTDATE" type="STRING" size="256"/>
          <Column id="REWORKDIVISION" type="STRING" size="256"/>
          <Column id="PROCESSCLASSID_R" type="STRING" size="256"/>
          <Column id="LEFTDATE" type="STRING" size="256"/>
          <Column id="RECEIVEPCSQTY" type="STRING" size="256"/>
          <Column id="RECEIVEPANELQTY" type="STRING" size="256"/>
          <Column id="SENDPCSQTY" type="STRING" size="256"/>
          <Column id="SENDPANELQTY" type="STRING" size="256"/>
          <Column id="WORKSTARTPCSQTY" type="STRING" size="256"/>
          <Column id="WORKSTARTPANELQTY" type="STRING" size="256"/>
          <Column id="WORKENDPCSQTY" type="STRING" size="256"/>
          <Column id="WORKENDPANELQTY" type="STRING" size="256"/>
          <Column id="LEADTIME" type="STRING" size="256"/>
          <Column id="ISLOTROUTING" type="STRING" size="256"/>
          <Column id="PROCESSPATHSTACK" type="STRING" size="256"/>
          <Column id="PCSQTY" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_pcmLot">
        <ColumnInfo>
          <Column id="LOTID" type="STRING" size="256"/>
          <Column id="PROCESSPATHID" type="STRING" size="256"/>
          <Column id="PREVPROCESSSEGMENTNAME" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTNAME" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTVERSION" type="STRING" size="256"/>
          <Column id="NEXTPROCESSSEGMENTNAME" type="STRING" size="256"/>
          <Column id="USERSEQUENCE" type="STRING" size="256"/>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNAME" type="STRING" size="256"/>
          <Column id="PRODUCTTYPE" type="STRING" size="256"/>
          <Column id="INPUTDATE" type="STRING" size="256"/>
          <Column id="PRODUCTIONORDERID" type="STRING" size="256"/>
          <Column id="DUEDATE" type="STRING" size="256"/>
          <Column id="PRODUCTDEFTYPE" type="STRING" size="256"/>
          <Column id="PRODUCTIONTYPE" type="STRING" size="256"/>
          <Column id="ISLOCKING" type="STRING" size="256"/>
          <Column id="AREANAME" type="STRING" size="256"/>
          <Column id="CUSTOMERNAME" type="STRING" size="256"/>
          <Column id="UNIT" type="STRING" size="256"/>
          <Column id="DEFECTUNIT" type="STRING" size="256"/>
          <Column id="PNLQTY" type="STRING" size="256"/>
          <Column id="PANELPERQTY" type="STRING" size="256"/>
          <Column id="PCSQTY" type="STRING" size="256"/>
          <Column id="MM" type="STRING" size="256"/>
          <Column id="PCSPNL" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTTYPE" type="STRING" size="256"/>
          <Column id="STEPTYPE" type="STRING" size="256"/>
          <Column id="UOM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_uom">
        <ColumnInfo>
          <Column id="UOMDEFID" type="STRING" size="256"/>
          <Column id="UOMDEFNAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_splitLot" oncolumnchanged="ds_splitLot_oncolumnchanged" useclientlayout="true">
        <ColumnInfo>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNAME" type="STRING" size="256"/>
          <Column id="UNIT" type="STRING" size="256"/>
          <Column id="PANELQTY" type="BIGDECIMAL" size="256"/>
          <Column id="REASONCODEID" type="STRING" size="256"/>
          <Column id="REWORKROUTING" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="QTY" type="BIGDECIMAL" size="256"/>
          <Column id="PROCESSDEFID" type="STRING" size="256"/>
          <Column id="PROCESSDEFVER" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTNAME" type="STRING" size="256"/>
          <Column id="PROCESSPATHID" type="STRING" size="256"/>
          <Column id="PATHSEQUENCE" type="STRING" size="256"/>
          <Column id="RETURNPROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="RETURNPATHSEQUENCE" type="STRING" size="256"/>
          <Column id="REWORKTYPE" type="STRING" size="256"/>
          <Column id="RETURNPROCESSPATHID" type="STRING" size="256"/>
          <Column id="RESOURCENAME" type="STRING" size="256"/>
          <Column id="RETURNRESOURCENAME" type="STRING" size="256"/>
          <Column id="RESOURCEID" type="STRING" size="256"/>
          <Column id="RETURNRESOURCEID" type="STRING" size="256"/>
          <Column id="RESOURCETYPE" type="STRING" size="256"/>
          <Column id="PROCESSDEFVERSION" type="STRING" size="256"/>
          <Column id="LOTID" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_reason">
        <ColumnInfo>
          <Column id="REASONCODEID" type="STRING" size="256"/>
          <Column id="REASONCODENAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_splitLotRtn">
        <ColumnInfo>
          <Column id="PRODUCTDEFID" type="STRING" size="256"/>
          <Column id="PRODUCTDEFVERSION" type="STRING" size="256"/>
          <Column id="PRODUCTDEFNAME" type="STRING" size="256"/>
          <Column id="UNIT" type="STRING" size="256"/>
          <Column id="PANELQTY" type="BIGDECIMAL" size="256"/>
          <Column id="REASONCODEID" type="STRING" size="256"/>
          <Column id="REWORKROUTING" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="QTY" type="BIGDECIMAL" size="256"/>
          <Column id="PROCESSDEFID" type="STRING" size="256"/>
          <Column id="PROCESSDEFVER" type="STRING" size="256"/>
          <Column id="PROCESSSEGMENTNAME" type="STRING" size="256"/>
          <Column id="PROCESSPATHID" type="STRING" size="256"/>
          <Column id="PATHSEQUENCE" type="STRING" size="256"/>
          <Column id="RETURNPROCESSSEGMENTID" type="STRING" size="256"/>
          <Column id="RETURNPATHSEQUENCE" type="STRING" size="256"/>
          <Column id="REWORKTYPE" type="STRING" size="256"/>
          <Column id="RETURNPROCESSPATHID" type="STRING" size="256"/>
          <Column id="RESOURCENAME" type="STRING" size="256"/>
          <Column id="RETURNRESOURCENAME" type="STRING" size="256"/>
          <Column id="RESOURCEID" type="STRING" size="256"/>
          <Column id="RETURNRESOURCEID" type="STRING" size="256"/>
          <Column id="RESOURCETYPE" type="STRING" size="256"/>
          <Column id="PROCESSDEFVERSION" type="STRING" size="256"/>
          <Column id="LOTID" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
  </Form>
</FDL>

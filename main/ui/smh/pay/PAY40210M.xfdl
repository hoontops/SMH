<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="PAY40210M" width="920" height="720" titletext="근태승인" onload="fn_init">
    <Layouts>
      <Layout height="720" mobileorientation="landscape" width="920">
        <Div id="div_search" taborder="0" text="Div00" left="0.00%" top="36" right="10" height="42" cssclass="div_WF_search" background="rgba(247,247,247,1)">
          <Layouts>
            <Layout width="1005" height="80">
              <Static id="Static00" taborder="0" cssclass="sta_WF_Label" left="21" top="10" width="70" height="20" textAlign="right" verticalAlign="middle" text="조회년월" tooltiptext="조회년월"/>
              <Static id="Static13" taborder="1" text="10" visible="false" left="0%" top="0" right="0%" height="10" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static02" taborder="2" text="20" visible="false" left="0%" top="-1" right="97.83%" height="43" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" font="8pt &quot;Dotum&quot;" opacity="0.5"/>
              <Static id="Static04" taborder="3" text="10" visible="false" left="0%" right="76.88%" bottom="0" height="10" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static06" taborder="4" text="10" visible="false" left="10.24%" top="1" right="88.66%" bottom="-1" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static07" taborder="5" text="20" visible="false" left="191" top="0" right="697" height="43" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" font="8pt &quot;Dotum&quot;" opacity="0.5"/>
              <Static id="Static00_00_00" taborder="6" cssclass="sta_WF_Label" left="212" top="10" width="70" height="20" textAlign="right" verticalAlign="middle" text="부서" tooltiptext="부서"/>
              <Edit id="edt_organization" taborder="7" left="292" top="10" width="120" height="20"/>
              <Button id="btn_organization" taborder="8" left="412" width="22" height="20" cssclass="btn_WF_finder" top="10" onclick="div_search_btn_organization_onclick"/>
              <Static id="Static00_00" taborder="9" cssclass="sta_WF_Label" left="454" top="10" width="70" height="20" textAlign="right" verticalAlign="middle" text="상태" tooltiptext="상태"/>
              <Combo id="cbo_status" taborder="10" left="534" top="10" height="20" codecolumn="C,HJS_HR_APPROVAL_STATUS,ALL,Y,Y" onitemchanged="Combo01_onitemchanged" width="124" index="-1" onmousemove="fn_msgCdCboToolTip"/>
              <Div id="div_condDate" taborder="11" left="101" top="10" width="90" height="21" url="common::com_monthCalendar.xfdl" text="____-__"/>
            </Layout>
          </Layouts>
          <InitValue/>
        </Div>
        <Button id="btn_search" taborder="1" text="조회" onclick="fn_search" top="8" right="10" width="60" height="20" tooltiptype="hover" tooltiptext="조회"/>
        <Button id="btn_clear" taborder="2" text="초기화" top="8" right="76" width="60" height="20" tooltiptext="초기화" onclick="fn_searchClear"/>
        <Static id="Static78" taborder="3" text="15" visible="false" left="0.00%" top="27" right="1.09%" height="9" background="lightseagreen" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
        <Button id="btn_searchOpen" taborder="4" left="10" top="6" width="30" height="24" cssclass="btn_WF_searchOpen" onclick="nfn_searchOpen_onclick"/>
        <Static id="sta_title" taborder="5" text="업무화면명(자동)" left="40" top="6" width="145" height="24" cssclass="sta_WF_title" fittocontents="width" expr="nexacro.getApplication().gds_menu.lookup(&quot;PGM_ID&quot;,comp.parent.name,&quot;MENU_NM&quot;)"/>
        <Button id="btn_favorite" taborder="6" left="sta_title:2" top="6" width="24" height="24" cssclass="btn_WF_favorite"/>
        <Tab id="div_work" taborder="7" tabindex="0" left="0" top="78" bottom="0" cssclass="tab_master" right="10" onchanged="tab_work_onchanged">
          <Tabpages>
            <Tabpage id="Tabpage0" text="근태신청내역" tooltiptext="근태신청내역">
              <Layouts>
                <Layout>
                  <Button id="btn_listApproval" taborder="0" text="승인" top="7" right="66" width="60" height="20" tooltiptext="승인" onclick="div_work_Tabpage0_btn_listApproval_onclick"/>
                  <Button id="btn_listReturn" taborder="1" text="반려" top="7" right="0" width="60" height="20" tooltiptext="반려" onclick="div_work_Tabpage0_btn_listReturn_onclick"/>
                  <Static id="Static20_00_00" taborder="3" text="근태신청내역" left="0" width="211" height="34" cssclass="sta_WF_subTitle" top="0" tooltiptext="근태신청내역"/>
                  <Grid id="grd_attendanceApproveList" taborder="2" left="0" top="34" autoenter="select" right="0" binddataset="ds_attendanceApproveList" autofittype="col" bottom="10" oncellclick="div_work_Tabpage0_grd_attendanceApproveList_oncellclick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="60"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="60"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="60"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="60"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell/>
                          <Cell col="1" text="상태" tooltiptext="상태"/>
                          <Cell col="2" text="신청일자" tooltiptext="신청일자"/>
                          <Cell col="3" text="부서" tooltiptext="부서"/>
                          <Cell col="4" text="직급" tooltiptext="직급"/>
                          <Cell col="5" text="사번" tooltiptext="사번"/>
                          <Cell col="6" text="성명" tooltiptext="성명"/>
                          <Cell col="7" text="승인권자" tooltiptext="승인권자"/>
                          <Cell col="8" text="근태유형" tooltiptext="근태유형"/>
                          <Cell col="9" text="시작일자" tooltiptext="시작일자"/>
                          <Cell col="10" text="종료일자" tooltiptext="종료일자"/>
                          <Cell col="11" text="일수/시간" tooltiptext="일수/시간"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:CHK" displaytype="checkboxcontrol" edittype="checkbox"/>
                          <Cell col="1" text="bind:STATUS_NAME"/>
                          <Cell col="2" text="bind:APPLY_DATE"/>
                          <Cell col="3" text="bind:ORG_NAME"/>
                          <Cell col="4" text="bind:GRADE_NAME"/>
                          <Cell col="5" text="bind:EMPLOYEE_NUMBER"/>
                          <Cell col="6" text="bind:EMP_NAME"/>
                          <Cell col="7" text="bind:MGR_NAME"/>
                          <Cell col="8" text="bind:CALENDER_NAME"/>
                          <Cell col="9" text="bind:START_DATE" calendardateformat="yyyy-MM-dd HH:mm"/>
                          <Cell col="10" text="bind:END_DATE" calendardateformat="yyyy-MM-dd HH:mm"/>
                          <Cell col="11" text="bind:REQUEST_DAY"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="sta_cnt_ds_attendanceApproveList" taborder="4" text="Count : &lt;fc v=&quot;#f31d24&quot;&gt;0&lt;/fc&gt;" left="219" top="0" height="34" cssclass="sta_WF_subTitle" usedecorate="true" padding="5px 0px 0px" width="140"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="Tabpage1" text="근태신청" tooltiptext="근태신청">
              <Layouts>
                <Layout>
                  <Static id="Static20_00_00" taborder="1" text="근태 신청 정보" left="0" width="241" height="34" cssclass="sta_WF_subTitle" top="0" tooltiptext="근태 신청 정보"/>
                  <Div id="div_basicInfo" taborder="0" left="0" top="34" height="63" cssclass="div_WF_detail_line" text="" right="0">
                    <Layouts>
                      <Layout>
                        <Static id="sta_site" taborder="0" text="신청일자" left="0" top="0" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="신청일자"/>
                        <Static id="sta_certdate" taborder="1" text="구분" left="0" top="31" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" tooltiptext="구분"/>
                        <Calendar id="cal_applyDate" taborder="2" left="135" top="5" width="130" height="20" dateformat="yyyy-MM-dd" cssclass="display" readonly="true"/>
                        <Combo id="cbo_calenderName" taborder="3" left="135" top="36" height="20" codecolumn="C,HJS_HR_ATTENDANCE_TYPE,SEL,Y,Y" onitemchanged="Combo01_onitemchanged" width="130" index="-1" onmousemove="fn_msgCdCboToolTip" cssclass="display" enable="false" readonly="true"/>
                        <Static id="sta_site00" taborder="4" text="작성자" left="300" top="0" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="작성자"/>
                        <Edit id="edt_empName" taborder="5" left="435" top="5" width="130" height="20" cssclass="display" readonly="true"/>
                        <Static id="sta_alterWorkDay" taborder="6" text="대체근무일" left="300" top="31" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="대체근무일"/>
                        <Calendar id="cal_alterWorkDay" taborder="7" left="435" top="36" width="130" height="20" dateformat="yyyy-MM-dd" cssclass="display" readonly="true"/>
                      </Layout>
                    </Layouts>
                  </Div>
                  <Div id="div_00" taborder="2" left="0" top="96" height="164" right="0" text="" background="#ffffff">
                    <Layouts>
                      <Layout>
                        <Div id="div_basicInfo00" taborder="0" left="0" top="0" height="63" cssclass="div_WF_detail_line_notop" text="" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_site" taborder="0" text="기간" left="0" top="0" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" tooltiptext="기간"/>
                              <Calendar id="cal_startDate0" taborder="1" left="135" top="5" width="100" height="20" dateformat="yyyy-MM-dd" cssclass="display" readonly="true"/>
                              <Static id="Static16_01" taborder="2" text="부터" left="241" top="5" width="27" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Calendar id="cal_endDate0" taborder="3" left="281" top="5" width="100" height="20" dateformat="yyyy-MM-dd" cssclass="display" readonly="true"/>
                              <Static id="Static16_01_00" taborder="4" text="까지" left="387" top="5" width="27" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Edit id="edt_requestDay0" taborder="5" left="430" top="5" width="30" height="20" textAlign="center" enable="false" cssclass="display" readonly="true"/>
                              <Static id="Static16_01_00_00" taborder="6" text="일간)" left="466" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Static id="sta_site00" taborder="7" text="내용" left="0" top="31" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="내용"/>
                              <Edit id="edt_approvalContents0" taborder="8" left="135" top="36" width="565" height="20" textAlign="left" cssclass="display" readonly="true"/>
                              <Static id="Static16_01_00_00_00" taborder="9" text="(" left="423" top="5" width="10" height="20" cssclass="sta_font_black" textAlign="left"/>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="div_comment" taborder="1" left="0" top="62" height="63" cssclass="div_WF_detail_line_notop" text="" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_site00" taborder="6" text="Comment" left="0" top="0" width="130" height="62" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="Comment"/>
                              <Static id="sta_00" taborder="1" left="130" top="0" height="61" background="#ffffff" right="0"/>
                              <TextArea id="txa_00" taborder="2" left="135" top="5" width="768" height="52"/>
                            </Layout>
                          </Layouts>
                        </Div>
                      </Layout>
                    </Layouts>
                  </Div>
                  <Div id="div_01" taborder="3" left="0" top="216" height="164" right="0" text="" background="#ffffff" visible="false">
                    <Layouts>
                      <Layout>
                        <Div id="div_basicInfo00_00" taborder="1" left="0" top="0" height="63" cssclass="div_WF_detail_line_notop" text="" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_site" taborder="0" text="기간" left="0" top="0" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" tooltiptext="기간"/>
                              <Static id="Static16_01" taborder="1" text="부터" left="294" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Static id="Static16_01_00" taborder="2" text="까지" left="493" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Edit id="edt_requestDay1" taborder="3" left="533" top="5" width="40" height="20" textAlign="center" enable="false" cssclass="display" readonly="true"/>
                              <Static id="Static16_01_00_00" taborder="4" text="시간" left="579" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Calendar id="cal_startDate1" taborder="5" left="135" top="5" width="100" height="20" dateformat="yyyy-MM-dd" cssclass="display" readonly="true"/>
                              <MaskEdit id="mae_00_00" taborder="6" left="238" top="5" width="50" height="20" format="##:##" type="string" cssclass="display" readonly="true"/>
                              <Calendar id="cal_endDate1" taborder="7" left="334" top="5" width="100" height="20" dateformat="yyyy-MM-dd" cssclass="display" readonly="true"/>
                              <MaskEdit id="mae_00_00_00" taborder="8" left="437" top="5" width="50" height="20" format="##:##" type="string" cssclass="display" readonly="true"/>
                              <Static id="sta_site00" taborder="9" text="내용" left="0" top="31" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="내용"/>
                              <Edit id="edt_approvalContents1" taborder="10" left="135" top="36" width="565" height="20" textAlign="left" cssclass="display" readonly="true"/>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="div_comment" taborder="0" left="0" top="62" height="63" cssclass="div_WF_detail_line_notop" text="" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_site00" taborder="6" text="Comment" left="0" top="0" width="130" height="62" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="Comment"/>
                              <Static id="sta_00" taborder="1" left="130" top="0" height="61" background="#ffffff" right="0"/>
                              <TextArea id="txa_00" taborder="2" left="135" top="5" width="768" height="52"/>
                            </Layout>
                          </Layouts>
                        </Div>
                      </Layout>
                    </Layouts>
                  </Div>
                  <Div id="div_02" taborder="4" left="0" top="346" height="165" right="0" text="" background="#ffffff" visible="false">
                    <Layouts>
                      <Layout>
                        <Div id="div_basicInfo00_01" taborder="1" left="0" top="0" height="63" cssclass="div_WF_detail_line_notop" text="" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_site" taborder="0" text="기간" left="0" top="0" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" tooltiptext="기간"/>
                              <Static id="sta_site00" taborder="1" text="내용" left="0" top="31" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="내용"/>
                              <Edit id="edt_approvalContents2" taborder="2" left="135" top="36" width="565" height="20" textAlign="left" cssclass="display" readonly="true"/>
                              <Calendar id="cal_startDate2" taborder="3" left="135" top="5" width="100" height="20" dateformat="yyyy-MM-dd" cssclass="display" readonly="true"/>
                              <Static id="Static16_01" taborder="4" text="부터" left="241" top="5" width="27" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Calendar id="cal_endDate2" taborder="5" left="281" top="5" width="100" height="20" dateformat="yyyy-MM-dd" cssclass="display" readonly="true"/>
                              <Static id="Static16_01_00" taborder="6" text="까지" left="387" top="5" width="27" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Static id="Static16_01_00_00_00" taborder="7" text="(" left="423" top="5" width="10" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Edit id="edt_requestDay2" taborder="8" left="430" top="5" width="30" height="20" textAlign="center" enable="false" cssclass="display" readonly="true"/>
                              <Static id="Static16_01_00_00" taborder="9" text="일간)" left="466" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="div_comment" taborder="0" left="0" top="62" height="63" cssclass="div_WF_detail_line_notop" text="" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_site00" taborder="6" text="Comment" left="0" top="0" width="130" height="62" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="Comment"/>
                              <Static id="sta_00" taborder="1" left="130" top="0" height="61" background="#ffffff" right="0"/>
                              <TextArea id="txa_00" taborder="2" left="135" top="5" width="768" height="52"/>
                            </Layout>
                          </Layouts>
                        </Div>
                      </Layout>
                    </Layouts>
                  </Div>
                  <Div id="div_03" taborder="5" left="0" top="466" height="225" right="0" text="" background="#ffffff" visible="false">
                    <Layouts>
                      <Layout>
                        <Div id="div_basicInfo00_02" taborder="1" left="0" top="0" height="125" cssclass="div_WF_detail_line_notop" text="" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_site" taborder="0" text="기간" left="0" top="0" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="기간"/>
                              <Static id="sta_site00" taborder="1" text="국내외구분" left="0" top="31" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" tooltiptext="국내외구분"/>
                              <Static id="sta_site00_00" taborder="2" text="출장지역" left="0" top="62" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="출장지역"/>
                              <Combo id="cbo_messageclassid" taborder="3" left="135" top="36" height="20" codecolumn="C,HJS_HR_BUSINESS_TYPE,NAN,Y,Y" onitemchanged="Combo01_onitemchanged" width="130" index="-1" onmousemove="fn_msgCdCboToolTip" cssclass="display" readonly="true"/>
                              <Edit id="edt_00_00_00" taborder="4" left="135" top="67" width="565" height="20" textAlign="center" cssclass="display" readonly="true"/>
                              <Static id="sta_site00_01" taborder="5" text="내용" left="0" top="93" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="내용"/>
                              <Edit id="edt_approvalContents3" taborder="6" left="135" top="98" width="565" height="20" textAlign="left" cssclass="display" readonly="true"/>
                              <Calendar id="cal_startDate3" taborder="7" left="135" top="5" width="100" height="20" dateformat="yyyy-MM-dd" cssclass="display" readonly="true"/>
                              <Static id="Static16_01" taborder="8" text="부터" left="241" top="5" width="27" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Calendar id="cal_endDate3" taborder="9" left="281" top="5" width="100" height="20" dateformat="yyyy-MM-dd" cssclass="display" readonly="true"/>
                              <Static id="Static16_01_00" taborder="10" text="까지" left="387" top="5" width="27" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Static id="Static16_01_00_00_00" taborder="11" text="(" left="423" top="5" width="10" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Edit id="edt_requestDay3" taborder="12" left="430" top="5" width="30" height="20" textAlign="center" enable="false" cssclass="display" readonly="true" initvalueid="edt_requestDay3"/>
                              <Static id="Static16_01_00_00" taborder="13" text="일간)" left="466" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="div_comment" taborder="0" left="0" top="124" height="63" cssclass="div_WF_detail_line_notop" text="" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_site00" taborder="6" text="Comment" left="0" top="0" width="130" height="62" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="Comment"/>
                              <Static id="sta_00" taborder="1" left="130" top="0" height="61" background="#ffffff" right="0"/>
                              <TextArea id="txa_00" taborder="2" left="135" top="5" width="768" height="52"/>
                            </Layout>
                          </Layouts>
                        </Div>
                      </Layout>
                    </Layouts>
                  </Div>
                  <Button id="btn_approval" taborder="6" text="승인" top="7" right="66" width="60" height="20" tooltiptext="승인" onclick="div_work_Tabpage1_btn_approval_onclick"/>
                  <Button id="btn_returned" taborder="7" text="반려" top="7" right="0" width="60" height="20" tooltiptext="반려" onclick="div_work_Tabpage1_btn_returned_onclick"/>
                  <Button id="btn_list" taborder="8" text="목록" onclick="fn_list" top="7" right="132" width="60" height="20" tooltiptext="목록"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="Tabpage2" text="근태신청(대리)" tooltiptext="근태신청(대리)">
              <Layouts>
                <Layout>
                  <Static id="Static20_00_00" taborder="0" text="근태 신청 (대리)" left="0" width="241" height="34" cssclass="sta_WF_subTitle" top="0" tooltiptext="근태 신청 정보"/>
                  <Button id="btn_cancel" taborder="1" text="취소" onclick="div_search_btn_clear1_onclick" top="7" right="66" width="60" height="20" tooltiptext="취소"/>
                  <Button id="btn_save" taborder="2" text="저장" onclick="fn_save" top="7" right="0" width="60" height="20" tooltiptype="hover" tooltiptext="저장"/>
                  <Div id="div_basicInfo" taborder="3" left="0" top="34" height="63" cssclass="div_WF_detail_line" text="" right="0">
                    <Layouts>
                      <Layout>
                        <Static id="sta_site" taborder="0" text="신청일자" left="0" top="0" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="신청일자"/>
                        <Static id="sta_certdate" taborder="1" text="&lt;fc v='red'&gt;*&lt;/fc&gt;구분" left="0" top="31" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" tooltiptext="구분" usedecorate="true"/>
                        <Calendar id="cal_applyDate" taborder="2" left="135" top="5" width="130" height="20" dateformat="yyyy-MM-dd" cssclass="display" enable="false"/>
                        <Combo id="cbo_calenderName" taborder="3" left="135" top="36" height="20" codecolumn="C,HJS_HR_ATTENDANCE_TYPE,SEL,Y,Y" width="130" index="-1" onitemchanged="div_work_Tabpage2_div_basicInfo_cbo_calenderName_onitemchanged" text=""/>
                        <Static id="sta_site00" taborder="4" text="작성자" left="300" top="0" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="작성자"/>
                        <Edit id="edt_empName" taborder="5" left="435" top="5" width="130" height="20" textAlign="center" cssclass="display" enable="false"/>
                        <Static id="sta_alterWorkDay" taborder="6" text="&lt;fc v='red'&gt;*&lt;/fc&gt;대체근무일" left="300" top="31" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="true" tooltiptext="대체근무일"/>
                        <Calendar id="cal_alterWorkDay" taborder="7" left="435" top="36" width="130" height="20" dateformat="yyyy-MM-dd"/>
                        <Static id="sta_site00_01" taborder="8" text="&lt;fc v='red'&gt;*&lt;/fc&gt;성명" left="600" top="0" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="true" tooltiptext="작성자"/>
                        <Combo id="cbo_personId" taborder="9" left="735" top="5" height="20" codecolumn="PERSON_ID" onitemchanged="Combo01_onitemchanged" width="130" index="-1" onmousemove="fn_msgCdCboToolTip" innerdataset="ds_employeeList" datacolumn="EMP_NAME"/>
                      </Layout>
                    </Layouts>
                  </Div>
                  <Div id="div_00" taborder="4" left="0" top="96" height="164" right="0" text="" background="#ffffff">
                    <Layouts>
                      <Layout>
                        <Div id="div_basicInfo00" taborder="0" left="0" top="0" height="63" cssclass="div_WF_detail_line_notop" text="" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_site" taborder="0" text="&lt;fc v='red'&gt;*&lt;/fc&gt;기간" left="0" top="0" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="true" tooltiptext="기간"/>
                              <Calendar id="cal_startDate0" taborder="1" left="135" top="5" width="130" height="20" dateformat="yyyy-MM-dd"/>
                              <Static id="Static16_01" taborder="2" text="부터" left="271" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Calendar id="cal_endDate0" taborder="3" left="311" top="5" width="130" height="20" dateformat="yyyy-MM-dd"/>
                              <Static id="Static16_01_00" taborder="4" text="까지" left="447" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Edit id="edt_requestDay0" taborder="5" left="487" top="5" width="50" height="20" textAlign="center" enable="false"/>
                              <Static id="Static16_01_00_00" taborder="6" text="일" left="543" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Static id="sta_site00" taborder="7" text="내용" left="0" top="31" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="내용"/>
                              <Edit id="edt_approvalContents0" taborder="8" left="135" top="36" width="565" height="20" textAlign="left"/>
                            </Layout>
                          </Layouts>
                        </Div>
                      </Layout>
                    </Layouts>
                  </Div>
                  <Div id="div_01" taborder="5" left="0" top="166" height="164" right="0" text="" background="#ffffff" visible="false">
                    <Layouts>
                      <Layout>
                        <Div id="div_basicInfo00_00" taborder="1" left="0" top="0" height="63" cssclass="div_WF_detail_line_notop" text="" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_site" taborder="0" text="&lt;fc v='red'&gt;*&lt;/fc&gt;기간" left="0" top="0" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="true" tooltiptext="기간"/>
                              <Static id="Static16_01" taborder="1" text="부터" left="304" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Static id="Static16_01_00" taborder="2" text="까지" left="513" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Edit id="edt_requestDay1" taborder="3" left="553" top="5" width="50" height="20" textAlign="center" enable="false"/>
                              <Static id="Static16_01_00_00" taborder="4" text="시간" left="609" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Calendar id="cal_startDate1" taborder="5" left="135" top="5" width="110" height="20" dateformat="yyyy-MM-dd"/>
                              <MaskEdit id="mae_00_00" taborder="6" left="248" top="5" width="50" height="20" format="##:##" type="string"/>
                              <Calendar id="cal_endDate1" taborder="7" left="344" top="5" width="110" height="20" dateformat="yyyy-MM-dd"/>
                              <MaskEdit id="mae_00_00_00" taborder="8" left="457" top="5" width="50" height="20" format="##:##" type="string"/>
                              <Static id="sta_site00" taborder="9" text="내용" left="0" top="31" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="내용"/>
                              <Edit id="edt_approvalContents1" taborder="10" left="135" top="36" width="565" height="20" textAlign="left"/>
                            </Layout>
                          </Layouts>
                        </Div>
                      </Layout>
                    </Layouts>
                  </Div>
                  <Div id="div_02" taborder="6" left="0" top="236" height="165" right="0" text="" background="#ffffff" visible="false">
                    <Layouts>
                      <Layout>
                        <Div id="div_basicInfo00_01" taborder="1" left="0" top="0" height="63" cssclass="div_WF_detail_line_notop" text="" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_site" taborder="0" text="&lt;fc v='red'&gt;*&lt;/fc&gt;기간" left="0" top="0" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="true" tooltiptext="기간"/>
                              <Calendar id="cal_startDate2" taborder="1" left="135" top="5" width="130" height="20" dateformat="yyyy-MM-dd"/>
                              <Static id="Static16_01" taborder="2" text="부터" left="271" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Calendar id="cal_endDate2" taborder="3" left="311" top="5" width="130" height="20" dateformat="yyyy-MM-dd"/>
                              <Static id="Static16_01_00" taborder="4" text="까지" left="447" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Edit id="edt_requestDay2" taborder="5" left="487" top="5" width="50" height="20" textAlign="center" enable="false"/>
                              <Static id="Static16_01_00_00" taborder="6" text="일" left="543" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Button id="btn_apply" taborder="7" text="0.5일 신청" top="5" width="110" height="20" tooltiptext="0.5일 신청" left="583" onclick="div_work_Tabpage2_div_02_div_basicInfo00_01_btn_apply_onclick"/>
                              <Static id="sta_site00" taborder="8" text="내용" left="0" top="31" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="내용"/>
                              <Edit id="edt_approvalContents2" taborder="9" left="135" top="36" width="565" height="20" textAlign="left"/>
                            </Layout>
                          </Layouts>
                        </Div>
                      </Layout>
                    </Layouts>
                  </Div>
                  <Div id="div_03" taborder="7" left="0" top="296" height="225" right="0" text="" background="#ffffff" visible="false">
                    <Layouts>
                      <Layout>
                        <Div id="div_basicInfo00_02" taborder="1" left="0" top="0" height="125" cssclass="div_WF_detail_line_notop" text="" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="sta_site" taborder="0" text="&lt;fc v='red'&gt;*&lt;/fc&gt;기간" left="0" top="0" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="true" tooltiptext="기간"/>
                              <Calendar id="cal_startDate3" taborder="1" left="135" top="5" width="130" height="20" dateformat="yyyy-MM-dd"/>
                              <Static id="Static16_01" taborder="2" text="부터" left="271" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Calendar id="cal_endDate3" taborder="3" left="311" top="5" width="130" height="20" dateformat="yyyy-MM-dd"/>
                              <Static id="Static16_01_00" taborder="4" text="까지" left="447" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Edit id="edt_requestDay3" taborder="5" left="487" top="5" width="50" height="20" textAlign="center" enable="false"/>
                              <Static id="Static16_01_00_00" taborder="6" text="일" left="543" top="5" width="40" height="20" cssclass="sta_font_black" textAlign="left"/>
                              <Static id="sta_site00" taborder="7" text="&lt;fc v='red'&gt;*&lt;/fc&gt;국내외구분" left="0" top="31" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="true" tooltiptext="국내외구분"/>
                              <Static id="sta_site00_00" taborder="8" text="출장지역" left="0" top="62" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="출장지역"/>
                              <Combo id="cbo_messageclassid" taborder="9" left="135" top="36" height="20" codecolumn="C,HJS_HR_BUSINESS_TYPE,NAN,Y,Y" onitemchanged="Combo01_onitemchanged" width="130" index="-1" onmousemove="fn_msgCdCboToolTip"/>
                              <Edit id="edt_businessArea" taborder="10" left="135" top="67" width="565" height="20" textAlign="left"/>
                              <Static id="sta_site00_01" taborder="11" text="내용" left="0" top="93" width="130" height="31" cssclass="sta_WF_detailLabel" wordWrap="english" usedecorate="false" tooltiptext="내용"/>
                              <Edit id="edt_approvalContents3" taborder="12" left="135" top="98" width="565" height="20" textAlign="left"/>
                            </Layout>
                          </Layouts>
                        </Div>
                      </Layout>
                    </Layouts>
                  </Div>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="Static13" taborder="8" visible="false" left="922" top="213" height="147" background="blue" padding="10px" textAlign="left" verticalAlign="middle" opacity="0.5" text="근태 신청 구분에 따른 div ID 참고&#13;&#10;(근태신청/근태신청(대리) 동일)&#13;&#10;&#13;&#10;div_00 : 연휴, 반휴(대체근무일 hide)&#13;&#10;div_01 : 대체근무, 외출(대체근무일 hide)&#13;&#10;div_02 : 대체휴일(대체근무일 show)&#13;&#10;div_03 : 출장(대체근무일 hide)" color="#ffffff" width="240"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_search">
        <ColumnInfo>
          <Column id="COND_DATE" type="STRING" size="256"/>
          <Column id="ORGANIZATION_NAME" type="STRING" size="256"/>
          <Column id="ORGANIZATION_ID" type="STRING" size="256"/>
          <Column id="STATUS" type="STRING" size="256"/>
          <Column id="ATTRIBUTE6" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_attendanceApproveList" useclientlayout="true">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="APPLY_DATE" type="STRING" size="256"/>
          <Column id="ORG_NAME" type="STRING" size="256"/>
          <Column id="GRADE_NAME" type="STRING" size="256"/>
          <Column id="EMPLOYEE_NUMBER" type="STRING" size="256"/>
          <Column id="EMP_NAME" type="STRING" size="256"/>
          <Column id="MGR_NAME" type="STRING" size="256"/>
          <Column id="START_DATE" type="STRING" size="256"/>
          <Column id="END_DATE" type="STRING" size="256"/>
          <Column id="REQUEST_DAY" type="STRING" size="256"/>
          <Column id="CALENDER_NAME" type="STRING" size="256"/>
          <Column id="STATUS_NAME" type="STRING" size="256"/>
          <Column id="APPROVAL_CONTENTS" type="STRING" size="256"/>
          <Column id="CALENDER_TYPE" type="STRING" size="256"/>
          <Column id="STATUS_CODE" type="STRING" size="256"/>
          <Column id="OBJECT_VERSION_NUMBER" type="STRING" size="256"/>
          <Column id="HJSPAY_WORK_APPLY_SEQ" type="STRING" size="256"/>
          <Column id="PERSON_ID" type="STRING" size="256"/>
          <Column id="CLOSE_FLAG" type="STRING" size="256"/>
          <Column id="MGR_PERSON_ID" type="STRING" size="256"/>
          <Column id="CONTENTS" type="STRING" size="256"/>
          <Column id="ALTER_WORK_DAY" type="STRING" size="256"/>
          <Column id="BUSINESS_TYPE" type="STRING" size="256"/>
          <Column id="BUSINESS_LOCAL" type="STRING" size="256"/>
          <Column id="START_DATE_TIME" type="STRING" size="256"/>
          <Column id="END_DATE_TIME" type="STRING" size="256"/>
          <Column id="CHECK_FLAG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_attendanceApproveDetail" useclientlayout="true">
        <ColumnInfo>
          <Column id="HJSPAY_WORK_APPLY_SEQ" type="STRING" size="256"/>
          <Column id="PERSON_ID" type="STRING" size="256"/>
          <Column id="APPLY_DATE" type="STRING" size="256"/>
          <Column id="EMP_NAME" type="STRING" size="256"/>
          <Column id="CALENDER_TYPE" type="STRING" size="256"/>
          <Column id="CALENDER_NAME" type="STRING" size="256"/>
          <Column id="START_DATE" type="STRING" size="256"/>
          <Column id="END_DATE" type="STRING" size="256"/>
          <Column id="APPROVAL_CONTENTS" type="STRING" size="256"/>
          <Column id="CONTENTS" type="STRING" size="256"/>
          <Column id="REQUEST_DAY" type="STRING" size="256"/>
          <Column id="ALTER_WORK_DAY" type="STRING" size="256"/>
          <Column id="BUSINESS_TYPE" type="STRING" size="256"/>
          <Column id="BUSINESS_LOCAL" type="STRING" size="256"/>
          <Column id="START_DATE_TIME" type="STRING" size="256"/>
          <Column id="END_DATE_TIME" type="STRING" size="256"/>
          <Column id="STATUS_CODE" type="STRING" size="256"/>
          <Column id="MGR_PERSON_ID" type="STRING" size="256"/>
          <Column id="OBJECT_VERSION_NUMBER" type="STRING" size="256"/>
          <Column id="CHECK_FLAG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_attendanceApproveInstead" useclientlayout="true" oncolumnchanged="ds_attendanceApproveInstead_oncolumnchanged">
        <ColumnInfo>
          <Column id="APPLY_DATE" type="STRING" size="256"/>
          <Column id="EMP_NAME" type="STRING" size="256"/>
          <Column id="CALENDER_TYPE" type="STRING" size="256"/>
          <Column id="CALENDER_NAME" type="STRING" size="256"/>
          <Column id="START_DATE" type="STRING" size="256"/>
          <Column id="END_DATE" type="STRING" size="256"/>
          <Column id="APPROVAL_CONTENTS" type="STRING" size="256"/>
          <Column id="CONTENTS" type="STRING" size="256"/>
          <Column id="REQUEST_DAY" type="STRING" size="256"/>
          <Column id="ALTER_WORK_DAY" type="STRING" size="256"/>
          <Column id="BUSINESS_TYPE" type="STRING" size="256"/>
          <Column id="BUSINESS_LOCAL" type="STRING" size="256"/>
          <Column id="START_DATE_TIME" type="STRING" size="256"/>
          <Column id="END_DATE_TIME" type="STRING" size="256"/>
          <Column id="PERSON_ID" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_employeeList" useclientlayout="true">
        <ColumnInfo>
          <Column id="PERSON_ID" type="STRING" size="256"/>
          <Column id="EMP_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_result" useclientlayout="true">
        <ColumnInfo>
          <Column id="START_DATE" type="STRING" size="256"/>
          <Column id="START_DATE_TIME" type="STRING" size="256"/>
          <Column id="END_DATE" type="STRING" size="256"/>
          <Column id="END_DATE_TIME" type="STRING" size="256"/>
          <Column id="DIFFDAY" type="STRING" size="256"/>
          <Column id="DIFFTIME" type="STRING" size="256"/>
          <Column id="HOLIDAY_DAY" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_CloseYn" useclientlayout="true">
        <ColumnInfo>
          <Column id="APPLY_YYYY" type="STRING" size="256"/>
          <Column id="CLOSE_FLAG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.1"><![CDATA[/***************************************************************************************
 * 시스템명 	: 
 * 업무명 		: 근태승인
 * 파일명 		: PAY40210M.xfdl
 * 작성자 		: 박대호
 * 작성일 		: 2022.2.14
 * 설  명		: 근태승인
 *---------------------------------------------------------------------------------------
 * 변경일		변경자			변경내역
 *---------------------------------------------------------------------------------------
 * 2022.02.14	박대호			최초작성 
 *---------------------------------------------------------------------------------------
 ****************************************************************************************/

/*===============================================================================
== apr설명. (apr) 공통함수 목록 
===============================================================================
● fn_initInfo                              : 초기값 세팅
● fn_attendanceApproveList                 : 근태승인내역 조회
● fn_tabDetailDisplay                		: 상세탭 화면변경
● fn_tabDetailData                			: 상세탭 데이터입력
● fn_tabInsteadDisplay            			: 근태신청 화면변경
● fn_employeeList       					: 근태 대리신청 성명조회
● fn_tabInsteadData       					: 근태신청 기초데이터
● fn_saveEmployee       					: 근태 대리신청 저장
 
*/

/**************************************************************************
 * 1. 필수 include
 ***************************************************************************/


/**************************************************************************
 * 2. FORM 변수 선언 영역
 ***************************************************************************/

/**************************************************************************
 * 3. FORM LOAD
 ***************************************************************************/
 this.fn_init = function (obj, e)
{
	this.nfn_formInit(obj);
	this.fn_initInfo();
	this.fn_employeeList();
};

/*******************************************************************************
 * fn_initInfo
 * 기능 : 초기값 세팅
 * 박대호
 * Parameter  : 
*******************************************************************************/
this.fn_initInfo = function ()
{
	this.div_search.form.div_condDate.form.fn_initMonthCal(obj, this.gfn_getYearMonth(), null, this.ds_search, "COND_DATE");
	this.ds_attendanceApproveInstead.setColumn(0, "APPLY_DATE", this.gfn_today());
	this.ds_attendanceApproveInstead.setColumn(0, "EMP_NAME", this.gf_getUserNm());
}
/*******************************************************************************
 * fn_attendanceApproveList
 * 기능 : 근태승인내역 조회
 * 박대호
 * Parameter  : 
*******************************************************************************/
this.fn_attendanceApproveList = function ()
{
	if(!this.nfn_isNull(this.ds_search.getColumn(0, "STATUS")))
	{
		if(this.ds_search.getColumn(0, "STATUS") == "10" || this.ds_search.getColumn(0, "STATUS") == "30")
		{
			this.ds_search.setColumn(0, "ATTRIBUTE6", "N");
		}
		else
		{
			this.ds_search.setColumn(0, "ATTRIBUTE6", "Y");
		}
	}
	else
	{
		this.ds_search.setColumn(0, "ATTRIBUTE6", "");
	}
	if(this.nfn_isNull(this.ds_search.getColumn(0, "ORGANIZATION_NAME")))
	{
		this.ds_search.setColumn(0,"ORGANIZATION_ID","");
	}
	var sSvcID = "selectAttendanceApproveList";
	var sController = "/pay40210/selectAttendanceApproveList.do";
	var sInDatasets = "INPUT=ds_search";
	var sOutDatasets = "ds_attendanceApproveList=output";
	var sArgs = "";
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
	
}

/*******************************************************************************
 * fn_employeeList
 * 기능 : 근태 대리신청 성명조회
 * 박대호
 * Parameter  : 
*******************************************************************************/
this.fn_employeeList = function ()
{
	var sSvcID = "selectEmployeeList";
	var sController = "/pay40210/selectEmployeeList.do";
	var sInDatasets = "INPUT=ds_search";
	var sOutDatasets = "ds_employeeList=output";
	var sArgs = "";
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
	
}
/*******************************************************************************
 * fn_saveEmployee
 * 기능 : 근태 대리신청 저장
 * 박대호
 * Parameter  : 
*******************************************************************************/
this.fn_saveEmployee = function()
{
	// -------------------------
	// 저장
	// ':U' 는 갱신된 내용만을 입력 데이터세트로 보내며, ':A' 는 모든 정보를 보냅니다.
	// ':N' 은 현재 Delete를 제외한 데이터를 Normal 상태로 보냅니다. 지정하지 않는 데이터세트는 Normal로 동작합니다
	// -------------------------
 	var sSvcID 			= "saveAttendanceApprove";	// CallBack service name
 	var sController 	= "/pay40210/saveEmployee.do";
 	var sInDatasets 	= "INPUT=ds_attendanceApproveInstead:A";
 	var sOutDatasets 	= "";
 	var sArgs 			= "";
    this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);	
};
/**************************************************************************
 * 4. 공통버튼영역 (함수 삭제금지!!!!)
 ***************************************************************************/
 /*
 * 기능 : 검색
 */
this.fn_search = function (obj, e)
{
	this.fn_attendanceApproveList();
};


/*
* 기능 : 검색 초기화
*/
this.fn_searchClear = function(obj,e)
{
	
};

/*
* 기능 : 저장
*/
this.fn_save = function()
{
	if (this.ds_attendanceApproveInstead.rowcount < 1) return;
	
	//필수값 체크
	var objDataset = "ds_attendanceApproveInstead";
	var strColIdList = "CALENDER_TYPE,START_DATE,END_DATE";
	var strColNmList = "구분,기간(시작일),기간(종료일)"
	
	var calenderType = this.ds_attendanceApproveInstead.getColumn(0, "CALENDER_TYPE");
	if (calenderType == "140") //대체휴일
	{
		strColIdList = strColIdList+",ALTER_WORK_DAY,START_DATE,END_DATE"; 
		strColNmList = strColNmList+",대체근무일,기간(시작일),기간(종료일)";
	} 
	else if (calenderType == "310" || calenderType == "190") // 대체근무, 외출 
	{
		strColIdList = strColIdList+",START_DATE_TIME,END_DATE_TIME"; 
		strColNmList = strColNmList+",시간(시작),시간(종료)";		
	}
    else if (calenderType == "150") // 출장
	{
		strColIdList = strColIdList+",START_DATE,END_DATE,BUSINESS_TYPE"; 
		strColNmList = strColNmList+",기간(시작일),기간(종료일),국내외구분";
	}
    var rtn = this.nfn_MandatoryCheckDs(objDataset, strColIdList, strColNmList);
	if (rtn == false) return; 
	
	var diffDay = this.gfn_diffDate2(this.ds_attendanceApproveInstead.getColumn(0, "START_DATE") , this.ds_attendanceApproveInstead.getColumn(0, "END_DATE"));
	if (diffDay < 0)
	{
		//기간설정이 잘못 되었습니다. 다시 기간설정을 하여 주시기 바랍니다.
		this.gfn_Message("ValidateStartEndDate", null, "info", "ok");
		return;
	} 
	
	if(calenderType == "110")//연휴
	{
		var sSvcID 			= "selectCheckCloseYn"; 						// CallBack service name
		var sController 	= "/pay40110/selectCheckCloseYn.do" ;			// CONTROLLER VALUE
		var sInDatasets 	= "INPUT=ds_attendanceApproveInstead";				// DB INPUT  DATA
		var sOutDatasets 	= "ds_CloseYn=output";				    		// DB OUTPUT DATA
		var sArgs 			= "";		
		this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
	}
	else if (calenderType == "130")//반휴
	{
		//시작일자와 종료일자가 다를 경우 
		if(this.ds_attendanceApproveInstead.getColumn(0, "START_DATE") != this.ds_attendanceApproveInstead.getColumn(0, "END_DATE"))
		{
			//반휴신청시 시작일과 종료일은 같아야 합니다.
			this.gfn_Message("ValidateHalfholidayRequest", null, "info", "ok");
			return;
		}
		var diffDay  = this.fn_checkWorkDayCntWt(this.ds_attendanceApproveInstead, 0);
		if(diffDay == 0)//공휴일에 반휴쓸경우
		return;
	}
	else if(calenderType == "310")//대체근무
	{
		var startMM = this.ds_attendanceApproveInstead.getColumn(0, "START_DATE_TIME").substr(2,2);
		var endMM = this.ds_attendanceApproveInstead.getColumn(0, "END_DATE_TIME").substr(2,2);
		var contents = this.ds_attendanceApproveInstead.getColumn(0, "CONTENTS");
		
		if((startMM != "00" && startMM != "30") || (endMM != "00" && endMM != "30"))
		{
			//분은 00, 30분만 등록할 수 있습니다.
			this.gfn_Message("CheckTimeMinute", null, "info", "ok");
			return;
		}
// 		if(this.nfn_isNull(contents))
// 		{
// 			//대체근무/대휴 신청할 때 내용을 반드시 등록하시기 바랍니다.
// 			this.gfn_Message("ValidateSubstituteDayRequest", null, "info", "ok");
// 			return;
// 		}
		//지정하신 일자의 대체근무/대체휴일에 동의하십니까? (동의: 확인,  미동의: 취소)
		var bOK = this.gfn_Message("ValidateSubstituteDayConfirm", null, "conf", "yesno");
		if (!bOK) return;
	}
	else if (calenderType == "140")//대체휴일
	{
		var contents = this.ds_attendanceApproveInstead.getColumn(0, "CONTENTS");
// 		if(this.nfn_isNull(contents))
// 		{
// 			//신청할 때 내용을 반드시 등록하시기 바랍니다.
// 			this.gfn_Message("ValidateAttendanceCommend", null, "info", "ok");
// 			return;
// 		}
		//지정하신 일자의 대체근무/대체휴일에 동의하십니까? (동의: 확인,  미동의: 취소)
		var bOK = this.gfn_Message("ValidateSubstituteDayConfirm", null, "conf", "yesno");
		if (!bOK) return;
	}
	else if(calenderType == "190")//외출
	{
		var contents = this.ds_attendanceApproveInstead.getColumn(0, "CONTENTS");
// 		if(this.nfn_isNull(contents))
// 		{
// 			//신청할 때 내용을 반드시 등록하시기 바랍니다.
// 			this.gfn_Message("ValidateAttendanceCommend", null, "info", "ok");
// 			return;
// 		}
	}
	if(calenderType != "110")
	{
		//저장
		this.fn_saveEmployee();
	}
};

/**************************************************************************
 * 5. TRANSACTION, CALLBACK 영역
 ***************************************************************************/
this.fn_callBack = function (trId, errCD, errMsg)
{
 trace('fn_callBack trId ?' + trId);
 	if (errCD < 0)
 	{
 		this.gfn_Message("ProcessingError", trId + errMsg, "error", "ok");
 	}
	else
	{
		switch(trId)
		{
			
			case "selectAttendanceApproveList" :
 			{
				this.notFoundView(this.div_work.Tabpage0.form.grd_attendanceApproveList);
				break;
			}
			case "saveAttendanceApprove" :
			{
				this.gfn_Message("SuccessSave", null, "info","ok");
				this.div_work.set_tabindex(0);
				this.fn_attendanceApproveList();
				break;
			}
			case "selectCheckCloseYn" :
			{
				for(var i = 0; i < this.ds_CloseYn.rowcount; i++)
				{
					if(this.ds_CloseYn.getColumn(i, "CLOSE_FLAG") == "1")
					{
						//[{0}]년도 연차가 이미 마감되었습니다. 담당자에게 문의하여 주시기 바랍니다.
						this.gfn_Message("ValidateAnnualLeaveClosed",this.ds_CloseYn.getColumn(i, "APPLY_YYYY"), "info","ok");
						return;
					}
				}
				//저장
				this.fn_saveEmployee();
			}
			
			default:
		}
	}
};
/**************************************************************************
 * 6. 팝업 호출/콜백
 **************************************************************************/
 /*
 *	기능 : 팝업 관련
 */ 
this.fn_popupAfter = function(sPopupId, Variant)
{
	var rtn = this.fv_rtnValue;	
	if(this.nfn_isNull(rtn)) return;

	if(sPopupId == "POPUP_ORGANIZATION")
	{
		this.ds_search.setColumn(0,"ORGANIZATION_ID",rtn[0]);		
		this.ds_search.setColumn(0,"ORGANIZATION_NAME",rtn[1]);		
	}
};
/**************************************************************************
 * 7. 기타 함수(화면 로컬 정의)
 **************************************************************************/
/*******************************************************************************
 * fn_list
 * 기능 : 목록으로 이동
 * 박대호
 * Parameter  : 
*******************************************************************************/
this.fn_list = function ()
{  
	this.div_work.set_tabindex(0);
};

/*******************************************************************************
 * fn_tabDetailDisplay
 * 기능 : 상세탭 화면변경
 * 박대호
 * Parameter  : 
*******************************************************************************/
this.fn_tabDetailDisplay = function (calenderType)
{

	this.div_work.Tabpage1.form.div_basicInfo.form.sta_alterWorkDay.set_visible(false);
	this.div_work.Tabpage1.form.div_basicInfo.form.cal_alterWorkDay.set_visible(false);
	
	if (calenderType == "310" || calenderType == "190" ) //대체근무(310), 외출(190) - div_01
	{
		this.div_work.Tabpage1.form.div_00.set_visible(false);
		this.div_work.Tabpage1.form.div_01.set_visible(true);
		this.div_work.Tabpage1.form.div_02.set_visible(false);
		this.div_work.Tabpage1.form.div_03.set_visible(false);			
		this.div_work.Tabpage1.form.div_01.set_top("96");
	}
	else if (calenderType == "140") //대체휴일(140) - div_02
	{
		this.div_work.Tabpage1.form.div_00.set_visible(false);
		this.div_work.Tabpage1.form.div_01.set_visible(false);
		this.div_work.Tabpage1.form.div_02.set_visible(true);
		this.div_work.Tabpage1.form.div_03.set_visible(false);	
		this.div_work.Tabpage1.form.div_02.set_top("96");
		this.div_work.Tabpage1.form.div_basicInfo.form.sta_alterWorkDay.set_visible(true);
		this.div_work.Tabpage1.form.div_basicInfo.form.cal_alterWorkDay.set_visible(true);
	}
	else if (calenderType == "150") //출장(150) - div_03
	{
		this.div_work.Tabpage1.form.div_00.set_visible(false);
		this.div_work.Tabpage1.form.div_01.set_visible(false);
		this.div_work.Tabpage1.form.div_02.set_visible(false);
		this.div_work.Tabpage1.form.div_03.set_visible(true);	
		this.div_work.Tabpage1.form.div_03.set_top("96");
	}
	else  //나머지 근태구분 - div_00
	{
		this.div_work.Tabpage1.form.div_00.set_visible(true);
		this.div_work.Tabpage1.form.div_01.set_visible(false);
		this.div_work.Tabpage1.form.div_02.set_visible(false);
		this.div_work.Tabpage1.form.div_03.set_visible(false);
	}
}
/*******************************************************************************
 * fn_tabInsteadDisplay
 * 기능 : 근태신청 화면변경
 * 박대호
 * Parameter  : 
*******************************************************************************/
this.fn_tabInsteadDisplay = function (calenderType)
{

	this.div_work.Tabpage2.form.div_basicInfo.form.sta_alterWorkDay.set_visible(false);
	this.div_work.Tabpage2.form.div_basicInfo.form.cal_alterWorkDay.set_visible(false);
	
	if (calenderType == "310" || calenderType == "190" ) //대체근무(310), 외출(190) - div_01
	{
		this.div_work.Tabpage2.form.div_00.set_visible(false);
		this.div_work.Tabpage2.form.div_01.set_visible(true);
		this.div_work.Tabpage2.form.div_02.set_visible(false);
		this.div_work.Tabpage2.form.div_03.set_visible(false);			
		this.div_work.Tabpage2.form.div_01.set_top("96");
	}
	else if (calenderType == "140") //대체휴일(140) - div_02
	{
		this.div_work.Tabpage2.form.div_00.set_visible(false);
		this.div_work.Tabpage2.form.div_01.set_visible(false);
		this.div_work.Tabpage2.form.div_02.set_visible(true);
		this.div_work.Tabpage2.form.div_03.set_visible(false);	
		this.div_work.Tabpage2.form.div_02.set_top("96");
		this.div_work.Tabpage2.form.div_basicInfo.form.sta_alterWorkDay.set_visible(true);
		this.div_work.Tabpage2.form.div_basicInfo.form.cal_alterWorkDay.set_visible(true);
	}
	else if (calenderType == "150") //출장(150) - div_03
	{
		this.div_work.Tabpage2.form.div_00.set_visible(false);
		this.div_work.Tabpage2.form.div_01.set_visible(false);
		this.div_work.Tabpage2.form.div_02.set_visible(false);
		this.div_work.Tabpage2.form.div_03.set_visible(true);	
		this.div_work.Tabpage2.form.div_03.set_top("96");
	}
	else  //나머지 근태구분 - div_00
	{
		this.div_work.Tabpage2.form.div_00.set_visible(true);
		this.div_work.Tabpage2.form.div_01.set_visible(false);
		this.div_work.Tabpage2.form.div_02.set_visible(false);
		this.div_work.Tabpage2.form.div_03.set_visible(false);
	}
}
/*******************************************************************************
 * fn_tabInsteadData
 * 기능 : 근태신청 기초데이터
 * 박대호
 * Parameter  : 
*******************************************************************************/
this.fn_tabInsteadData = function (calenderType)
{

	//디폴트 값 초기화
	this.ds_attendanceApproveInstead.setColumn(0, "START_DATE", "");
	this.ds_attendanceApproveInstead.setColumn(0, "END_DATE", "");
	this.ds_attendanceApproveInstead.setColumn(0, "REQUEST_DAY", "");
	this.ds_attendanceApproveInstead.setColumn(0, "CONTENTS", "");
	this.ds_attendanceApproveInstead.setColumn(0, "START_DATE_TIME", "0000");
	this.ds_attendanceApproveInstead.setColumn(0, "END_DATE_TIME", "0000");
	
	if (calenderType == "310" || calenderType == "190" ) //대체근무(310), 외출(190) - div_01
	{
		if(calenderType == "190")//외출
		{
			this.ds_attendanceApproveInstead.setColumn(0, "START_DATE", this.gfn_svrToday());
			this.ds_attendanceApproveInstead.setColumn(0, "END_DATE", this.gfn_svrToday());
		}
		else//대체근무
		{
			this.ds_attendanceApproveInstead.setColumn(0, "START_DATE", this.gfn_addDate(this.gfn_svrToday(),2));
			this.ds_attendanceApproveInstead.setColumn(0, "END_DATE", this.gfn_addDate(this.gfn_svrToday(),2));
		}
	}
	else if (calenderType == "140") //대체휴일(140) - div_02
	{
		this.ds_attendanceApproveInstead.setColumn(0, "START_DATE", this.gfn_addDate(this.gfn_svrToday(),2));
		this.ds_attendanceApproveInstead.setColumn(0, "END_DATE", this.gfn_addDate(this.gfn_svrToday(),2));
		this.ds_attendanceApproveInstead.setColumn(0, "REQUEST_DAY", "1");
	}
	else if (calenderType == "150") //출장(150) - div_03
	{
		this.ds_attendanceApproveInstead.setColumn(0, "START_DATE", this.gfn_svrToday());
		this.ds_attendanceApproveInstead.setColumn(0, "END_DATE", this.gfn_svrToday());
		this.ds_attendanceApproveInstead.setColumn(0, "REQUEST_DAY", "1");
	}
	else  //나머지 근태구분 - div_00
	{
		this.ds_attendanceApproveInstead.setColumn(0, "START_DATE", this.gfn_svrToday());
		this.ds_attendanceApproveInstead.setColumn(0, "END_DATE", this.gfn_svrToday());
		this.ds_attendanceApproveInstead.setColumn(0, "REQUEST_DAY", "1");
		if (calenderType == "130")//반휴
			this.ds_attendanceApproveInstead.setColumn(0, "REQUEST_DAY", "0.5");
	}
}
/*******************************************************************************
 * fn_tabDetailData
 * 기능 : 상세탭 데이터입력
 * 박대호
 * Parameter  : 
*******************************************************************************/
this.fn_tabDetailData = function (calenderType)
{
	this.ds_attendanceApproveDetail.clearData();
	this.ds_attendanceApproveDetail.addRow();
	var row = this.ds_attendanceApproveList.rowposition;
	this.ds_attendanceApproveDetail.setColumn(0,"HJSPAY_WORK_APPLY_SEQ",this.ds_attendanceApproveList.getColumn(row, "HJSPAY_WORK_APPLY_SEQ"));//근태신청 Key
	this.ds_attendanceApproveDetail.setColumn(0,"PERSON_ID",this.ds_attendanceApproveList.getColumn(row, "PERSON_ID"));//PERSONID
	this.ds_attendanceApproveDetail.setColumn(0,"APPLY_DATE",this.ds_attendanceApproveList.getColumn(row, "APPLY_DATE"));//신청일자
	this.ds_attendanceApproveDetail.setColumn(0,"EMP_NAME",this.ds_attendanceApproveList.getColumn(row, "EMP_NAME"));
	this.ds_attendanceApproveDetail.setColumn(0,"CALENDER_TYPE",this.ds_attendanceApproveList.getColumn(row, "CALENDER_TYPE"));//근태구분 CODE
	this.ds_attendanceApproveDetail.setColumn(0,"START_DATE",this.ds_attendanceApproveList.getColumn(row, "START_DATE").substring(0, 10));//근태일자(From)
	this.ds_attendanceApproveDetail.setColumn(0,"END_DATE",this.ds_attendanceApproveList.getColumn(row, "END_DATE").substring(0, 10));//근태일자(To)
	this.ds_attendanceApproveDetail.setColumn(0,"CONTENTS",this.ds_attendanceApproveList.getColumn(row, "CONTENTS"));//신청내용
	this.ds_attendanceApproveDetail.setColumn(0,"APPROVAL_CONTENTS",this.ds_attendanceApproveList.getColumn(row, "APPROVAL_CONTENTS"));//승인내용
	this.ds_attendanceApproveDetail.setColumn(0,"REQUEST_DAY",this.ds_attendanceApproveList.getColumn(row, "REQUEST_DAY"));//근태신청일수/시간
	this.ds_attendanceApproveDetail.setColumn(0,"STATUS_CODE",this.ds_attendanceApproveList.getColumn(row, "STATUS_CODE"));//상태
	this.ds_attendanceApproveDetail.setColumn(0,"MGR_PERSON_ID",this.ds_attendanceApproveList.getColumn(row, "MGR_PERSON_ID"));//승인자 PERSON ID
	this.ds_attendanceApproveDetail.setColumn(0,"OBJECT_VERSION_NUMBER",this.ds_attendanceApproveList.getColumn(row, "OBJECT_VERSION_NUMBER"));//OBJECT_VERSION_NUMBER
	this.ds_attendanceApproveDetail.setColumn(0,"ALTER_WORK_DAY",this.ds_attendanceApproveList.getColumn(row, "ALTER_WORK_DAY"));
	this.ds_attendanceApproveDetail.setColumn(0,"BUSINESS_TYPE",this.ds_attendanceApproveList.getColumn(row, "BUSINESS_TYPE"));
	this.ds_attendanceApproveDetail.setColumn(0,"BUSINESS_LOCAL",this.ds_attendanceApproveList.getColumn(row, "BUSINESS_LOCAL"));
	
	if(this.ds_attendanceApproveList.getColumn(row, "START_DATE").length > 15)
	{
		this.ds_attendanceApproveDetail.setColumn(0,"START_DATE_TIME",this.ds_attendanceApproveList.getColumn(row, "START_DATE").substring(11, 16));//시작시간
		this.ds_attendanceApproveDetail.setColumn(0,"END_DATE_TIME",this.ds_attendanceApproveList.getColumn(row, "END_DATE").substring(11, 16));//종료시간
	}
	
}
/**************************************************************************
 * 8. 이벤트
 ***************************************************************************/

/*
* 기능 : 부서검색 버튼 이벤트
*/
this.div_search_btn_organization_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var oArg = {};

	if (this.div_search.form.edt_organization.value != "")
	{
		oArg.arg_type        = "BA"; 
	}
	else
	{
		oArg.arg_type        = "B"; 
	}
	oArg.arg_popupCd     = "P00210";
	oArg.arg_popupNm     = "부서 검색";
	oArg.arg_rtnCols     = "ORG_ID|ORG_NAME";
	oArg.arg_paramCols   = "";
	oArg.arg_paramValues = "";
	oArg.arg_searchStr   = "DEPT_NM=" + this.div_search.form.edt_organization.value;
	this.gfn_openPopup( "POPUP_ORGANIZATION", "cmd::CMSA00100P.xfdl", oArg, "width=800,height=800");	
};
/*
* 기능 : 셀선택 이벤트
*/
this.div_work_Tabpage0_grd_attendanceApproveList_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if(this.ds_attendanceApproveList.getRowCount() > 0 && e.cell != 0)
	{
		this.div_work.set_tabindex(1);
		this.fn_tabDetailDisplay(this.ds_attendanceApproveList.getColumn(this.ds_attendanceApproveList.rowposition, "CALENDER_TYPE"));
		this.fn_tabDetailData(this.ds_attendanceApproveList.getColumn(this.ds_attendanceApproveList.rowposition, "CALENDER_TYPE"));
	}
};

/*
* 기능 : 구분변경 이벤트
*/
this.div_work_Tabpage2_div_basicInfo_cbo_calenderName_onitemchanged = function(obj:nexacro.Combo,e:nexacro.ItemChangeEventInfo)
{
	this.fn_tabInsteadDisplay(this.ds_attendanceApproveInstead.getColumn(0, "CALENDER_TYPE"));
	this.fn_tabInsteadData(this.ds_attendanceApproveInstead.getColumn(0, "CALENDER_TYPE"));
};

/*
* 기능 : 0.5일신청 버튼 이벤트
*/
this.div_work_Tabpage2_div_02_div_basicInfo00_01_btn_apply_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var startDate = this.ds_attendanceApproveInstead.getColumn(0,"START_DATE");
	this.ds_attendanceApproveInstead.setColumn(0,"END_DATE", startDate);
	this.ds_attendanceApproveInstead.setColumn(0, "REQUEST_DAY", 0.5);
};
/*
* 기능 : 기간 변경 이벤트
*/
this.ds_attendanceApproveInstead_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	//기간(시작일), 기간(종료일) 변경시
	if (e.columnid == "START_DATE" || e.columnid == "END_DATE" || e.columnid == "START_DATE_TIME" || e.columnid == "END_DATE_TIME")
	{
		var startDate = obj.getColumn(e.row, "START_DATE");
		var endDate = obj.getColumn(e.row, "END_DATE");
		var startDateTime = obj.getColumn(e.row, "START_DATE_TIME");
		var endDateTime = obj.getColumn(e.row, "END_DATE_TIME");
		var calenderType = obj.getColumn(e.row, "CALENDER_TYPE");
		if (!this.gfn_isNull(startDate) && !this.gfn_isNull(endDate))
		{
			if (calenderType == "310" || calenderType == "190") //대체근무(310), 외출(190) 일 경우는 시간계산
			{
				//시간차 구해서 표시
				var diffTime = nexacro.round(this.fn_checkDiffDay(obj, e.row, "today"),2); 
				if(diffTime > 8)	diffTime = 8;	//최대8시간
				this.ds_attendanceApproveInstead.setColumn(0, "REQUEST_DAY", diffTime);
			}
			else if (calenderType == "130" ) //반휴(130)
			{
				obj.set_enableevent(false);
				obj.setColumn(e.row, "REQUEST_DAY", "0.5");		//0.5 고정
				obj.set_enableevent(true);
			}
			//가족돌봄휴가(158), 생리휴가(160), 연휴(110), 예비군훈련(170), 대체휴일(140)
			else if (calenderType == "158" || calenderType == "160" || calenderType == "110" || calenderType == "170" || calenderType == "140") 
			{
			//checkPoint wt
				var diffDay  = this.fn_checkWorkDayCntWt(obj, e.row);
				obj.set_enableevent(false);
				obj.setColumn(e.row, "REQUEST_DAY", diffDay);
				obj.set_enableevent(true);
			}
			else //연차포함 기타일 경우는 일자
			{
				var diffDay = this.gfn_diffDate2(startDate, endDate)
				diffDay= diffDay+1; //당일도 포함되어야 하므로 1일 추가
				obj.set_enableevent(false);
				obj.setColumn(e.row, "REQUEST_DAY", diffDay);
				obj.set_enableevent(true);
			}
		}
	}
};

/*
 * 기능 : 근태신청 입력기간에 따른 일차차이 호출
 * 파라미터 : pDataset     > 데이터셋
 *             pRowPosition > 행의 위치
 * 리턴값 : 차이날짜
 */
this.fn_checkDiffDay = function(pDataset, pRowPosition, pFlag)
{    
	var nRow = pRowPosition;
	var objDataset = pDataset;
	
	//대체근무, 대체휴일 신청시 최소 48시간 이전 신청을 체크하기 위해 오늘 날짜를 넘김
	if (pFlag == "today")
	{	
		var startDate = objDataset.getColumn(nRow, "START_DATE");
		var startDateTime = objDataset.getColumn(nRow, "START_DATE_TIME");
		var endDate = objDataset.getColumn(nRow, "END_DATE");
		var endDateTime = objDataset.getColumn(nRow, "END_DATE_TIME");
	}
	else{
		var startDate = objDataset.getColumn(nRow, "START_DATE");
		var startDateTime = objDataset.getColumn(nRow, "START_DATE_TIME");
		var endDate = objDataset.getColumn(nRow, "END_DATE");
		var endDateTime = objDataset.getColumn(nRow, "END_DATE_TIME");
	}
	
	this.ds_result.clearData();
	var nRow = this.ds_result.addRow();
	this.ds_result.setColumn(nRow, "START_DATE", startDate);
	this.ds_result.setColumn(nRow, "START_DATE_TIME", startDateTime );
	this.ds_result.setColumn(nRow, "END_DATE", endDate);
	this.ds_result.setColumn(nRow, "END_DATE_TIME", endDateTime );
	
	var sSvcID 			= "selectDiffDay"; 						// CallBack service name
	var sController 	= "/pay40110/selectDiffDay.do" ;			// CONTROLLER VALUE
	var sInDatasets 	= "INPUT=ds_result";						// DB INPUT  DATA
	var sOutDatasets 	= "ds_result=output";				    // DB OUTPUT DATA
	var sArgs 			= "";	
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs, "", "", false, ""); //동기식
	
	if (pFlag == "today")
	{
		var diffday = this.ds_result.getColumn(this.ds_result.rowposition, "DIFFTIME");
	}
	else
	{
		var diffday = this.ds_result.getColumn(this.ds_result.rowposition, "DIFFDAY");
	}
	return diffday;

}
/*
 * 기능 : 근태신청 입력기간에 따른 일차차이 호출
 * 파라미터 : pDataset     > 데이터셋
 *             pRowPosition > 행의 위치
 * 리턴값 : 차이날짜
 */
this.fn_checkWorkDayCntWt = function(pDataset, pRowPosition)
{    
	var nRow = pRowPosition;
	var objDataset = pDataset;
	
	var startDate = objDataset.getColumn(nRow, "START_DATE");
	var endDate = objDataset.getColumn(nRow, "END_DATE");

	
	this.ds_result.clearData();
	var nRow = this.ds_result.addRow();
	this.ds_result.setColumn(nRow, "START_DATE", startDate);
	this.ds_result.setColumn(nRow, "END_DATE", endDate);
	
	var sSvcID 			= "selectWorkDayCntWt"; 						// CallBack service name
	var sController 	= "/pay40110/selectWorkDayCntWt.do" ;			// CONTROLLER VALUE
	var sInDatasets 	= "INPUT=ds_result";						// DB INPUT  DATA
	var sOutDatasets 	= "ds_result=output";				    // DB OUTPUT DATA
	var sArgs 			= "";	
	trace(this.ds_result.saveXML("Dataset", "V"));
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs, "", "", false, ""); //동기식
	
	var holiday = this.ds_result.getColumn(this.ds_result.rowposition, "HOLIDAY_DAY");
	
	return holiday;

}
/*
* 기능 : 상세 승인 버튼 이벤트
*/
this.div_work_Tabpage1_btn_approval_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.ds_attendanceApproveDetail.setColumn(0,"CHECK_FLAG", "Y");//처리여부(상세화면: Y, 다중처리: N)
	this.ds_attendanceApproveDetail.setColumn(0,"MGR_PERSON_ID",this.gf_getPersonId());//승인자 PERSON ID
	// -------------------------
    // 저장
    // ':U' 는 갱신된 내용만을 입력 데이터세트로 보내며, ':A' 는 모든 정보를 보냅니다.
    // ':N' 은 현재 Delete를 제외한 데이터를 Normal 상태로 보냅니다. 지정하지 않는 데이터세트는 Normal로 동작합니다
    // -------------------------
    var sSvcID        = "saveAttendanceApprove";
    var sController   = "/pay40210/saveAttendanceApprove.do";
    var sInDatasets   = "INPUT=ds_attendanceApproveDetail:U";
    var sOutDatasets  = "";
    var sArgs         = "";
    this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
};
/*
* 기능 : 상세 반려 버튼 이벤트
*/
this.div_work_Tabpage1_btn_returned_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.ds_attendanceApproveDetail.setColumn(0,"MGR_PERSON_ID",this.gf_getPersonId());//승인자 PERSON ID
	// -------------------------
    // 저장
    // ':U' 는 갱신된 내용만을 입력 데이터세트로 보내며, ':A' 는 모든 정보를 보냅니다.
    // ':N' 은 현재 Delete를 제외한 데이터를 Normal 상태로 보냅니다. 지정하지 않는 데이터세트는 Normal로 동작합니다
    // -------------------------
    var sSvcID        = "saveAttendanceApprove";
    var sController   = "/pay40210/saveAttendanceApproveReturn.do";
    var sInDatasets   = "INPUT=ds_attendanceApproveDetail:U";
    var sOutDatasets  = "";
    var sArgs         = "";
    this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
};

/*
* 기능 : 근태신청내역 승인 버튼 이벤트
*/
this.div_work_Tabpage0_btn_listApproval_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var chk = 0;
	for(var i = 0; i < this.ds_attendanceApproveList.rowcount; i++)
	{
		if(this.ds_attendanceApproveList.getColumn(i,"CHK")=="1")
		{
			chk++;
			this.ds_attendanceApproveList.setColumn(0,"MGR_PERSON_ID",this.gf_getPersonId());//승인자 PERSON ID
		}
	}
	//승인할 내역 체크 했는지 확인
	if(chk < 1)	return;
	
	if(chk == 1)//단일
	{
		for(var i = 0; i < this.ds_attendanceApproveList.rowcount; i++)
		{
			if(this.ds_attendanceApproveList.getColumn(i,"CHK")=="1")
			{
				this.ds_attendanceApproveList.setColumn(0,"CHECK_FLAG", "Y");//처리여부(상세화면: Y, 다중처리: N)
			}
		}
	}
	else //다중
	{
		for(var i = 0; i < this.ds_attendanceApproveList.rowcount; i++)
		{
			if(this.ds_attendanceApproveList.getColumn(i,"CHK")=="1")
			{
				this.ds_attendanceApproveList.setColumn(0,"CHECK_FLAG", "N");//처리여부(상세화면: Y, 다중처리: N)
			}
		}
	}

	// -------------------------
    // 저장
    // ':U' 는 갱신된 내용만을 입력 데이터세트로 보내며, ':A' 는 모든 정보를 보냅니다.
    // ':N' 은 현재 Delete를 제외한 데이터를 Normal 상태로 보냅니다. 지정하지 않는 데이터세트는 Normal로 동작합니다
    // -------------------------
    var sSvcID        = "saveAttendanceApprove";
    var sController   = "/pay40210/saveAttendanceApproveList.do";
    var sInDatasets   = "ds_attendanceApproveList=ds_attendanceApproveList:A";
    var sOutDatasets  = "";
    var sArgs         = "";
    this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
};
/*
* 기능 : 근태신청내역 반려 버튼 이벤트
*/
this.div_work_Tabpage0_btn_listReturn_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var chk = 0;
	for(var i = 0; i < this.ds_attendanceApproveList.rowcount; i++)
	{
		if(this.ds_attendanceApproveList.getColumn(i,"CHK")=="1")
		{
			chk++;
			this.ds_attendanceApproveList.setColumn(0,"MGR_PERSON_ID",this.gf_getPersonId());//승인자 PERSON ID
		}
	}
	//반려할 내역 체크 했는지 확인
	if(chk < 1)	return;
	// -------------------------
    // 저장
    // ':U' 는 갱신된 내용만을 입력 데이터세트로 보내며, ':A' 는 모든 정보를 보냅니다.
    // ':N' 은 현재 Delete를 제외한 데이터를 Normal 상태로 보냅니다. 지정하지 않는 데이터세트는 Normal로 동작합니다
    // -------------------------
    var sSvcID        = "saveAttendanceApprove";
    var sController   = "/pay40210/saveAttendanceApproveReturnList.do";
    var sInDatasets   = "ds_attendanceApproveList=ds_attendanceApproveList:A";
    var sOutDatasets  = "";
    var sArgs         = "";
    this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
};
/*
* 기능 : 근태신청(대리) 취소
*/
this.div_search_btn_clear1_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.ds_attendanceApproveInstead.clearData();
	this.ds_attendanceApproveInstead.addRow();
};
]]></Script>
    <Bind>
      <BindItem id="item0" compid="div_search.form.cbo_status" propid="value" datasetid="ds_search" columnid="STATUS"/>
      <BindItem id="item1" compid="div_search.form.edt_organization" propid="value" datasetid="ds_search" columnid="ORGANIZATION_NAME"/>
      <BindItem id="item2" compid="div_work.Tabpage1.form.div_basicInfo.form.cal_applyDate" propid="value" datasetid="ds_attendanceApproveDetail" columnid="APPLY_DATE"/>
      <BindItem id="item3" compid="div_work.Tabpage1.form.div_basicInfo.form.edt_empName" propid="value" datasetid="ds_attendanceApproveDetail" columnid="EMP_NAME"/>
      <BindItem id="item4" compid="div_work.Tabpage1.form.div_basicInfo.form.cbo_calenderName" propid="value" datasetid="ds_attendanceApproveDetail" columnid="CALENDER_TYPE"/>
      <BindItem id="item5" compid="div_work.Tabpage1.form.div_00.form.div_basicInfo00.form.edt_approvalContents0" propid="value" datasetid="ds_attendanceApproveDetail" columnid="CONTENTS"/>
      <BindItem id="item6" compid="div_work.Tabpage1.form.div_00.form.div_basicInfo00.form.cal_startDate0" propid="value" datasetid="ds_attendanceApproveDetail" columnid="START_DATE"/>
      <BindItem id="item7" compid="div_work.Tabpage1.form.div_00.form.div_basicInfo00.form.cal_endDate0" propid="value" datasetid="ds_attendanceApproveDetail" columnid="END_DATE"/>
      <BindItem id="item8" compid="div_work.Tabpage1.form.div_01.form.div_basicInfo00_00.form.edt_approvalContents1" propid="value" datasetid="ds_attendanceApproveDetail" columnid="CONTENTS"/>
      <BindItem id="item9" compid="div_work.Tabpage1.form.div_02.form.div_basicInfo00_01.form.cal_startDate2" propid="value" datasetid="ds_attendanceApproveDetail" columnid="START_DATE"/>
      <BindItem id="item10" compid="div_work.Tabpage1.form.div_03.form.div_basicInfo00_02.form.cal_endDate3" propid="value" datasetid="ds_attendanceApproveDetail" columnid="END_DATE"/>
      <BindItem id="item11" compid="div_work.Tabpage1.form.div_03.form.div_basicInfo00_02.form.cal_startDate3" propid="value" datasetid="ds_attendanceApproveDetail" columnid="START_DATE"/>
      <BindItem id="item12" compid="div_work.Tabpage1.form.div_01.form.div_basicInfo00_00.form.cal_startDate1" propid="value" datasetid="ds_attendanceApproveDetail" columnid="START_DATE"/>
      <BindItem id="item13" compid="div_work.Tabpage1.form.div_01.form.div_basicInfo00_00.form.cal_endDate1" propid="value" datasetid="ds_attendanceApproveDetail" columnid="END_DATE"/>
      <BindItem id="item14" compid="div_work.Tabpage1.form.div_02.form.div_basicInfo00_01.form.cal_endDate2" propid="padding" datasetid="ds_attendanceApproveDetail" columnid="END_DATE"/>
      <BindItem id="item15" compid="div_work.Tabpage1.form.div_01.form.div_basicInfo00_00.form.cal_endDate1" propid="padding" datasetid="ds_attendanceApproveDetail" columnid="END_DATE"/>
      <BindItem id="item16" compid="div_work.Tabpage1.form.div_03.form.div_basicInfo00_02.form.cal_endDate3" propid="padding" datasetid="ds_attendanceApproveDetail" columnid="END_DATE"/>
      <BindItem id="item17" compid="div_work.Tabpage1.form.div_02.form.div_basicInfo00_01.form.edt_approvalContents2" propid="value" datasetid="ds_attendanceApproveDetail" columnid="CONTENTS"/>
      <BindItem id="item18" compid="div_work.Tabpage1.form.div_03.form.div_basicInfo00_02.form.edt_approvalContents3" propid="value" datasetid="ds_attendanceApproveDetail" columnid="CONTENTS"/>
      <BindItem id="item19" compid="div_work.Tabpage1.form.div_02.form.div_basicInfo00_01.form.cal_endDate2" propid="value" datasetid="ds_attendanceApproveDetail" columnid="END_DATE"/>
      <BindItem id="item20" compid="div_work.Tabpage1.form.div_00.form.div_basicInfo00.form.edt_requestDay0" propid="value" datasetid="ds_attendanceApproveDetail" columnid="REQUEST_DAY"/>
      <BindItem id="item21" compid="div_work.Tabpage1.form.div_01.form.div_basicInfo00_00.form.edt_requestDay1" propid="value" datasetid="ds_attendanceApproveDetail" columnid="REQUEST_DAY"/>
      <BindItem id="item22" compid="div_work.Tabpage1.form.div_02.form.div_basicInfo00_01.form.edt_requestDay2" propid="value" datasetid="ds_attendanceApproveDetail" columnid="REQUEST_DAY"/>
      <BindItem id="item23" compid="div_work.Tabpage1.form.div_03.form.div_basicInfo00_02.form.edt_requestDay3" propid="value" datasetid="ds_attendanceApproveDetail" columnid="REQUEST_DAY"/>
      <BindItem id="item24" compid="div_work.Tabpage1.form.div_basicInfo.form.cal_alterWorkDay" propid="value" datasetid="ds_attendanceApproveDetail" columnid="ALTER_WORK_DAY"/>
      <BindItem id="item25" compid="div_work.Tabpage1.form.div_03.form.div_basicInfo00_02.form.cbo_messageclassid" propid="value" datasetid="ds_attendanceApproveDetail" columnid="BUSINESS_TYPE"/>
      <BindItem id="item26" compid="div_work.Tabpage1.form.div_03.form.div_basicInfo00_02.form.edt_00_00_00" propid="value" datasetid="ds_attendanceApproveDetail" columnid="BUSINESS_LOCAL"/>
      <BindItem id="item27" compid="div_work.Tabpage1.form.div_01.form.div_basicInfo00_00.form.mae_00_00" propid="value" datasetid="ds_attendanceApproveDetail" columnid="START_DATE_TIME"/>
      <BindItem id="item28" compid="div_work.Tabpage1.form.div_01.form.div_basicInfo00_00.form.mae_00_00_00" propid="value" datasetid="ds_attendanceApproveDetail" columnid="END_DATE_TIME"/>
      <BindItem id="item29" compid="div_work.Tabpage2.form.div_basicInfo.form.cal_applyDate" propid="value" datasetid="ds_attendanceApproveInstead" columnid="APPLY_DATE"/>
      <BindItem id="item30" compid="div_work.Tabpage2.form.div_basicInfo.form.edt_empName" propid="value" datasetid="ds_attendanceApproveInstead" columnid="EMP_NAME"/>
      <BindItem id="item31" compid="div_work.Tabpage2.form.div_basicInfo.form.cbo_calenderName" propid="value" datasetid="ds_attendanceApproveInstead" columnid="CALENDER_TYPE"/>
      <BindItem id="item32" compid="div_work.Tabpage2.form.div_00.form.div_basicInfo00.form.cal_startDate0" propid="value" datasetid="ds_attendanceApproveInstead" columnid="START_DATE"/>
      <BindItem id="item33" compid="div_work.Tabpage2.form.div_00.form.div_basicInfo00.form.cal_endDate0" propid="value" datasetid="ds_attendanceApproveInstead" columnid="END_DATE"/>
      <BindItem id="item34" compid="div_work.Tabpage2.form.div_00.form.div_basicInfo00.form.edt_requestDay0" propid="value" datasetid="ds_attendanceApproveInstead" columnid="REQUEST_DAY"/>
      <BindItem id="item35" compid="div_work.Tabpage2.form.div_00.form.div_basicInfo00.form.edt_approvalContents0" propid="value" datasetid="ds_attendanceApproveInstead" columnid="CONTENTS"/>
      <BindItem id="item36" compid="div_work.Tabpage2.form.div_01.form.div_basicInfo00_00.form.cal_startDate1" propid="value" datasetid="ds_attendanceApproveInstead" columnid="START_DATE"/>
      <BindItem id="item37" compid="div_work.Tabpage2.form.div_01.form.div_basicInfo00_00.form.cal_endDate1" propid="value" datasetid="ds_attendanceApproveInstead" columnid="END_DATE"/>
      <BindItem id="item38" compid="div_work.Tabpage2.form.div_01.form.div_basicInfo00_00.form.mae_00_00" propid="value" datasetid="ds_attendanceApproveInstead" columnid="START_DATE_TIME"/>
      <BindItem id="item39" compid="div_work.Tabpage2.form.div_01.form.div_basicInfo00_00.form.mae_00_00_00" propid="value" datasetid="ds_attendanceApproveInstead" columnid="END_DATE_TIME"/>
      <BindItem id="item40" compid="div_work.Tabpage2.form.div_01.form.div_basicInfo00_00.form.edt_requestDay1" propid="value" datasetid="ds_attendanceApproveInstead" columnid="REQUEST_DAY"/>
      <BindItem id="item41" compid="div_work.Tabpage2.form.div_02.form.div_basicInfo00_01.form.cal_startDate2" propid="value" datasetid="ds_attendanceApproveInstead" columnid="START_DATE"/>
      <BindItem id="item42" compid="div_work.Tabpage2.form.div_02.form.div_basicInfo00_01.form.cal_endDate2" propid="value" datasetid="ds_attendanceApproveInstead" columnid="END_DATE"/>
      <BindItem id="item43" compid="div_work.Tabpage2.form.div_02.form.div_basicInfo00_01.form.edt_requestDay2" propid="value" datasetid="ds_attendanceApproveInstead" columnid="REQUEST_DAY"/>
      <BindItem id="item44" compid="div_work.Tabpage2.form.div_02.form.div_basicInfo00_01.form.edt_approvalContents2" propid="value" datasetid="ds_attendanceApproveInstead" columnid="CONTENTS"/>
      <BindItem id="item45" compid="div_work.Tabpage2.form.div_03.form.div_basicInfo00_02.form.cal_startDate3" propid="value" datasetid="ds_attendanceApproveInstead" columnid="START_DATE"/>
      <BindItem id="item46" compid="div_work.Tabpage2.form.div_03.form.div_basicInfo00_02.form.cal_endDate3" propid="value" datasetid="ds_attendanceApproveInstead" columnid="END_DATE"/>
      <BindItem id="item47" compid="div_work.Tabpage2.form.div_03.form.div_basicInfo00_02.form.edt_requestDay3" propid="value" datasetid="ds_attendanceApproveInstead" columnid="REQUEST_DAY"/>
      <BindItem id="item48" compid="div_work.Tabpage2.form.div_03.form.div_basicInfo00_02.form.cbo_messageclassid" propid="value" datasetid="ds_attendanceApproveInstead" columnid="BUSINESS_TYPE"/>
      <BindItem id="item49" compid="div_work.Tabpage2.form.div_03.form.div_basicInfo00_02.form.edt_approvalContents3" propid="value" datasetid="ds_attendanceApproveInstead" columnid="CONTENTS"/>
      <BindItem id="item50" compid="div_work.Tabpage1.form.div_00.form.div_comment.form.txa_00" propid="value" datasetid="ds_attendanceApproveDetail" columnid="APPROVAL_CONTENTS"/>
      <BindItem id="item51" compid="div_work.Tabpage1.form.div_01.form.div_comment.form.txa_00" propid="value" datasetid="ds_attendanceApproveDetail" columnid="APPROVAL_CONTENTS"/>
      <BindItem id="item52" compid="div_work.Tabpage1.form.div_02.form.div_comment.form.txa_00" propid="value" datasetid="ds_attendanceApproveDetail" columnid="APPROVAL_CONTENTS"/>
      <BindItem id="item53" compid="div_work.Tabpage1.form.div_03.form.div_comment.form.txa_00" propid="value" datasetid="ds_attendanceApproveDetail" columnid="APPROVAL_CONTENTS"/>
      <BindItem id="item54" compid="div_work.Tabpage2.form.div_basicInfo.form.cbo_personId" propid="value" datasetid="ds_attendanceApproveInstead" columnid="PERSON_ID"/>
      <BindItem id="item55" compid="div_work.Tabpage2.form.div_01.form.div_basicInfo00_00.form.edt_approvalContents1" propid="value" datasetid="ds_attendanceApproveInstead" columnid="CONTENTS"/>
      <BindItem id="item56" compid="div_work.Tabpage2.form.div_03.form.div_basicInfo00_02.form.edt_businessArea" propid="value" datasetid="ds_attendanceApproveInstead" columnid="BUSINESS_LOCAL"/>
      <BindItem id="item57" compid="div_work.Tabpage2.form.div_basicInfo.form.cal_alterWorkDay" propid="value" datasetid="ds_attendanceApproveInstead" columnid="ALTER_WORK_DAY"/>
    </Bind>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="CMBM02100M" width="1024" height="768" titletext="배치실행 및 조회" onload="fn_init">
    <Layouts>
      <Layout width="1024" height="768">
        <Static id="sta_totCnt" taborder="9" text="(조회  0 건)" top="112" right="10" width="162" height="21" textAlign="right" font="bold 9pt &quot;Dotum&quot;"/>
        <Static id="Static03" taborder="6" text="10" visible="false" top="0" width="10" right="0" bottom="0" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
        <Static id="Static12" taborder="7" text="15" visible="false" left="0" top="96" height="15" right="0" background="yellowgreen" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
        <Static id="Static78" taborder="8" text="5" visible="false" left="0%" top="21" right="0.22%" height="5" background="lightseagreen" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
        <Grid id="grd_batchRun" taborder="4" binddataset="ds_batchRun" autoenter="select" nodatatext="검색 결과가 없습니다." left="0" top="135" right="10" cellsizingtype="col" tabstop="true" height="435" oncellclick="grd_batchRun_oncellclick" onselectchanged="grd_batchRun_onselectchanged">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="90" band="left"/>
                <Column size="40"/>
                <Column size="149"/>
                <Column size="242"/>
                <Column size="130"/>
                <Column size="180"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="120"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="90"/>
                <Column size="100"/>
                <Column size="150"/>
                <Column size="90"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="130"/>
                <Column size="1000"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="처리상태"/>
                <Cell col="1" text="첨부"/>
                <Cell col="2" text="배치코드"/>
                <Cell col="3" text="배치명"/>
                <Cell col="4" text="배치JOB"/>
                <Cell col="5" text="매개변수"/>
                <Cell col="6" text="시작일시"/>
                <Cell col="7" text="종료일시"/>
                <Cell col="8" text="처리시간"/>
                <Cell col="9" text="배치상태"/>
                <Cell col="10" text="첨부파일ID"/>
                <Cell col="11" text="첩부테이블"/>
                <Cell col="12" text="첩부파일 조회키"/>
                <Cell col="13" text="첨부파일수"/>
                <Cell col="14" text="유형"/>
                <Cell col="15" text="등록자"/>
                <Cell col="16" text="다음실행시간"/>
                <Cell col="17" text="배치상태" textAlign="center"/>
                <Cell col="18" text="배치주기"/>
                <Cell col="19" text="간격"/>
                <Cell col="20" text="부모JOB"/>
                <Cell col="21" text="추가정보"/>
              </Band>
              <Band id="body">
                <Cell text="bind:BATCH_STATUS_NM" textAlign="center"/>
                <Cell col="1" displaytype="expr:comp.parent.nfn_isNull(ATCH_FILE_ID) ? 'normal' : 'image'" edittype="none" text="expr:comp.parent.nfn_isNull(ATCH_FILE_ID) ? '' : 'image::btn_WF_TabIcon1_P.png'" textAlign="center"/>
                <Cell col="2" text="bind:BATCH_CD" textAlign="left"/>
                <Cell col="3" text="bind:PROGRAM_NAME" textAlign="left"/>
                <Cell col="4" text="bind:JOB_NAME" textAlign="left"/>
                <Cell col="5" text="bind:PARAMS" textAlign="left"/>
                <Cell col="6" displaytype="normal" text="bind:START_TIME" mask="yyyy/MM/dd HH:mm:ss" maskchar=" " calendardisplaynulltype="none" textAlign="left"/>
                <Cell col="7" displaytype="normal" text="bind:END_TIME" mask="yyyy/MM/dd HH:mm:ss" maskchar=" " calendardisplaynulltype="none" textAlign="left"/>
                <Cell col="8" text="bind:TERM_TIME" textAlign="left"/>
                <Cell col="9" text="bind:BATCH_RESULT_TYPE" textAlign="left"/>
                <Cell col="10" text="bind:ATCH_FILE_ID" textAlign="left"/>
                <Cell col="11" text="bind:ATCH_TY_CD" textAlign="left"/>
                <Cell col="12" text="bind:ATCH_SRC_KEY" textAlign="left"/>
                <Cell col="13" displaytype="number" text="bind:ATCH_FILE_CNT" mask="!#,###,###" textAlign="left"/>
                <Cell col="14" text="bind:BATCH_TYPE_NM" textAlign="left"/>
                <Cell col="15" text="bind:USER_NM" textAlign="left"/>
                <Cell col="16" displaytype="normal" text="bind:NEXT_RUN_DATE" mask="yyyy/MM/dd HH:mm:ss" maskchar=" " calendardisplaynulltype="none" textAlign="left"/>
                <Cell col="17" text="bind:BATCH_RESULT_TYPE" textAlign="center"/>
                <Cell col="18" text="bind:BATCH_INTERVAL_TYPE_NM" textAlign="center"/>
                <Cell col="19" text="bind:BATCH_INTERVAL" textAlign="center"/>
                <Cell col="20" text="bind:PARENT_JOB_NAME"/>
                <Cell col="21" text="bind:ADDITIONAL_INFO" textAlign="left"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static00" taborder="10" text="배치실행내역" cssclass="sta_WF_SubTitle" left="0" top="108" width="196" height="20" border="0px none rgba(51,51,51,1)" textAlign="left" verticalAlign="middle"/>
        <Static id="Static01" taborder="11" text="10" visible="false" left="0" top="125" width="500" height="10" background="lightseagreen" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
        <Static id="Static05" taborder="12" text="5" visible="false" left="622" top="130" right="10" height="5" background="fuchsia" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
        <Button id="btn_search" taborder="0" text="조회" onclick="fn_search" cssclass="btn_DR_GridSearch" top="0" right="250" width="60" height="21" tooltiptype="hover" tooltiptext="조회"/>
        <Button id="btn_clear1" taborder="1" text="초기화" onclick="btn_clear_onclick" cssclass="btn_DR_GridReset" top="0" right="313" width="60" height="21" tooltiptext="초기화"/>
        <Button id="btn_cancel" taborder="2" text="실행취소" cssclass="btn_DR_Basic2" top="0" right="167" width="80" height="21" tooltiptype="hover" onclick="btn_cancel_onclick"/>
        <Button id="btn_exec" taborder="3" text="실행" cssclass="btn_DR_Basic2" top="0" right="104" width="60" height="21" tooltiptype="hover" onclick="btn_exec_onclick"/>
        <Static id="Static02" taborder="13" text="15" visible="false" left="0" top="570" right="0" height="15" background="yellowgreen" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
        <Static id="Static04" taborder="14" text="배치로그내역" cssclass="sta_WF_SubTitle" left="0" top="582" width="196" height="24" border="0px none rgba(51,51,51,1)" textAlign="left" verticalAlign="middle"/>
        <Static id="Static06" taborder="15" text="10" visible="false" left="0" top="599" width="500" height="10" background="lightseagreen" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
        <Static id="Static07" taborder="16" text="5" visible="false" left="622" top="604" right="10" height="5" background="fuchsia" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
        <Grid id="grd_batchLog" taborder="5" binddataset="ds_batchLog" autoenter="select" nodatatext="검색 결과가 없습니다." left="0" top="609" right="10" bottom="0">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="50" band="left"/>
                <Column size="80" band="left"/>
                <Column size="250"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="120"/>
                <Column size="65"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="550"/>
                <Column size="300"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="No"/>
                <Cell col="1" text="처리상태"/>
                <Cell col="2" text="처리기준"/>
                <Cell col="3" text="시작일시"/>
                <Cell col="4" text="종료일시"/>
                <Cell col="5" text="처리시간"/>
                <Cell col="6" text="처리유형"/>
                <Cell col="7" text="처리건수"/>
                <Cell col="8" text="성공건수"/>
                <Cell col="9" text="오류건수"/>
                <Cell col="10" text="진행단계"/>
                <Cell col="11" text="에러메시지"/>
              </Band>
              <Band id="body">
                <Cell text="bind:SEQ_NO" textAlign="center"/>
                <Cell col="1" text="bind:STATUS_NAME" textAlign="center"/>
                <Cell col="2" text="bind:TABLE_NAME"/>
                <Cell col="3" displaytype="date" text="bind:START_TIME" mask="yyyy/MM/dd HH:mm:ss" maskchar=" " calendardisplaynulltype="none" textAlign="center"/>
                <Cell col="4" displaytype="date" text="bind:END_TIME" mask="yyyy/MM/dd HH:mm:ss" maskchar=" " calendardisplaynulltype="none" textAlign="center"/>
                <Cell col="5" text="bind:TERM_TIME" textAlign="center"/>
                <Cell col="6" text="bind:CRUD_TYPE" textAlign="center"/>
                <Cell col="7" displaytype="number" text="bind:PROCESS_CNT" textAlign="right"/>
                <Cell col="8" displaytype="number" text="bind:SUCCESS_CNT" textAlign="right"/>
                <Cell col="9" displaytype="number" text="bind:ERROR_CNT" textAlign="right"/>
                <Cell col="10" text="bind:DESCRIPTION"/>
                <Cell col="11" text="bind:ERR_CONTENTS"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="sta_totCnt1" taborder="17" text="(조회  0 건)" top="586" right="10" width="162" height="21" textAlign="right" font="bold 9pt &quot;Dotum&quot;"/>
        <Div id="div_search" taborder="18" left="0" top="26" right="10" height="70" cssclass="div_WF_SearchBg" background="rgba(247,247,247,1)">
          <Layouts>
            <Layout width="1005" height="80">
              <Static id="Static04" taborder="0" text="20" visible="false" left="0" top="0" bottom="0" width="20" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static27" taborder="1" text="10" visible="false" left="0" top="0" right="0" height="10" background="lightseagreen" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static17" taborder="2" text="10" visible="false" left="75" top="0" bottom="0" width="10" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static01" taborder="3" text="10" visible="false" left="0" right="0" bottom="-58" height="10" background="lightseagreen" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static16" taborder="4" text="10" visible="false" left="0" right="0" bottom="0" height="10" background="lightseagreen" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static05" taborder="5" text="10" visible="false" top="0" right="0" bottom="0" width="10" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static07" taborder="6" text="실행일자" cssclass="sta_WF_Label2" left="12" top="10" width="61" height="20" font="9pt &quot;Dotum&quot;"/>
              <Static id="Static20" taborder="7" text="~" left="220" top="10" width="20" height="19" textAlign="center" verticalAlign="middle"/>
              <Static id="Static00" taborder="8" text="20" visible="false" left="315" top="0" bottom="0" width="20" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static02" taborder="9" text="업무구분" cssclass="sta_WF_Label2" left="423" top="10" width="57" height="20" font="9pt &quot;Dotum&quot;"/>
              <Static id="Static03" taborder="10" text="10" visible="false" left="386" top="0" bottom="0" width="10" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static06" taborder="11" text="20" visible="false" left="501" top="0" bottom="0" width="20" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static08" taborder="12" text="배치명" cssclass="sta_WF_Label2" left="609" top="10" width="45" height="20" font="9pt &quot;Dotum&quot;"/>
              <Static id="Static09" taborder="13" text="10" visible="false" left="560" top="0" bottom="0" width="10" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static11" taborder="14" text="배치유형" cssclass="sta_WF_Label2" left="12" top="37" width="61" height="20" font="9pt &quot;Dotum&quot;"/>
              <Static id="Static13" taborder="15" text="8" visible="false" left="0" top="29" right="0" height="8" background="lightseagreen" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static10" taborder="16" text="처리상태" cssclass="sta_WF_Label2" left="184" top="37" width="63" height="21" font="9pt &quot;Dotum&quot;"/>
              <Combo id="cbo_jobGubunCd" taborder="17" autoselect="true" codecolumn="C,SystemWorkType,ALL,Y,Y" index="0" left="490" top="10" width="105" height="20" font="9pt &quot;Dotum&quot;"/>
              <Combo id="cbo_batchType" taborder="18" autoselect="true" codecolumn="C,CMD_BATCH_TYPE,ALL,Y,Y" index="0" left="85" top="37" width="89" height="20" font="9pt &quot;Dotum&quot;"/>
              <Edit id="edt_programName" taborder="19" autoselect="true" left="664" top="10" width="130" height="20"/>
              <Static id="Static12" taborder="20" text="20" visible="false" left="700" top="0" bottom="0" width="20" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Static id="Static14" taborder="21" text="배치JOB" cssclass="sta_WF_Label2" left="808" top="10" width="56" height="20" font="9pt &quot;Dotum&quot;"/>
              <Static id="Static15" taborder="22" text="10" visible="false" left="772" top="0" bottom="0" width="10" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Edit id="edt_jobName" taborder="23" autoselect="true" left="876" top="10" width="130" height="20"/>
              <Static id="Static19" taborder="24" text="10" visible="false" left="216" top="0" bottom="0" width="10" background="gold" padding="0px 0px 3px 0px" textAlign="center" verticalAlign="middle" opacity="0.5"/>
              <Combo id="cbo_batchStatus" taborder="25" autoselect="true" codecolumn="C,CMD_BATCH_STATUS,ALL,Y,Y" index="0" left="250" top="37" width="89" height="20" font="9pt &quot;Dotum&quot;"/>
              <Combo id="cbo_batchResultType" taborder="26" autoselect="true" codecolumn="C,CMD_BATCH_RESULT,ALL,Y,Y" index="0" left="490" top="37" width="105" height="20" font="9pt &quot;Dotum&quot;"/>
              <Static id="Static22" taborder="27" cssclass="sta_WF_Label2" left="423" top="37" width="57" height="20" text="배치상태" font="9pt &quot;Dotum&quot;"/>
              <Static id="Static25" taborder="28" text="생성자" cssclass="sta_WF_Label2" left="609" top="37" width="45" height="20" font="9pt &quot;Dotum&quot;"/>
              <Edit id="edt_userNm" taborder="29" autoselect="true" left="664" top="37" width="130" height="20"/>
              <Edit id="edt_parentJobName" taborder="30" autoselect="true" left="876" top="37" width="130" height="20"/>
              <Static id="Static18" taborder="31" text="부모JOB" cssclass="sta_WF_Label2" left="808" top="37" width="56" height="20" font="9pt &quot;Dotum&quot;"/>
              <Combo id="cbo_count" taborder="32" codecolumn="codecolumn" datacolumn="datacolumn" onitemchanged="cbo_count_onitemchanged" left="1072" top="37" width="4" height="21" visible="false" font="9pt &quot;Dotum&quot;" innerdataset="innerdataset">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">5</Col>
                      <Col id="datacolumn">5</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">10</Col>
                      <Col id="datacolumn">10</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">30</Col>
                      <Col id="datacolumn">30</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">100</Col>
                      <Col id="datacolumn">100</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">500</Col>
                      <Col id="datacolumn">500</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Combo>
              <Div id="div_calendar_from" taborder="33" left="85" top="10" width="135" height="21" url="common::com_calendar.xfdl"/>
              <Div id="div_calendar_to" taborder="34" left="245" top="10" width="135" height="21" url="common::com_calendar.xfdl"/>
            </Layout>
          </Layouts>
          <InitValue/>
        </Div>
        <Div id="div_page" taborder="19" url="common::com_paging.xfdl" left="22.07%" right="17.97%" height="20" top="550" border="0px none rgba(128,128,128,1)" color="rgba(68,68,68,1)" font="9pt &quot;Dotum&quot;"/>
        <Static id="sta_totCnt2" taborder="20" text="(전체: 0건, 성공: 0건, 실패: 0건)" top="584" width="555" height="21" left="103" textAlign="left" font="bold 9pt &quot;Dotum&quot;"/>
        <FileDownload id="FileDownload00" taborder="21" text="FileDownload00" visible="false" left="1031" top="0" width="100" height="24"/>
        <Button id="btn_searchOpen" taborder="22" left="10" top="6" width="30" height="24" cssclass="btn_WF_searchOpen" onclick="nfn_searchOpen_onclick"/>
        <Static id="sta_title" taborder="23" text="업무화면명(자동)" left="40" top="6" width="145" height="24" cssclass="sta_WF_title" fittocontents="width" expr="nexacro.getApplication().gds_menu.lookup(&quot;PGM_ID&quot;,comp.parent.name,&quot;MENU_NM&quot;)"/>
        <Button id="btn_favorite" taborder="24" left="sta_title:2" top="6" width="24" height="24" cssclass="btn_WF_favorite"/>
        <Button id="btn_adjust" taborder="25" text="스케쥴 제어" cssclass="btn_DR_Basic2" top="0" right="10" width="90" height="21" tooltiptype="hover" onclick="btn_adjust_onclick"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_search" firefirstcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DATE_FROM" type="STRING" size="256"/>
          <Column id="DATE_TO" type="STRING" size="256"/>
          <Column id="JOB_GUBUN_CD" type="STRING" size="256"/>
          <Column id="PROGRAM_NAME" type="STRING" size="256"/>
          <Column id="JOB_NAME" type="STRING" size="256"/>
          <Column id="BATCH_TYPE" type="STRING" size="256"/>
          <Column id="BATCH_STATUS" type="STRING" size="256"/>
          <Column id="BATCH_RESULT_TYPE" type="STRING" size="256"/>
          <Column id="USER_NM" type="STRING" size="256"/>
          <Column id="PARENT_JOB_NAME" type="STRING" size="256"/>
          <Column id="PAGE_NUMBER" type="BIGDECIMAL" size="256"/>
          <Column id="PAGE_SIZE" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_batchRun">
        <ColumnInfo>
          <Column id="BATCH_CD" type="STRING" size="256"/>
          <Column id="PROGRAM_NAME" type="STRING" size="256"/>
          <Column id="JOB_NAME" type="STRING" size="256"/>
          <Column id="PARENT_JOB_NAME" type="STRING" size="256"/>
          <Column id="PARAMS" type="STRING" size="256"/>
          <Column id="START_TIME" type="DATETIME" size="256"/>
          <Column id="END_TIME" type="DATETIME" size="256"/>
          <Column id="TERM_TIME" type="STRING" size="256"/>
          <Column id="BATCH_STATUS" type="STRING" size="256"/>
          <Column id="BATCH_STATUS_NM" type="STRING" size="256"/>
          <Column id="BATCH_RESULT_TYPE" type="STRING" size="256"/>
          <Column id="BATCH_TYPE" type="STRING" size="256"/>
          <Column id="BATCH_TYPE_NM" type="STRING" size="256"/>
          <Column id="BATCH_INTERVAL_TYPE" type="STRING" size="256"/>
          <Column id="BATCH_INTERVAL_TYPE_NM" type="STRING" size="256"/>
          <Column id="BATCH_INTERVAL" type="BIGDECIMAL" size="256"/>
          <Column id="CREATED_BY" type="STRING" size="256"/>
          <Column id="USER_NM" type="STRING" size="256"/>
          <Column id="ENABLED" type="STRING" size="256"/>
          <Column id="NEXT_RUN_DATE" type="DATETIME" size="256"/>
          <Column id="TOTAL_ROWS" type="BIGDECIMAL" size="256"/>
          <Column id="ADDITIONAL_INFO" type="STRING" size="256"/>
          <Column id="ATCH_FILE_ID" type="BIGDECIMAL" size="256"/>
          <Column id="ATCH_TY_CD" type="STRING" size="256"/>
          <Column id="ATCH_SRC_KEY" type="STRING" size="256"/>
          <Column id="ATCH_FILE_YN" type="STRING" size="256"/>
          <Column id="ATCH_FILE_CNT" type="BIGDECIMAL" size="256"/>
          <Column id="ATCH_FILE_GUID" type="STRING" size="256"/>
          <Column id="PAGE_NUMBER" type="BIGDECIMAL" size="256"/>
          <Column id="PAGE_SIZE" type="BIGDECIMAL" size="256"/>
          <Column id="Column0" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_batchLog" firefirstcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="JOB_NAME" type="STRING" size="256"/>
          <Column id="SEQ_NO" type="BIGDECIMAL" size="256"/>
          <Column id="START_TIME" type="DATETIME" size="256"/>
          <Column id="END_TIME" type="DATETIME" size="256"/>
          <Column id="DESCRIPTION" type="STRING" size="256"/>
          <Column id="TABLE_NAME" type="STRING" size="256"/>
          <Column id="CRUD_TYPE" type="STRING" size="256"/>
          <Column id="PROCESS_CNT" type="BIGDECIMAL" size="256"/>
          <Column id="SUCCESS_CNT" type="BIGDECIMAL" size="256"/>
          <Column id="ERROR_CNT" type="BIGDECIMAL" size="256"/>
          <Column id="STATUS_CODE" type="STRING" size="256"/>
          <Column id="STATUS_NAME" type="STRING" size="256"/>
          <Column id="ERR_CONTENTS" type="STRING" size="256"/>
          <Column id="TERM_TIME" type="STRING" size="256"/>
          <Column id="CNT" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_proc_out" firefirstcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ERROR_CODE" type="STRING" size="256"/>
          <Column id="ERROR_DESC" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search2" firefirstcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DATE_FROM" type="STRING" size="256"/>
          <Column id="DATE_TO" type="STRING" size="256"/>
          <Column id="JOB_GUBUN_CD" type="STRING" size="256"/>
          <Column id="PROGRAM_NAME" type="STRING" size="256"/>
          <Column id="JOB_NAME" type="STRING" size="256"/>
          <Column id="BATCH_TYPE" type="STRING" size="256"/>
          <Column id="BATCH_STATUS" type="STRING" size="256"/>
          <Column id="BATCH_RESULT_TYPE" type="STRING" size="256"/>
          <Column id="USER_NM" type="STRING" size="256"/>
          <Column id="PARENT_JOB_NAME" type="STRING" size="256"/>
          <Column id="PAGE_NUMBER" type="BIGDECIMAL" size="256"/>
          <Column id="PAGE_SIZE" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind/>
    <Script type="xscript5.1"><![CDATA[/***************************************************************************************
 * 시스템명 	    : IFC MES시스템
 * 업무명 		: 배치실행 및 조회
 * 파일명 		: CMBM02100M.xfdl
 * 작성자 		: built1
 * 작성일 		: 2018.05.01
 *
 * 설  명		: 배치실행 및 조회
 *---------------------------------------------------------------------------------------
 * 변경일		변경자		변경내역
 *---------------------------------------------------------------------------------------
 * 2018.05.01    built1		최초작성
 *---------------------------------------------------------------------------------------
 ***************************************************************************************/

/**************************************************************************
 * 1. 필수 include(필수)
 *************************************************************************/
// include "lib::comLib.xjs";
// include "cuslib::nbdfComLib.xjs";

/**************************************************************************
 * 2. FORM 변수 선언 영역
 ***************************************************************************/
this.fv_currDate;
this.pJobName = ""; //메인화면에서 배치Job 값을 넘길 경우 자동 조회를 위한 변수


/**************************************************************************
 * 3. FORM 정의
 **************************************************************************/
/**
 * 3.1 (필수) 화면 로딩후에 실행되는 함수
 */
// onload함수(공통코드관리 화면이 호출될때 바로 실행되는 함수)
this.fn_init = function (obj:Form, e:nexacro.LoadEventInfo)
{
	// 폼 초기화
	this.nfn_formInit(obj);

	var toDate = this.nfn_getCurrentSystemTime(0);
//	trace("111-->"+toDate.substring(0,8)+"235959");
//	this.div_search.form.div_calendar_from.form.calStart.set_value(toDate);

	// 엔터키 설정 함수(조회)
	this.gfn_setEnterSearch(this.div_search, "nfn_search");

	// 그리드 소트 제외
	this.grd_batchRun.removeEventHandler("onheadclick", this.nfn_grd_onheadclick, this);
	this.grd_batchLog.removeEventHandler("onheadclick", this.nfn_grd_onheadclick, this);

	// paging
	// this.LIST_COUNT = 100;
	this.page = Eco.XComp.getUserProperty(obj, "pageNum"); //페이지 넘버 클릭시 페이지 값 전달위한 프로퍼티 세팅,
	if (Eco.isEmpty(this.page)) 
	{
		this.page = 1;
	}
	// 값이 null 일때 1페이지
	this.div_page.form.initPaging(this.LIST_COUNT, this.PAGE_COUNT, this.onChangePage, this); //디비전 속 페이지
	this.div_page.form.setCurrentPage(this.page); //paging end

	// 초기값 설정
	this.btn_clear_onclick();

	// 틀고정
	this.nfn_cellFix(this.grd_batchRun, 3);
	this.nfn_cellFix(this.grd_batchLog, 2);

	// 메인화면에서 값을 넘겨 받을 경우 배치Job 값을 자동으로 실행
	this.pJobName = this.nfn_getFrameAguments("arg_pJobName");
	if (!this.gfn_isNull(this.pJobName)) 
	{
		this.div_search.form.edt_jobName.set_value(this.pJobName);
		this.fn_search();
	}
	if (this.nfn_getFrameAguments("arg_searchFlag")) 
	{
		this.fn_search();
	}
	this.div_search.form.div_calendar_from.form.calStart.set_value(toDate.substring(0,8)+"0000");
	this.div_search.form.div_calendar_to.form.calStart.set_value(toDate.substring(0,8)+"2359");
	
};


/**************************************************************************
 * 4. 공통버튼영역 (함수 삭제금지!!!!)
 **************************************************************************/
/*
 기능 : 조회버튼 처리
 */
this.fn_search = function (obj:Button, e:nexacro.ClickEventInfo)
{
	// 필수입력 체크
	var component = this.div_search;
	var strColIdList = "div_calendar_from.form.calStart,div_calendar_to.form.calStart";
	var strColNmList = "STARTDATE,ENDDATE";
	var rtn = this.nfn_MandatoryCheck(component, strColIdList, strColNmList);
	if (rtn == false) 
	{
		return;
	}

	// 실행일자..From, To 체크
	if (!this.nfn_fromToCheck("Date", this.div_search.form.div_calendar_from.form.calStart, this.div_search.form.div_calendar_to.form.calStart, "Y")) 
	{
		return;
	}

	// paging
	if (this.isValidObject(obj)) 
	{
		this.page = 1;
		this.div_page.form.setCurrentPage(this.page);
	}
	// paging end

	// 검색 search DS 초기화
	this.ds_search.clearData();
	this.ds_search.addRow();

	// 검색조건
	this.ds_search.setColumn(0, "DATE_FROM", this.div_search.form.div_calendar_from.form.calStart.value);
	this.ds_search.setColumn(0, "DATE_TO", this.div_search.form.div_calendar_to.form.calStart.value);

	this.ds_search.setColumn(0, "JOB_GUBUN_CD", this.div_search.form.cbo_jobGubunCd.value);
	this.ds_search.setColumn(0, "PROGRAM_NAME", this.div_search.form.edt_programName.value);
	this.ds_search.setColumn(0, "JOB_NAME", this.div_search.form.edt_jobName.value);
	this.ds_search.setColumn(0, "BATCH_TYPE", this.div_search.form.cbo_batchType.value);
	this.ds_search.setColumn(0, "BATCH_STATUS", this.div_search.form.cbo_batchStatus.value);
	this.ds_search.setColumn(0, "BATCH_RESULT_TYPE", this.div_search.form.cbo_batchResultType.value);
	this.ds_search.setColumn(0, "USER_NM", this.div_search.form.edt_userNm.value);
	this.ds_search.setColumn(0, "PARENT_JOB_NAME", this.div_search.form.edt_parentJobName.value);

	// paging
	this.ds_search.setColumn(0, "PAGE_NUMBER", this.page);
	this.ds_search.setColumn(0, "PAGE_SIZE", this.LIST_COUNT);
	// paging end

	// trace(this.ds_search.saveXML());

	// 대상 초기화
	this.ds_batchRun.clearData();

	var sSvcID = "selectBatchProgramRunList";
	var sController = "/cmbm02100/selectBatchProgramRunList.do";
	var sInDatasets = "INPUT=ds_search";
	var sOutDatasets = "ds_batchRun=output";
	var sArgs = "";
	sArgs += this.gfn_setParam("method", sSvcID);
	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
};


// 배치로그내역
this.fn_search2 = function (nRow)
{
	// 검색 search DS 초기화
	this.ds_search2.clearData();
	this.ds_search2.addRow();

	// 검색조건
	this.ds_search2.setColumn(0, "JOB_NAME", this.ds_batchRun.getColumn(nRow, "JOB_NAME"));
	// trace(this.ds_search.saveXML());

	// 대상 초기화
	this.ds_batchLog.clearData();

	var sSvcID = "selectCmbmBatchJobLogs";
	var sController = "/cmbm02100/selectCmbmBatchJobLogs.do";
	var sInDatasets = "INPUT=ds_search2";
	var sOutDatasets = "ds_batchLog=output";
	var sArgs = "";
	sArgs += this.gfn_setParam("method", sSvcID);

	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
};


/*
 기능 : 저장버튼 처리
 */
this.fn_save = function (obj:Button, e:nexacro.ClickEventInfo)
{
};


/*
 기능 : 삭제버튼 처리
 */
this.fn_delete = function (obj:Button, e:nexacro.ClickEventInfo)
{
};


/**************************************************************************
 * 5. TRANSACTION, CALLBACK 영역
 **************************************************************************/
this.fn_callBack = function (trId, errCD, errMsg)
{
	if (errCD < 0) 
	{
		this.gfn_Message("ProcessingError", trId + errMsg, "error", "ok");
	}
	/*
	if (errCD < 0) 
	{
		// BizException
		if (errCD == -200) 
		{
			this.gfn_alert(errMsg);
			return;
		}

		// strMsgType  (메세지 종류 : error, warning, info)
		// strMsgButton(버튼        : ok,yesno,yesnocancel)
		if (trId.substring(0, 7) == "execute") 
		{
			this.gfn_Message("SMCMM0001", new Array("프로시져 실행", "\n" + trId + "\n" + errMsg), "error", "ok"); //("처리을/를 실패하였습니다."+"\n"+trId+"\n"+errMsg);
		}
		else if (trId.substring(0, 6) == "select") 
		{
			this.gfn_Message("ErrorOnSearch", "\n" + trId + "\n" + errMsg, "error", "ok"); //("조회에 실패하였습니다."+"\n"+trId+"\n"+errMsg);
		}
		else if (trId.substring(0, 6) == "delete") 
		{
			this.gfn_Message("SMCMM0004", "\n" + trId + "\n" + errMsg, "error", "ok"); //("삭제가 실패하였습니다."+"\n"+trId+"\n"+errMsg);
		}
		else 
		{
			this.gfn_Message("SMCMM0001", new Array("처리", "\n" + trId + "\n" + errMsg), "error", "ok"); ///{0}을/를 실패하였습니다.{1}
		}
	}
	*/
	else 
	{
		if (trId == "selectBatchProgramRunList") 
		{
			// 배치실행 리스트
			if (this.ds_batchRun.rowcount < 1) 
			{
				this.div_page.set_visible(false);
				this.grd_batchRun.set_height(430);
				this.sta_totCnt.set_text("(Search  " + this.nfn_appendComma(this.ds_batchRun.rowcount) + " 건)");

				this.ds_batchLog.clearData();
				this.sta_totCnt1.set_text("(Search  " + this.nfn_appendComma(this.ds_batchLog.rowcount) + " 건)");
				this.sta_totCnt2.set_text("(All: 0건, Success: 0건, Fail: 0건)");

				//this.gfn_Message("NoSaveData", null, "info", "ok"); //조회된 자료가 없습니다.
			}
			else 
			{
				var totalRows = this.ds_batchRun.getColumn(0, "TOTAL_ROWS");

				this.sta_totCnt.set_text("(Search  " + this.nfn_appendComma(totalRows) + " 건)");
				this.div_page.form.setPage(totalRows);

				// 한 줄로 조회가 되면 페이징을 안 보이게 하는 작업 - 문자 비교가 아닌 숫자 비교로 전환
				if (nexacro.toNumber(totalRows) > nexacro.toNumber(this.LIST_COUNT)) 
				{
					this.div_page.set_visible(true);
					this.grd_batchRun.set_height(410);
				}
				else 
				{
					this.div_page.set_visible(false);
					this.grd_batchRun.set_height(426);
				}
			}
		}
		else if (trId == "selectCmbmBatchJobLogs") 
		{
			// 배치로그내역
			this.sta_totCnt1.set_text("(Search  " + this.nfn_appendComma(this.ds_batchLog.rowcount) + " 건)");

			// var nopayAmt = this.nfn_FormatNull(this.ds_rcptNopayList.getCaseSum("CHK_EXCEPTION!='1'","NOPAY_AMT"))

			var TCnt = this.ds_batchLog.getSum("CNT");
			var SCnt = this.ds_batchLog.getCaseSum("STATUS_CODE == 'S'", "CNT");
			var ECnt = this.ds_batchLog.getCaseSum("STATUS_CODE == 'E'", "CNT");

			this.sta_totCnt2.set_text("(All: " + this.nfn_appendComma(TCnt) + "건, " + 
				"Success: " + this.nfn_appendComma(SCnt) + "건, " + 
				"Fail: " + this.nfn_appendComma(ECnt) + "건)");

			if (this.ds_batchLog.rowcount < 1) 
			{
				// this.gfn_Message("NoSaveData", null, "info","ok");// 조회된 자료가 없습니다.
			}
		}

	}
};


/**************************************************************************
 * 6. 팝업 시작
 **************************************************************************/
// 실행
this.btn_exec_onclick = function (obj:Button, e:nexacro.ClickEventInfo)
{
	var jobGubunCd = this.div_search.form.cbo_jobGubunCd.value;

	var oArg = {
		arg_jobGubunCd : jobGubunCd
	};

	this.gfn_openPopup("CMBM02110P", "cmd::CMBM02110P.xfdl", oArg, "");
};


// 팝업 Callback
this.fn_popupAfter = function (sPopupId, Variant)
{
	if (sPopupId == "CMBM02110P") 
	{
		if (this.fv_rtnValue[0] == "SEARCH") 
		{
			this.fn_search();
		}
	}
};


/**************************************************************************
 * 7. 기타 함수 시작
 **************************************************************************/
// paging
// ////////페이징관련///////////////////////
/* 콤보 박스 변경시 */
this.cbo_count_onitemchanged = function (obj:Combo, e:nexacro.ItemChangeEventInfo)
{
	this.ds_batchRun.clearData();
	this.ds_batchLog.clearData();
	this.grd_batchRun.set_height(426);

	this.sta_totCnt.set_text("(조회  0 건)");
	this.sta_totCnt1.set_text("(조회  0 건)");

	// 페이지당 조회 건수 변경 발생시 paging 화면 reload 처리
	this.LIST_COUNT = e.postvalue;
	this.div_page.form.fn_reload();
	this.nfn_setPageInit(this.div_page);
};

/* 페이지 변경 시 호출됨 */
this.onChangePage = function (page)
{
	Eco.XComp.setUserProperty(this, "pageNum", page);
	this.page = page;
	this.div_page.form.setCurrentPage(page);
	this.fn_search();
};
// ////////페이징 관련///////////////////////
// paging end


/**************************************************************************
 * 8. 이벤트
 **************************************************************************/
// 초기화
this.btn_clear_onclick = function (obj:Button, e:nexacro.ClickEventInfo)
{
	
	// 전체 초기화
	var objDiv = this.div_search;
	this.nfn_clearAllInDiv(objDiv);
	this.ds_batchRun.clearData();
	this.ds_batchLog.clearData();
	this.sta_totCnt.set_text("(조회  0 건)");
	this.sta_totCnt1.set_text("(조회  0 건)");

	this.div_search.form.cbo_jobGubunCd.set_index(0);
	this.div_search.form.cbo_batchType.set_index(0);
	this.div_search.form.cbo_batchStatus.set_index(0);
	this.div_search.form.cbo_batchResultType.set_index(0);

	// 현재일설정
	this.fv_currDate = this.gfn_todayTime();
	this.div_search.form.div_calendar_from.form.calStart.set_value(this.fv_currDate.substring(0, 8)); //현재일
	this.div_search.form.div_calendar_to.form.calStart.set_value(this.fv_currDate.substring(0, 12)); //현재일

	this.div_search.form.cbo_count.set_value("30");
	this.LIST_COUNT = 30;
	this.div_page.set_visible(false);
	this.grd_batchRun.set_height(426);
	this.div_page.form.fn_reload();
	this.nfn_setPageInit(this.div_page);
};


// 실행취소
this.btn_cancel_onclick = function (obj:Button, e:nexacro.ClickEventInfo)
{
	var nRow = this.ds_batchRun.rowposition;
	if (nRow < 0) 
	{
		this.gfn_Message("NoSelections", "", "warning", "ok"); //선택된 항목이 없습니다.
		return;
	}

	var batchResultType = this.ds_batchRun.getColumn(nRow, "BATCH_RESULT_TYPE");
	trace("batchResultType => " + batchResultType);

	if (batchResultType == "성공" || batchResultType == "취소" || batchResultType == "실패") 
	{
		this.gfn_Message("CannotCancelBatchStatus", "", "warning", "ok");//배치상태가 성공/취소/실패는 취소할 수 없습니다.
		return;
	}

	var bOK = this.gfn_Message("OspDoProcessWant", "실행취소 ", "conf", "yesno");
	if (bOK == false) 
	{
		return;
	}

	// DS 초기화
	this.ds_search.clearData();
	this.ds_search.addRow();

	// 조건
	this.ds_search.setColumn(0, "JOB_NAME", this.ds_batchRun.getColumn(nRow, "JOB_NAME"));
	// trace(this.ds_search.saveXML());

	// 대상 초기화
	this.ds_proc_out.clearData();

	var sSvcID = "executeBatchRunCancel";
	var sController = "/cmbm02100/executeBatchRunCancel.do";
	var sInDatasets = "INPUT=ds_search";
	var sOutDatasets = "ds_proc_out=ouput";
	var sArgs = "";
	sArgs += this.gfn_setParam("method", sSvcID);

	this.gfn_transaction(sSvcID, sController, sInDatasets, sOutDatasets, sArgs);
};


this.grd_batchRun_oncellclick = function (obj:Grid, e:nexacro.GridClickEventInfo)
{
	// 첨부된 컬럼을 클릭할 경우에만 이벤트 발생
	if (e.col == 1) 
	{
		var atchFileYn = this.gfn_blankStr(this.ds_batchRun.getColumn(e.row, "ATCH_FILE_YN"));
		var atchFilecnt = this.ds_batchRun.getColumn(e.row, "ATCH_FILE_CNT");
		var jobSysCd = this.ds_batchRun.getColumn(e.row, "BATCH_CD").substring(0, 4);
		// trace("atchFileYn => " + atchFileYn + ", atchFilecnt => " + atchFilecnt + ", jobSysCd => " + jobSysCd);

		if (atchFileYn == "" || atchFileYn == "N") 
		{
			return;
		}

		// 첨부파일 없을 경우
		if (atchFilecnt == 0) 
		{
			return;
		}

		// 첨부파일 한건 일 경우
		else if (atchFilecnt == 1) 
		{
			var bOK = this.gfn_Message("IMCMM0046", "파일다운로드", "conf", "yesno");
			if (bOK == false) 
			{
				return;
			}

			var atchFileGuid = this.ds_batchRun.getColumn(e.row, "ATCH_FILE_GUID");
			var dnUrl = nexacro.getEnvironment().services["svcurl"].url + "/comm/downFile2/" + atchFileGuid + "/" + jobSysCd + ".do";
			// trace("dnUrl => " + dnUrl);
			this.FileDownload00.set_downloadurl(dnUrl);
			var bSucc = this.FileDownload00.download();
		}

		// 첨부파일 다건 일 경우
		else 
		{
			var atchSrcKey = this.ds_batchRun.getColumn(e.row, "ATCH_SRC_KEY");
			var tableName = this.ds_batchRun.getColumn(e.row, "ATCH_TY_CD");
			var oArg = {
				arg_jobSysCd : jobSysCd,
				arg_atchSrcKey : atchSrcKey,
				arg_tableName : tableName
			};
			this.gfn_openPopup("file_download", "cmcm::CMSA01310P.xfdl", oArg, "");
		}
	}
};


this.grd_batchRun_onselectchanged = function(obj:nexacro.Grid,e:nexacro.GridSelectEventInfo)
{
	if(e.row < 0) this.ds_batchLog.clearData();
	// 배치로그내역
	this.fn_search2(e.row);

};

this.btn_adjust_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var jobGubunCd = this.div_search.form.cbo_jobGubunCd.value;
	var	jobName = this.ds_batchRun.getColumn(this.ds_batchRun.rowposition,"PARENT_JOB_NAME")
	if(this.gfn_isNull(jobName))
		jobName = this.ds_batchRun.getColumn(this.ds_batchRun.rowposition,"JOB_NAME")
	
	var oArg = {
		arg_jobGubunCd : jobGubunCd
		,arg_programName : this.ds_batchRun.getColumn(this.ds_batchRun.rowposition,"PROGRAM_NAME")
		,arg_jobName : jobName
	};

	this.gfn_openPopup("CMBM02110P", "cmd::CMBM02120P.xfdl", oArg, "");		
};
]]></Script>
  </Form>
</FDL>
